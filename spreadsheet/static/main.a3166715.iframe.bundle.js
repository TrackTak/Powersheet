(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{342:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,".tippy-box[data-theme~=dropdown]{color:rgba(0,0,0,.9);background:#fff;box-shadow:1px 2px 5px 2px rgba(51,51,51,.15)}.tippy-box[data-theme~=cell]{background:#0057ff;box-shadow:1px 2px 5px 2px rgba(51,51,51,.15)}.tippy-box[data-theme~=comment]{color:#000;border:1px solid #ededed;position:absolute;box-shadow:1px 2px 5px 2px rgba(51,51,51,.15);background:#fff;z-index:100;width:260px;pointer-events:auto;overflow:auto}.tippy-box[data-theme~=formula-helper]{color:rgba(0,0,0,.9);background:#fff;box-shadow:1px 2px 5px 2px rgba(51,51,51,.15)}.tippy-box[data-theme~=formula-helper] .tippy-content{padding:0}","",{version:3,sources:["webpack://./src/spreadsheet/tippy.scss"],names:[],mappings:"AAAA,iCACE,oBAAA,CACA,eAAA,CACA,6CAAA,CAGF,6BACE,kBAAA,CACA,6CAAA,CAGF,gCACE,UAAA,CACA,wBAAA,CACA,iBAAA,CACA,6CAAA,CACA,eAAA,CACA,WAAA,CACA,WAAA,CACA,mBAAA,CACA,aAAA,CAGF,uCACE,oBAAA,CACA,eAAA,CACA,6CAAA,CAEA,sDACE,SAAA",sourcesContent:[".tippy-box[data-theme~='dropdown'] {\n  color: rgba(0, 0, 0, 0.9);\n  background: white;\n  box-shadow: 1px 2px 5px 2px rgb(51 51 51 / 15%);\n}\n\n.tippy-box[data-theme~='cell'] {\n  background: #0057ff;\n  box-shadow: 1px 2px 5px 2px rgb(51 51 51 / 15%);\n}\n\n.tippy-box[data-theme~='comment'] {\n  color: black;\n  border: 1px solid #ededed;\n  position: absolute;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n  background: #fff;\n  z-index: 100;\n  width: 260px;\n  pointer-events: auto;\n  overflow: auto;\n}\n\n.tippy-box[data-theme~='formula-helper'] {\n  color: rgba(0, 0, 0, 0.9);\n  background: white;\n  box-shadow: 1px 2px 5px 2px rgb(51 51 51 / 15%);\n\n  .tippy-content {\n    padding: 0;\n  }\n}\n"],sourceRoot:""}]),__webpack_exports__.a=___CSS_LOADER_EXPORT___},343:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,".uLB9BdI1h_fkNZoqwXUF7{position:absolute;z-index:12;right:0;background-color:#f4f5f8;bottom:0;top:0;overflow-x:hidden;overflow-y:scroll}._3k93rj0VqM9M7o8yZ2XX32{background:#ddd;width:1px}._15Kbh0MAcKFCksWf3Gzuhd{position:absolute;z-index:12;right:0;background-color:#f4f5f8;bottom:1px;left:0;overflow-x:scroll;overflow-y:hidden}._2u9dS5V9OJfIyUHRcrTIZE{background:#ddd;height:1px}","",{version:3,sources:["webpack://./src/spreadsheet/sheet/rowCols/scrollBars/ScrollBar.module.scss"],names:[],mappings:"AAWA,uBANE,iBAAA,CACA,UAAA,CACA,OAAA,CACA,wBAAA,CAMA,QAAA,CACA,KAAA,CACA,iBAAA,CACA,iBAAA,CAGF,yBAnBE,eAAA,CAqBA,SAAA,CAGF,yBApBE,iBAAA,CACA,UAAA,CACA,OAAA,CACA,wBAAA,CAoBA,UAAA,CACA,MAAA,CACA,iBAAA,CACA,iBAAA,CAGF,yBAjCE,eAAA,CAoCA,UAAA",sourcesContent:["@mixin scroll {\n  background: #ddd;\n}\n\n@mixin scrollBar {\n  position: absolute;\n  z-index: 12;\n  right: 0;\n  background-color: #f4f5f8;\n}\n\n.verticalScrollBar {\n  @include scrollBar();\n\n  bottom: 0;\n  top: 0;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n\n.verticalScroll {\n  @include scroll();\n  width: 1px;\n}\n\n.horizontalScrollBar {\n  @include scrollBar();\n\n  bottom: 1px;\n  left: 0;\n  overflow-x: scroll;\n  overflow-y: hidden;\n}\n\n.horizontalScroll {\n  @include scroll();\n\n  height: 1px;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={verticalScrollBar:"uLB9BdI1h_fkNZoqwXUF7",verticalScroll:"_3k93rj0VqM9M7o8yZ2XX32",horizontalScrollBar:"_15Kbh0MAcKFCksWf3Gzuhd",horizontalScroll:"_2u9dS5V9OJfIyUHRcrTIZE"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},344:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._1I2N9860EQu4ul5_bdSqEm{box-sizing:border-box;resize:none;border:#0057ff solid 2px;box-shadow:1px 2px 5px 2px rgba(51,51,51,.15);padding:2px;outline:none;background-color:#fff;height:100%}.xZ3JbzAKvot2qgSC-F2KG{position:absolute;box-sizing:border-box}","",{version:3,sources:["webpack://./src/spreadsheet/sheet/cellEditor/CellEditor.module.scss"],names:[],mappings:"AAAA,yBACE,qBAAA,CACA,WAAA,CACA,wBAAA,CACA,6CAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CAGF,uBACE,iBAAA,CACA,qBAAA",sourcesContent:[".cellEditor {\n  box-sizing: border-box;\n  resize: none;\n  border: #0057ff solid 2px;\n  box-shadow: 1px 2px 5px 2px rgb(51 51 51 / 15%);\n  padding: 2px;\n  outline: none;\n  background-color: white;\n  height: 100%;\n}\n\n.cellEditorContainer {\n  position: absolute;\n  box-sizing: border-box;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={cellEditor:"_1I2N9860EQu4ul5_bdSqEm",cellEditorContainer:"xZ3JbzAKvot2qgSC-F2KG"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},345:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._1Kwtju57NfIbBG28yIt2BS{position:relative}.tePBRYDn3PnTTWBfntS9U{background:#fff;max-height:250px;overflow-y:auto}._3-w06ELGgDT6wdcHhLjcRL{list-style:none;padding:0;margin:0;width:200px}._3-w06ELGgDT6wdcHhLjcRL li{height:32px;line-height:32px;cursor:pointer;padding:2px 5px}._3-w06ELGgDT6wdcHhLjcRL li:hover{background-color:#f5f5f5}","",{version:3,sources:["webpack://./src/spreadsheet/formulaHelper/FormulaHelper.module.scss"],names:[],mappings:"AAEA,yBACE,iBAAA,CAGF,uBACE,eAAA,CACA,gBAAA,CACA,eAAA,CAGF,yBACE,eAAA,CACA,SAAA,CACA,QAAA,CACA,WAAA,CAEA,4BACE,WAAA,CACA,gBAAA,CACA,cAAA,CACA,eAAA,CAEA,kCACE,wBAAA",sourcesContent:["@import '../styles.scss';\n\n.formulaHelper {\n  position: relative;\n}\n\n.formulaHelperListContainer {\n  background: white;\n  max-height: 250px;\n  overflow-y: auto;\n}\n\n.list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  width: 200px;\n\n  li {\n    height: 32px;\n    line-height: 32px;\n    cursor: pointer;\n    padding: 2px 5px;\n\n    &:hover {\n      background-color: #f5f5f5; // Extract to common styles\n    }\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={formulaHelper:"_1Kwtju57NfIbBG28yIt2BS",formulaHelperListContainer:"tePBRYDn3PnTTWBfntS9U",list:"_3-w06ELGgDT6wdcHhLjcRL"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},347:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,'.tippy-box[data-theme~="dropdown"] .tippy-content{padding:0}._2Kk7qK6zhtWX5-OVo5EIIt{display:flex;flex-direction:column;width:200px}._3T1V1VRsNar3IsitmxAocP{display:flex;flex-direction:column;align-items:flex-start}._3T1V1VRsNar3IsitmxAocP:after{content:"";width:100%;display:block;height:1px;background-color:#e0e2e4;margin:5px 0}._3T1V1VRsNar3IsitmxAocP:last-of-type:after{display:none}._1fBzq5_cjhOVy23VdjdZwh{cursor:pointer;border:none;background-color:transparent;padding:10px 5px;padding-left:10px;text-align:left;width:100%}._1fBzq5_cjhOVy23VdjdZwh.active{background-color:#e6f4ea}._1fBzq5_cjhOVy23VdjdZwh:hover{background:rgba(0,0,0,.08)}._1fBzq5_cjhOVy23VdjdZwh:disabled{pointer-events:none;opacity:.38}',"",{version:3,sources:["webpack://./src/spreadsheet/styles.scss","webpack://./src/spreadsheet/sheet/rightClickMenu/RightClickMenu.module.scss"],names:[],mappings:"AAwCE,kDACE,SAAA,CCrCJ,yBACE,YAAA,CACA,qBAAA,CACA,WAAA,CAGF,yBDUE,YAAA,CCRA,qBAAA,CACA,sBAAA,CACA,+BACE,UAAA,CACA,UAAA,CACA,aAAA,CACA,UAAA,CACA,wBAAA,CACA,YAAA,CAEF,4CACE,YAAA,CAIJ,yBD1BE,cAAA,CACA,WAAA,CACA,4BAAA,CAqBA,gBAAA,CACA,iBAAA,CACA,eAAA,CCIA,UAAA,CDzBA,gCACE,wBAAA,CAGF,+BACE,0BAAA,CAGF,kCACE,mBAAA,CACA,WAAA",sourcesContent:["@mixin button {\n  cursor: pointer;\n  border: none;\n  background-color: transparent;\n\n  &:global(.active) {\n    background-color: #e6f4ea;\n  }\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.08);\n  }\n\n  &:disabled {\n    pointer-events: none;\n    opacity: 0.38;\n  }\n}\n\n@mixin group {\n  display: flex;\n}\n\n@mixin buttonAction {\n  padding: 10px 5px;\n  padding-left: 10px;\n  text-align: left;\n}\n\n@mixin buttonCommentAction {\n  @include button;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  letter-spacing: 0.25px;\n  line-height: 16px;\n  padding: 3px 12px 5px;\n}\n\n@mixin tippyContentNoPadding {\n  :global(.tippy-box[data-theme~='dropdown'] .tippy-content) {\n    padding: 0;\n  }\n}\n","@import '../../styles.scss';\n\n@include tippyContentNoPadding;\n\n.content {\n  display: flex;\n  flex-direction: column;\n  width: 200px;\n}\n\n.group {\n  @include group;\n  flex-direction: column;\n  align-items: flex-start;\n  &:after {\n    content: '';\n    width: 100%;\n    display: block;\n    height: 1px;\n    background-color: #e0e2e4;\n    margin: 5px 0;\n  }\n  &:last-of-type:after {\n    display: none;\n  }\n}\n\n.buttonContent {\n  @include button;\n  @include buttonAction;\n  width: 100%;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={content:"_2Kk7qK6zhtWX5-OVo5EIIt",group:"_3T1V1VRsNar3IsitmxAocP",buttonContent:"_1fBzq5_cjhOVy23VdjdZwh"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},348:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__),_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(514),_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2__),_icons_icons_svg__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(515),_icons_icons_svg__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_icons_icons_svg__WEBPACK_IMPORTED_MODULE_3__),___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a),___CSS_LOADER_URL_REPLACEMENT_0___=_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default()(_icons_icons_svg__WEBPACK_IMPORTED_MODULE_3___default.a);___CSS_LOADER_EXPORT___.push([module.i,".kLhW2Km6h22buePX0M46J{position:relative;overflow:hidden;width:18px;height:18px;display:inline-block}._3mqxgAiAIEUyKm1Q9FnJal{white-space:nowrap}._3eX8RrQSaWLRMZ9AAE9mZ7{position:absolute;height:100%;width:100%;top:0;left:0}._3qCAiCOzOo_lk1s2E7-NEt{overflow:auto;display:flex}._2FrE3gEJzLeeWWfpnBGKtl .BavNAlWs66RVOIGg8lF38{width:10px}._2FrE3gEJzLeeWWfpnBGKtl .BavNAlWs66RVOIGg8lF38 ._1d43wWekSyEdH62S_5f_hB{left:-130px}._1CE0Sjh9_42Gz6uvWklvjl,._3skVZiMTmQElKpjX4QqIOW{cursor:pointer;border:none;background-color:transparent;position:relative;user-select:none;padding:6px;border-radius:2px;display:flex;align-items:center}._1CE0Sjh9_42Gz6uvWklvjl.active,._3skVZiMTmQElKpjX4QqIOW.active{background-color:#e6f4ea}._1CE0Sjh9_42Gz6uvWklvjl:hover,._3skVZiMTmQElKpjX4QqIOW:hover{background:rgba(0,0,0,.08)}._1CE0Sjh9_42Gz6uvWklvjl:disabled,._3skVZiMTmQElKpjX4QqIOW:disabled{pointer-events:none;opacity:.38}._3ZulctU64c4xMbOsF_DrtK{position:absolute;width:262px;height:444px;opacity:.65;background-image:url("+___CSS_LOADER_URL_REPLACEMENT_0___+")}._3ZulctU64c4xMbOsF_DrtK._1k6UkSRAwcJPAOrw3e01BA{left:0;top:0}._3ZulctU64c4xMbOsF_DrtK._173GQgD6LDjJhYz6AmT3DO{left:-18px;top:0}._3ZulctU64c4xMbOsF_DrtK._2_zIhBtR1Bu4V4mDtTVu91{left:-36px;top:0}._3ZulctU64c4xMbOsF_DrtK.hilacs9Y5ASHJFIWmplP4{left:-54px;top:0}._3ZulctU64c4xMbOsF_DrtK._1l8aiyYor6lfHhIYhRVFLG{left:-72px;top:0}._3ZulctU64c4xMbOsF_DrtK._1FcbcZZSBOSz5Us_-GYn_C{left:-90px;top:0}._3ZulctU64c4xMbOsF_DrtK.qPTUEB5DaHk4Z3Cs7B3x6{left:-108px;top:0}._3ZulctU64c4xMbOsF_DrtK._3dlFyiw7xdUMWNgP9cJsWe{left:-126px;top:0}._3ZulctU64c4xMbOsF_DrtK._3lNguoUonzpO-Yfi5KDwRU{left:-144px;top:0}._3ZulctU64c4xMbOsF_DrtK._3jyT9hX7KhUpv_KO-wg_ae{left:-162px;top:0}._3ZulctU64c4xMbOsF_DrtK.trVSF3njs-Pp2i5X-_rpx{left:-180px;top:0}._3ZulctU64c4xMbOsF_DrtK._1t8s9749n2tgRYhkGV4rEc{left:-198px;top:0}._3ZulctU64c4xMbOsF_DrtK._26v4qxUD7soZr9aiOwMHmV,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=left]{left:-216px;top:0}._3ZulctU64c4xMbOsF_DrtK._1MpKSLKV9QRKlLEY_9YNNc,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=center]{left:-234px;top:0}._3ZulctU64c4xMbOsF_DrtK.BskmZjwmCNaBVxW2GX_0e,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=right]{left:0;top:-18px}._3ZulctU64c4xMbOsF_DrtK._27mg3jKy9ZLBsA_kBMJ5Xh,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=top]{left:-18px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._3PsaIUsy54sa7ZzKXlQfL0,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=middle]{left:-36px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._37c24VCFMOQqaUFDlmQYUO,._3ZulctU64c4xMbOsF_DrtK[data-active-icon=bottom]{left:-54px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._3AAB3OItq-ExIBLBtCkODB{left:-72px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._1BmIBD_4sfiLEbVh1UjGY_{left:-90px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._3q1xrdmr-O-6jXI3rggQMs{left:-108px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._1d43wWekSyEdH62S_5f_hB{left:-126px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._3L5xMXTyD9xU0qUW-TS8e_{left:-144px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._1GEgjmAtrP3MnnLuj3LJ89{left:-162px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._1xtKzHQ9R2tgXSRDNagUn{left:-180px;top:-18px}._3ZulctU64c4xMbOsF_DrtK._2oC9ENB-zVYRVcnWmU5wqA{left:-198px;top:-18px}._3ZulctU64c4xMbOsF_DrtK.aJJiC5hX5gAV1oVd2hjy3{left:-216px;top:-18px}._3ZulctU64c4xMbOsF_DrtK.PhNfmgeWIBTonKIy7CTEE{left:-234px;top:-18px}._3ZulctU64c4xMbOsF_DrtK.Jrh8UeH3NJTkM898EUeC8,._3ZulctU64c4xMbOsF_DrtK._1w-EBQ6a-twVCNdL0gwpCN{left:0;top:-36px}._3ZulctU64c4xMbOsF_DrtK._35hAXLAVWy8pY6AsmsUiwk{left:-18px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2cnTV7yN3vFFC7hhrtUUrU{left:-36px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._3R15lUZvf47pY7gcliHeyQ{left:-54px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2MlBJwzzExL889Ek5wqK5B{left:-72px;top:-36px}._3ZulctU64c4xMbOsF_DrtK.BrIBfwMjWDB3byctdQOHu{left:-90px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2-9qaQebSigZB6j3YZc7rw{left:-108px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2vUGXX5rU8CRyBSpnxhlAh{left:-126px;top:-36px}._3ZulctU64c4xMbOsF_DrtK.nunhwXEdlRBM2Bs6ddLhu{left:-144px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2QNO7tLqJjMS_2lWMaDPsW{left:-162px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._3szmJ6J45gdytDruFitjxn{left:-180px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._2sFQxlAZxv7IkVlB3wrQDU{left:-198px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._1DPXU2s2tHM7R5xBTGTH0U{left:-234px;top:-36px}._3ZulctU64c4xMbOsF_DrtK._27HjsXyLonP1OEVSKIbpys{left:0;top:-54px}._3ZulctU64c4xMbOsF_DrtK._1tXHmRHGNKDD55RHU9KzOT{left:-18px;top:-54px}._3ZulctU64c4xMbOsF_DrtK.yoDvXNg4g_UmsPBOce8Hq{left:-36px;top:-54px}._3ZulctU64c4xMbOsF_DrtK.O9BCfVAer-CNLIPiBVsCK{left:-54px;top:-54px}._3ZulctU64c4xMbOsF_DrtK._33ChZAJj4dlsrVt8M_FmeY{left:-108px;top:-54px}._3ZulctU64c4xMbOsF_DrtK._1uyDBN4wHNMscMXrSSMYZw{left:-126px;top:-54px}._3ZulctU64c4xMbOsF_DrtK._3z5scgvFClfm_EwLfnfIgM{left:-144px;top:-54px}._3ZulctU64c4xMbOsF_DrtK._15wtJTjzBd0jjBnkExEQpU{left:-162px;top:-54px}","",{version:3,sources:["webpack://./src/spreadsheet/HtmlElementHelpers.module.scss","webpack://./src/spreadsheet/styles.scss"],names:[],mappings:"AAIA,uBACE,iBAAA,CACA,eAAA,CACA,UAAA,CACA,WAAA,CACA,oBAAA,CAGF,yBACE,kBAAA,CAGF,yBACE,iBAAA,CACA,WAAA,CACA,UAAA,CACA,KAAA,CACA,MAAA,CAGF,yBACE,aAAA,CACA,YAAA,CAIA,gDACE,UAAA,CAEA,yEACE,WAAA,CAKN,kDCtCE,cAAA,CACA,WAAA,CACA,4BAAA,CDuCA,iBAAA,CACA,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,YAAA,CACA,kBAAA,CC1CA,gEACE,wBAAA,CAGF,8DACE,0BAAA,CAGF,oEACE,mBAAA,CACA,WAAA,CDmCJ,yBACE,iBAAA,CACA,WAAA,CACA,YAAA,CACA,WAAA,CACA,wDAAA,CAEA,iDACE,MAAA,CACA,KAAA,CAEF,iDACE,UAAA,CACA,KAAA,CAEF,iDACE,UAAA,CACA,KAAA,CAEF,+CACE,UAAA,CACA,KAAA,CAEF,iDACE,UAAA,CACA,KAAA,CAEF,iDACE,UAAA,CACA,KAAA,CAEF,+CACE,WAAA,CACA,KAAA,CAEF,iDACE,WAAA,CACA,KAAA,CAEF,iDACE,WAAA,CACA,KAAA,CAEF,iDACE,WAAA,CACA,KAAA,CAEF,+CACE,WAAA,CACA,KAAA,CAEF,iDACE,WAAA,CACA,KAAA,CAEF,iGAEE,WAAA,CACA,KAAA,CAEF,mGAEE,WAAA,CACA,KAAA,CAEF,gGAEE,MAAA,CACA,SAAA,CAEF,gGAEE,UAAA,CACA,SAAA,CAEF,mGAEE,UAAA,CACA,SAAA,CAEF,mGAEE,UAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,gDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,+CACE,WAAA,CACA,SAAA,CAEF,+CACE,WAAA,CACA,SAAA,CAEF,gGAEE,MAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,+CACE,UAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,+CACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,MAAA,CACA,SAAA,CAEF,iDACE,UAAA,CACA,SAAA,CAEF,+CACE,UAAA,CACA,SAAA,CAEF,+CACE,UAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA,CAEF,iDACE,WAAA,CACA,SAAA",sourcesContent:["@import './styles.scss';\n\n$iconSize: 18px;\n\n.iconContainer {\n  position: relative;\n  overflow: hidden;\n  width: 18px;\n  height: 18px;\n  display: inline-block;\n}\n\n.text {\n  white-space: nowrap;\n}\n\n.tooltip {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n}\n\n.dropdownContent {\n  overflow: auto;\n  display: flex;\n}\n\n.dropdownIconButton {\n  .arrowDownIconContainer {\n    width: 10px;\n\n    .arrowDown {\n      left: -130px;\n    }\n  }\n}\n\n.iconButton,\n.dropdownButton {\n  @include button();\n  position: relative;\n  user-select: none;\n  padding: 6px;\n  border-radius: 2px;\n  display: flex;\n  align-items: center;\n}\n\n.icon {\n  position: absolute;\n  width: 262px;\n  height: 444px;\n  opacity: 0.65;\n  background-image: url('../icons/icons.svg');\n\n  &.undo {\n    left: 0;\n    top: 0;\n  }\n  &.redo {\n    left: -1 * $iconSize;\n    top: 0;\n  }\n  &.print {\n    left: -2 * $iconSize;\n    top: 0;\n  }\n  &.paintFormat {\n    left: -3 * $iconSize;\n    top: 0;\n  }\n  &.clearFormat {\n    left: -4 * $iconSize;\n    top: 0;\n  }\n  &.bold {\n    left: -5 * $iconSize;\n    top: 0;\n  }\n  &.italic {\n    left: -6 * $iconSize;\n    top: 0;\n  }\n  &.underline {\n    left: -7 * $iconSize;\n    top: 0;\n  }\n  &.strikeThrough {\n    left: -8 * $iconSize;\n    top: 0;\n  }\n  &.fontColor {\n    left: -9 * $iconSize;\n    top: 0;\n  }\n  &.backgroundColor {\n    left: -10 * $iconSize;\n    top: 0;\n  }\n  &.merge {\n    left: -11 * $iconSize;\n    top: 0;\n  }\n  &.alignLeft,\n  &[data-active-icon='left'] {\n    left: -12 * $iconSize;\n    top: 0;\n  }\n  &.alignCenter,\n  &[data-active-icon='center'] {\n    left: -13 * $iconSize;\n    top: 0;\n  }\n  &.alignRight,\n  &[data-active-icon='right'] {\n    left: 0;\n    top: -1 * $iconSize;\n  }\n  &.alignTop,\n  &[data-active-icon='top'] {\n    left: -1 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.alignMiddle,\n  &[data-active-icon='middle'] {\n    left: -2 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.alignBottom,\n  &[data-active-icon='bottom'] {\n    left: -3 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.textWrap {\n    left: -4 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.autoFilter {\n    left: -5 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.functions {\n    left: -6 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.arrowDown {\n    left: -7 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.arrowRight {\n    left: -8 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.link {\n    left: -9 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.chart {\n    left: -10 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.freeze {\n    left: -11 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.ellipsis {\n    left: -12 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.add {\n    left: -13 * $iconSize;\n    top: -1 * $iconSize;\n  }\n  &.borderAll,\n  &.borders {\n    left: 0;\n    top: -2 * $iconSize;\n  }\n  &.borderInside {\n    left: -1 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderHorizontal {\n    left: -2 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderVertical {\n    left: -3 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderOutside {\n    left: -4 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderLeft {\n    left: -5 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderTop {\n    left: -6 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderRight {\n    left: -7 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderBottom {\n    left: -8 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.borderNone {\n    left: -9 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.lineColor {\n    left: -10 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.lineType {\n    left: -11 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.close {\n    left: -13 * $iconSize;\n    top: -2 * $iconSize;\n  }\n  &.chevronDown {\n    left: 0;\n    top: -3 * $iconSize;\n  }\n  &.chevronUp {\n    left: -1 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.chevronLeft {\n    left: -2 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.chevronRight {\n    left: -3 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.export {\n    left: -6 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.formula {\n    left: -7 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.hamburger {\n    left: -8 * $iconSize;\n    top: -3 * $iconSize;\n  }\n  &.autosave {\n    left: -9 * $iconSize;\n    top: -3 * $iconSize;\n  }\n}\n","@mixin button {\n  cursor: pointer;\n  border: none;\n  background-color: transparent;\n\n  &:global(.active) {\n    background-color: #e6f4ea;\n  }\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.08);\n  }\n\n  &:disabled {\n    pointer-events: none;\n    opacity: 0.38;\n  }\n}\n\n@mixin group {\n  display: flex;\n}\n\n@mixin buttonAction {\n  padding: 10px 5px;\n  padding-left: 10px;\n  text-align: left;\n}\n\n@mixin buttonCommentAction {\n  @include button;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  letter-spacing: 0.25px;\n  line-height: 16px;\n  padding: 3px 12px 5px;\n}\n\n@mixin tippyContentNoPadding {\n  :global(.tippy-box[data-theme~='dropdown'] .tippy-content) {\n    padding: 0;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={iconContainer:"kLhW2Km6h22buePX0M46J",text:"_3mqxgAiAIEUyKm1Q9FnJal",tooltip:"_3eX8RrQSaWLRMZ9AAE9mZ7",dropdownContent:"_3qCAiCOzOo_lk1s2E7-NEt",dropdownIconButton:"_2FrE3gEJzLeeWWfpnBGKtl",arrowDownIconContainer:"BavNAlWs66RVOIGg8lF38",arrowDown:"_1d43wWekSyEdH62S_5f_hB",iconButton:"_1CE0Sjh9_42Gz6uvWklvjl",dropdownButton:"_3skVZiMTmQElKpjX4QqIOW",icon:"_3ZulctU64c4xMbOsF_DrtK",undo:"_1k6UkSRAwcJPAOrw3e01BA",redo:"_173GQgD6LDjJhYz6AmT3DO",print:"_2_zIhBtR1Bu4V4mDtTVu91",paintFormat:"hilacs9Y5ASHJFIWmplP4",clearFormat:"_1l8aiyYor6lfHhIYhRVFLG",bold:"_1FcbcZZSBOSz5Us_-GYn_C",italic:"qPTUEB5DaHk4Z3Cs7B3x6",underline:"_3dlFyiw7xdUMWNgP9cJsWe",strikeThrough:"_3lNguoUonzpO-Yfi5KDwRU",fontColor:"_3jyT9hX7KhUpv_KO-wg_ae",backgroundColor:"trVSF3njs-Pp2i5X-_rpx",merge:"_1t8s9749n2tgRYhkGV4rEc",alignLeft:"_26v4qxUD7soZr9aiOwMHmV",alignCenter:"_1MpKSLKV9QRKlLEY_9YNNc",alignRight:"BskmZjwmCNaBVxW2GX_0e",alignTop:"_27mg3jKy9ZLBsA_kBMJ5Xh",alignMiddle:"_3PsaIUsy54sa7ZzKXlQfL0",alignBottom:"_37c24VCFMOQqaUFDlmQYUO",textWrap:"_3AAB3OItq-ExIBLBtCkODB",autoFilter:"_1BmIBD_4sfiLEbVh1UjGY_",functions:"_3q1xrdmr-O-6jXI3rggQMs",arrowRight:"_3L5xMXTyD9xU0qUW-TS8e_",link:"_1GEgjmAtrP3MnnLuj3LJ89",chart:"_1xtKzHQ9R2tgXSRDNagUn",freeze:"_2oC9ENB-zVYRVcnWmU5wqA",ellipsis:"aJJiC5hX5gAV1oVd2hjy3",add:"PhNfmgeWIBTonKIy7CTEE",borderAll:"Jrh8UeH3NJTkM898EUeC8",borders:"_1w-EBQ6a-twVCNdL0gwpCN",borderInside:"_35hAXLAVWy8pY6AsmsUiwk",borderHorizontal:"_2cnTV7yN3vFFC7hhrtUUrU",borderVertical:"_3R15lUZvf47pY7gcliHeyQ",borderOutside:"_2MlBJwzzExL889Ek5wqK5B",borderLeft:"BrIBfwMjWDB3byctdQOHu",borderTop:"_2-9qaQebSigZB6j3YZc7rw",borderRight:"_2vUGXX5rU8CRyBSpnxhlAh",borderBottom:"nunhwXEdlRBM2Bs6ddLhu",borderNone:"_2QNO7tLqJjMS_2lWMaDPsW",lineColor:"_3szmJ6J45gdytDruFitjxn",lineType:"_2sFQxlAZxv7IkVlB3wrQDU",close:"_1DPXU2s2tHM7R5xBTGTH0U",chevronDown:"_27HjsXyLonP1OEVSKIbpys",chevronUp:"_1tXHmRHGNKDD55RHU9KzOT",chevronLeft:"yoDvXNg4g_UmsPBOce8Hq",chevronRight:"O9BCfVAer-CNLIPiBVsCK",export:"_33ChZAJj4dlsrVt8M_FmeY",formula:"_1uyDBN4wHNMscMXrSSMYZw",hamburger:"_3z5scgvFClfm_EwLfnfIgM",autosave:"_15wtJTjzBd0jjBnkExEQpU"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},349:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._1p3O6rqX3ePv_4ypLY6kU-{height:100%;position:relative;overflow:hidden;outline:none}","",{version:3,sources:["webpack://./src/spreadsheet/sheet/Sheet.module.scss"],names:[],mappings:"AAAA,yBACE,WAAA,CACA,iBAAA,CACA,eAAA,CACA,YAAA",sourcesContent:[".sheet {\n  height: 100%;\n  position: relative;\n  overflow: hidden;\n  outline: none;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={sheet:"_1p3O6rqX3ePv_4ypLY6kU-"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},350:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._2CUp-FJImEkx4YIQ5a5ZyU{border:none;outline:none;resize:none;overflow:auto;width:100%;height:100px}._3PvJ64WkP7z9Uo9hllXsLd{display:flex;flex-direction:row;justify-content:flex-start}._3fS1fDKbqKwW8_XSTascrP{cursor:pointer;border:none;background-color:transparent;border-radius:4px;font-weight:500;font-size:14px;letter-spacing:.25px;line-height:16px;padding:3px 12px 5px;background-color:#43cea2;color:#fff;border:none;margin-right:10px}._3fS1fDKbqKwW8_XSTascrP.active{background-color:#e6f4ea}._3fS1fDKbqKwW8_XSTascrP:hover{background:rgba(0,0,0,.08)}._3fS1fDKbqKwW8_XSTascrP:disabled{pointer-events:none;opacity:.38}._1R0cUvTGw7cMaOo296cO0A{cursor:pointer;border:none;background-color:transparent;border-radius:4px;font-weight:500;font-size:14px;letter-spacing:.25px;line-height:16px;padding:3px 12px 5px;background-color:#fff;color:#43cea2;border:1px solid #dadce0}._1R0cUvTGw7cMaOo296cO0A.active{background-color:#e6f4ea}._1R0cUvTGw7cMaOo296cO0A:hover{background:rgba(0,0,0,.08)}._1R0cUvTGw7cMaOo296cO0A:disabled{pointer-events:none;opacity:.38}","",{version:3,sources:["webpack://./src/spreadsheet/sheet/comment/Comment.module.scss","webpack://./src/spreadsheet/styles.scss"],names:[],mappings:"AAEA,yBACE,WAAA,CACA,YAAA,CACA,WAAA,CACA,aAAA,CACA,UAAA,CACA,YAAA,CAGF,yBACE,YAAA,CACA,kBAAA,CACA,0BAAA,CAGF,yBChBE,cAAA,CACA,WAAA,CACA,4BAAA,CA4BA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,oBAAA,CACA,gBAAA,CACA,oBAAA,CDhBA,wBAAA,CACA,UAAA,CACA,WAAA,CACA,iBAAA,CClBA,gCACE,wBAAA,CAGF,+BACE,0BAAA,CAGF,kCACE,mBAAA,CACA,WAAA,CDWJ,yBCzBE,cAAA,CACA,WAAA,CACA,4BAAA,CA4BA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,oBAAA,CACA,gBAAA,CACA,oBAAA,CDPA,qBAAA,CACA,aAAA,CACA,wBAAA,CC1BA,gCACE,wBAAA,CAGF,+BACE,0BAAA,CAGF,kCACE,mBAAA,CACA,WAAA",sourcesContent:["@import '../../styles.scss';\n\n.textarea {\n  border: none;\n  outline: none;\n  resize: none;\n  overflow: auto;\n  width: 100%;\n  height: 100px;\n}\n\n.buttonContainer {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n}\n\n.successButton {\n  @include buttonCommentAction;\n\n  background-color: #43cea2;\n  color: #fff;\n  border: none;\n  margin-right: 10px;\n}\n\n.cancelButton {\n  @include buttonCommentAction;\n\n  background-color: #fff;\n  color: #43cea2;\n  border: 1px solid #dadce0;\n}\n","@mixin button {\n  cursor: pointer;\n  border: none;\n  background-color: transparent;\n\n  &:global(.active) {\n    background-color: #e6f4ea;\n  }\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.08);\n  }\n\n  &:disabled {\n    pointer-events: none;\n    opacity: 0.38;\n  }\n}\n\n@mixin group {\n  display: flex;\n}\n\n@mixin buttonAction {\n  padding: 10px 5px;\n  padding-left: 10px;\n  text-align: left;\n}\n\n@mixin buttonCommentAction {\n  @include button;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  letter-spacing: 0.25px;\n  line-height: 16px;\n  padding: 3px 12px 5px;\n}\n\n@mixin tippyContentNoPadding {\n  :global(.tippy-box[data-theme~='dropdown'] .tippy-content) {\n    padding: 0;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={textarea:"_2CUp-FJImEkx4YIQ5a5ZyU",buttonContainer:"_3PvJ64WkP7z9Uo9hllXsLd",successButton:"_3fS1fDKbqKwW8_XSTascrP",cancelButton:"_1R0cUvTGw7cMaOo296cO0A"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},351:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._331EEj3bWOvnoH5jG6l25W{display:flex;flex-direction:column;position:relative;height:100%;font-family:Arial,sans-serif}._2zFI10fLLb3kidhXPJsJ4d{flex:1}","",{version:3,sources:["webpack://./src/spreadsheet/Spreadsheet.module.scss"],names:[],mappings:"AAAA,yBACE,YAAA,CACA,qBAAA,CACA,iBAAA,CACA,WAAA,CACA,4BAAA,CAGF,yBACE,MAAA",sourcesContent:[".spreadsheet {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  height: 100%;\n  font-family: Arial, sans-serif;\n}\n\n.sheets {\n  flex: 1;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={spreadsheet:"_331EEj3bWOvnoH5jG6l25W",sheets:"_2zFI10fLLb3kidhXPJsJ4d"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},352:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,'._2Ld5BQCDqJCdq9y53KUJQT{flex-wrap:wrap;display:flex;align-items:center;background:#f5f6f7;border-bottom:1px solid #e0e2e4}._2Ld5BQCDqJCdq9y53KUJQT .tippy-box[data-theme~="dropdown"] .tippy-content{padding:0}button._1tYno3Ng0nLsj1xP-L0tze,button._3f2bku7dM_MWshXiRlBUfx{padding-left:15px;padding-right:15px}._1tYno3Ng0nLsj1xP-L0tze,._3f2bku7dM_MWshXiRlBUfx,._1qRMTRcaoWcX9SSzDkDMyg{cursor:pointer;border:none;background-color:transparent;padding:10px 5px;padding-left:10px;text-align:left}._1tYno3Ng0nLsj1xP-L0tze.active,._3f2bku7dM_MWshXiRlBUfx.active,._1qRMTRcaoWcX9SSzDkDMyg.active{background-color:#e6f4ea}._1tYno3Ng0nLsj1xP-L0tze:hover,._3f2bku7dM_MWshXiRlBUfx:hover,._1qRMTRcaoWcX9SSzDkDMyg:hover{background:rgba(0,0,0,.08)}._1tYno3Ng0nLsj1xP-L0tze:disabled,._3f2bku7dM_MWshXiRlBUfx:disabled,._1qRMTRcaoWcX9SSzDkDMyg:disabled{pointer-events:none;opacity:.38}._3tJEus4v3pA98FxXoeHgnQ{max-height:400px}.v31fG63cGhQiY_Ve_ccsO{margin-left:7px}.yCr9Hs1Hr82Du-6AlUER0,._3YanjrLOn8TDFag6iBoOBr,._3tJEus4v3pA98FxXoeHgnQ,._38LP2sS0RE6UY7vuxdpDVS{flex-direction:column}._2ffJD7BqmPQB4LaLsXDPsf{overflow-x:hidden}._3p-dD6j7oVuSNoTG2mourP{display:flex}.KyISr3Wn7jYtPac-w_2yP{display:flex}.KyISr3Wn7jYtPac-w_2yP:after{content:"";background-color:#e0e2e4;margin-left:6px;margin-right:6px;display:block;width:1px}.KyISr3Wn7jYtPac-w_2yP:last-of-type:after{display:none}._3KmV6i4SLIxw6t1VVNexUq{width:75%;transform:translate(-50%, 0);left:50%;bottom:4px;height:4px;position:absolute;background-color:#fff}',"",{version:3,sources:["webpack://./src/spreadsheet/toolbar/Toolbar.module.scss","webpack://./src/spreadsheet/styles.scss"],names:[],mappings:"AAEA,yBACE,cAAA,CACA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,+BAAA,CCiCA,2EACE,SAAA,CD7BJ,8DAEE,iBAAA,CACA,kBAAA,CAGF,2ECjBE,cAAA,CACA,WAAA,CACA,4BAAA,CAqBA,gBAAA,CACA,iBAAA,CACA,eAAA,CArBA,gGACE,wBAAA,CAGF,6FACE,0BAAA,CAGF,sGACE,mBAAA,CACA,WAAA,CDUJ,yBACE,gBAAA,CAGF,uBACE,eAAA,CAGF,kGAIE,qBAAA,CAGF,yBACE,iBAAA,CAGF,yBACE,YAAA,CAGF,uBC5BE,YAAA,CD+BA,6BACE,UAAA,CACA,wBAAA,CACA,eAAA,CACA,gBAAA,CACA,aAAA,CACA,SAAA,CAGF,0CACE,YAAA,CAIJ,yBACE,SAAA,CACA,4BAAA,CACA,QAAA,CACA,UAAA,CACA,UAAA,CACA,iBAAA,CACA,qBAAA",sourcesContent:["@import '../styles.scss';\n\n.toolbar {\n  flex-wrap: wrap;\n  display: flex;\n  align-items: center;\n  background: #f5f6f7;\n  border-bottom: 1px solid #e0e2e4;\n\n  @include tippyContentNoPadding;\n}\n\nbutton.textFormatButton,\nbutton.fontSizeButton {\n  padding-left: 15px;\n  padding-right: 15px;\n}\n\n.textFormatButton,\n.fontSizeButton,\n.functionNameButton {\n  @include button();\n  @include buttonAction;\n}\n\n.functions {\n  max-height: 400px;\n}\n\n.autosaveText {\n  margin-left: 7px;\n}\n\n.textFormats,\n.fontSizes,\n.functions,\n.borders {\n  flex-direction: column;\n}\n\n.colorPicker {\n  overflow-x: hidden;\n}\n\n.bordersGroup {\n  display: flex;\n}\n\n.group {\n  @include group;\n\n  &:after {\n    content: '';\n    background-color: #e0e2e4;\n    margin-left: 6px;\n    margin-right: 6px;\n    display: block;\n    width: 1px;\n  }\n\n  &:last-of-type:after {\n    display: none;\n  }\n}\n\n.colorBar {\n  width: 75%;\n  transform: translate(-50%, 0);\n  left: 50%;\n  bottom: 4px;\n  height: 4px;\n  position: absolute;\n  background-color: white;\n}\n","@mixin button {\n  cursor: pointer;\n  border: none;\n  background-color: transparent;\n\n  &:global(.active) {\n    background-color: #e6f4ea;\n  }\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.08);\n  }\n\n  &:disabled {\n    pointer-events: none;\n    opacity: 0.38;\n  }\n}\n\n@mixin group {\n  display: flex;\n}\n\n@mixin buttonAction {\n  padding: 10px 5px;\n  padding-left: 10px;\n  text-align: left;\n}\n\n@mixin buttonCommentAction {\n  @include button;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  letter-spacing: 0.25px;\n  line-height: 16px;\n  padding: 3px 12px 5px;\n}\n\n@mixin tippyContentNoPadding {\n  :global(.tippy-box[data-theme~='dropdown'] .tippy-content) {\n    padding: 0;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={toolbar:"_2Ld5BQCDqJCdq9y53KUJQT",textFormatButton:"_1tYno3Ng0nLsj1xP-L0tze",fontSizeButton:"_3f2bku7dM_MWshXiRlBUfx",functionNameButton:"_1qRMTRcaoWcX9SSzDkDMyg",functions:"_3tJEus4v3pA98FxXoeHgnQ",autosaveText:"v31fG63cGhQiY_Ve_ccsO",textFormats:"yCr9Hs1Hr82Du-6AlUER0",fontSizes:"_3YanjrLOn8TDFag6iBoOBr",borders:"_38LP2sS0RE6UY7vuxdpDVS",colorPicker:"_2ffJD7BqmPQB4LaLsXDPsf",bordersGroup:"_3p-dD6j7oVuSNoTG2mourP",group:"KyISr3Wn7jYtPac-w_2yP",colorBar:"_3KmV6i4SLIxw6t1VVNexUq"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},353:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,"._3x3beBxWiG9h4Kd81L9jbv{position:relative;background:#fff}._1ZVNy6K3FVqFCxBPtS2mw8{border:1px solid #d9dbe4;padding:5px}.FG8VALNh3Rai5yrmG_P6k{display:flex;align-items:center}._1KAXbF-_klr8NCqmPyMsUh{outline:none;flex:1 1}.YoFcybiPE5mbkEaO1hh2C{margin:0 5px 0 0}","",{version:3,sources:["webpack://./src/spreadsheet/formulaBar/FormulaBar.module.scss"],names:[],mappings:"AAAA,yBACE,iBAAA,CACA,eAAA,CAGF,yBACE,wBAAA,CACA,WAAA,CAGF,uBACE,YAAA,CACA,kBAAA,CAGF,yBACE,YAAA,CACA,QAAA,CAGF,uBACE,gBAAA",sourcesContent:[".formulaBar {\n  position: relative;\n  background: #fff;\n}\n\n.editorArea {\n  border: 1px solid #d9dbe4;\n  padding: 5px;\n}\n\n.editableContentContainer {\n  display: flex;\n  align-items: center;\n}\n\n.editableContent {\n  outline: none;\n  flex: 1 1;\n}\n\n.iconContainer {\n  margin: 0 5px 0 0;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={formulaBar:"_3x3beBxWiG9h4Kd81L9jbv",editorArea:"_1ZVNy6K3FVqFCxBPtS2mw8",editableContentContainer:"FG8VALNh3Rai5yrmG_P6k",editableContent:"_1KAXbF-_klr8NCqmPyMsUh",iconContainer:"YoFcybiPE5mbkEaO1hh2C"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},354:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,'._23KWbiKuahJVS3AS8Zc9LW{padding:0 25px;height:40px;user-select:none;background:#f5f6f7;box-shadow:0 -1px 3px -1px #a9a4a4;font-family:"Nunito Sans",Arial;display:flex}._16IHO9mamzCuhqkkrPhocD{display:flex}._1JcxFiInc5oP1Feiob4xMV{background-color:#fff;box-shadow:0 0px 3px -1px #a9a4a4;display:inline-block}img{height:13px;width:13px}.D5M75KWya4uVAi1EnlOsR,._2mjemDcZTbqKMKgSDoG17m{display:flex}.D5M75KWya4uVAi1EnlOsR>button,._2mjemDcZTbqKMKgSDoG17m>button{border-radius:0}.SdpridFFFrj9TYMhfthAC{display:flex;align-items:center;cursor:pointer;padding:11.5px 16px;font-size:15px;font-weight:550;color:#80868b;letter-spacing:.025rem;border-right:1px solid #e8eaed}.SdpridFFFrj9TYMhfthAC.active{background-color:#fff}.SdpridFFFrj9TYMhfthAC:not(.active):hover{background-color:#ddd}._23LzA-UC_-pmyLUvVvoC4j[contenteditable=true]{color:#222;border:2px solid #43cea2;outline:none;border-radius:4px;padding:4px 22px 4px 4px}.uTLGY6hekNarV5NPnsUPr{position:relative}._35cVz9qCjDaT3Y8a-k5v6D{border:0;padding:0;background:none;cursor:pointer;font-size:14px;letter-spacing:.2px;line-height:20px;padding:12px 16px;text-align:left}._35cVz9qCjDaT3Y8a-k5v6D:hover{background-color:#ddd}._1qOw0BoYo68ta0dsPrwmcR:hover,.fgbPji-alGJ_StnWiERiU:hover{background-color:#ddd}._1qOw0BoYo68ta0dsPrwmcR,.fgbPji-alGJ_StnWiERiU{cursor:pointer;border:none;background-color:transparent;font-size:14px;letter-spacing:.2px;padding:12px 16px;text-align:left}._1qOw0BoYo68ta0dsPrwmcR.active,.fgbPji-alGJ_StnWiERiU.active{background-color:#e6f4ea}._1qOw0BoYo68ta0dsPrwmcR:hover,.fgbPji-alGJ_StnWiERiU:hover{background:rgba(0,0,0,.08)}._1qOw0BoYo68ta0dsPrwmcR:disabled,.fgbPji-alGJ_StnWiERiU:disabled{pointer-events:none;opacity:.38}._2GzPc5UMUvOM3GAEAeqR3c{display:flex;flex-direction:column}._1kNWdpyTqhxk-RvfLDU4GQ{display:flex;flex-direction:column;max-height:400px;overflow:auto}.PCtioplhL05BhNbkWm_WO{display:flex;flex-direction:row;margin-left:10px}.PCtioplhL05BhNbkWm_WO>.uTLGY6hekNarV5NPnsUPr:first-of-type{border-left:1px solid #e8eaed}',"",{version:3,sources:["webpack://./src/spreadsheet/bottomBar/BottomBar.module.scss","webpack://./src/spreadsheet/styles.scss"],names:[],mappings:"AAEA,yBACE,cAAA,CACA,WAAA,CACA,gBAAA,CACA,kBAAA,CACA,kCAAA,CACA,+BAAA,CACA,YAAA,CAGF,yBACE,YAAA,CAGF,yBACE,qBAAA,CACA,iCAAA,CACA,oBAAA,CAGF,IACE,WAAA,CACA,UAAA,CAGF,gDAEE,YAAA,CAEA,8DACE,eAAA,CAIJ,uBACE,YAAA,CACA,kBAAA,CACA,cAAA,CACA,mBAAA,CACA,cAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,8BAAA,CAEA,8BACE,qBAAA,CAGF,0CACE,qBAAA,CAIJ,+CACE,UAAA,CACA,wBAAA,CACA,YAAA,CACA,iBAAA,CACA,wBAAA,CAGF,uBACE,iBAAA,CAGF,yBACE,QAAA,CACA,SAAA,CACA,eAAA,CACA,cAAA,CACA,cAAA,CACA,mBAAA,CACA,gBAAA,CACA,iBAAA,CACA,eAAA,CAGF,+BACE,qBAAA,CAGF,4DAEE,qBAAA,CAGF,gDCxFE,cAAA,CACA,WAAA,CACA,4BAAA,CDyFA,cAAA,CACA,mBAAA,CACA,iBAAA,CACA,eAAA,CC1FA,8DACE,wBAAA,CAGF,4DACE,0BAAA,CAGF,kEACE,mBAAA,CACA,WAAA,CDmFJ,yBACE,YAAA,CACA,qBAAA,CAGF,yBACE,YAAA,CACA,qBAAA,CACA,gBAAA,CACA,aAAA,CAGF,uBACE,YAAA,CACA,kBAAA,CACA,gBAAA,CAEA,4DACE,6BAAA",sourcesContent:["@import '../styles.scss';\n\n.bottomBar {\n  padding: 0 25px;\n  height: 40px;\n  user-select: none;\n  background: #f5f6f7;\n  box-shadow: 0 -1px 3px -1px rgb(169 164 164);\n  font-family: 'Nunito Sans', Arial;\n  display: flex;\n}\n\n.content {\n  display: flex;\n}\n\n.tab {\n  background-color: #fff;\n  box-shadow: 0 0px 3px -1px rgb(169 164 164);\n  display: inline-block;\n}\n\nimg {\n  height: 13px;\n  width: 13px;\n}\n\n.createNewSheetButtonContainer,\n.sheetSelectionButtonContainer {\n  display: flex;\n\n  > button {\n    border-radius: 0;\n  }\n}\n\n.sheetTab {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  padding: 11.5px 16px;\n  font-size: 15px;\n  font-weight: 550;\n  color: #80868b;\n  letter-spacing: 0.025rem;\n  border-right: 1px solid #e8eaed;\n\n  &:global(.active) {\n    background-color: #fff;\n  }\n\n  &:not(:global(.active)):hover {\n    background-color: #ddd;\n  }\n}\n\n.nameContainer[contenteditable='true'] {\n  color: #222;\n  border: 2px solid #43cea2;\n  outline: none;\n  border-radius: 4px;\n  padding: 4px 22px 4px 4px;\n}\n\n.sheetTabContainer {\n  position: relative;\n}\n\n.sheetSelectionDropdownButton {\n  border: 0;\n  padding: 0;\n  background: none;\n  cursor: pointer;\n  font-size: 14px;\n  letter-spacing: 0.2px;\n  line-height: 20px;\n  padding: 12px 16px;\n  text-align: left;\n}\n\n.sheetSelectionDropdownButton:hover {\n  background-color: #ddd;\n}\n\n.renameSheetButton:hover,\n.deleteSheetButton:hover {\n  background-color: #ddd;\n}\n\n.renameSheetButton,\n.deleteSheetButton {\n  @include button;\n  font-size: 14px;\n  letter-spacing: 0.2px;\n  padding: 12px 16px;\n  text-align: left;\n}\n\n.sheetTabDropdownContent {\n  display: flex;\n  flex-direction: column;\n}\n\n.sheetSelectionDropdownContent {\n  display: flex;\n  flex-direction: column;\n  max-height: 400px;\n  overflow: auto;\n}\n\n.scrollSliderContainer {\n  display: flex;\n  flex-direction: row;\n  margin-left: 10px;\n\n  > .sheetTabContainer:first-of-type {\n    border-left: 1px solid #e8eaed;\n  }\n}\n","@mixin button {\n  cursor: pointer;\n  border: none;\n  background-color: transparent;\n\n  &:global(.active) {\n    background-color: #e6f4ea;\n  }\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.08);\n  }\n\n  &:disabled {\n    pointer-events: none;\n    opacity: 0.38;\n  }\n}\n\n@mixin group {\n  display: flex;\n}\n\n@mixin buttonAction {\n  padding: 10px 5px;\n  padding-left: 10px;\n  text-align: left;\n}\n\n@mixin buttonCommentAction {\n  @include button;\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  letter-spacing: 0.25px;\n  line-height: 16px;\n  padding: 3px 12px 5px;\n}\n\n@mixin tippyContentNoPadding {\n  :global(.tippy-box[data-theme~='dropdown'] .tippy-content) {\n    padding: 0;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={bottomBar:"_23KWbiKuahJVS3AS8Zc9LW",content:"_16IHO9mamzCuhqkkrPhocD",tab:"_1JcxFiInc5oP1Feiob4xMV",createNewSheetButtonContainer:"D5M75KWya4uVAi1EnlOsR",sheetSelectionButtonContainer:"_2mjemDcZTbqKMKgSDoG17m",sheetTab:"SdpridFFFrj9TYMhfthAC",nameContainer:"_23LzA-UC_-pmyLUvVvoC4j",sheetTabContainer:"uTLGY6hekNarV5NPnsUPr",sheetSelectionDropdownButton:"_35cVz9qCjDaT3Y8a-k5v6D",renameSheetButton:"_1qOw0BoYo68ta0dsPrwmcR",deleteSheetButton:"fgbPji-alGJ_StnWiERiU",sheetTabDropdownContent:"_2GzPc5UMUvOM3GAEAeqR3c",sheetSelectionDropdownContent:"_1kNWdpyTqhxk-RvfLDU4GQ",scrollSliderContainer:"PCtioplhL05BhNbkWm_WO"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},515:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/icons.e340e754.svg"},541:function(module,exports,__webpack_require__){__webpack_require__(542),__webpack_require__(697),__webpack_require__(698),__webpack_require__(900),__webpack_require__(906),__webpack_require__(907),__webpack_require__(908),__webpack_require__(905),__webpack_require__(902),__webpack_require__(909),__webpack_require__(903),__webpack_require__(904),__webpack_require__(910),module.exports=__webpack_require__(872)},608:function(module,exports){},698:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(401)},872:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(401).configure)([__webpack_require__(873),__webpack_require__(874)],module,!1)}).call(this,__webpack_require__(195)(module))},873:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=873},874:function(module,exports,__webpack_require__){var map={"./spreadsheet/Spredsheet.stories.ts":901};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=874},901:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default})),__webpack_require__.d(__webpack_exports__,"FrozenCells",(function(){return FrozenCells})),__webpack_require__.d(__webpack_exports__,"MergedCells",(function(){return MergedCells})),__webpack_require__.d(__webpack_exports__,"DifferentSizeCells",(function(){return DifferentSizeCells})),__webpack_require__.d(__webpack_exports__,"Mobile",(function(){return Mobile})),__webpack_require__.d(__webpack_exports__,"MillionRows",(function(){return MillionRows})),__webpack_require__.d(__webpack_exports__,"CustomStyles",(function(){return CustomStyles})),__webpack_require__.d(__webpack_exports__,"BareMinimumSpreadsheet",(function(){return BareMinimumSpreadsheet})),__webpack_require__.d(__webpack_exports__,"NoHyperformula",(function(){return NoHyperformula})),__webpack_require__.d(__webpack_exports__,"CustomSizeSpreadsheet",(function(){return CustomSizeSpreadsheet})),__webpack_require__.d(__webpack_exports__,"MultipleSpreadsheets",(function(){return MultipleSpreadsheets})),__webpack_require__.d(__webpack_exports__,"AllCurrencySymbols",(function(){return AllCurrencySymbols})),__webpack_require__.d(__webpack_exports__,"CellsData",(function(){return CellsData})),__webpack_require__.d(__webpack_exports__,"Formulas",(function(){return Formulas}));__webpack_require__(18),__webpack_require__(3),__webpack_require__(56),__webpack_require__(167),__webpack_require__(480),__webpack_require__(19),__webpack_require__(875),__webpack_require__(105);var defaultOptions={undoRedoLimit:20,row:{amount:1e3,minSize:25,defaultSize:25},col:{amount:26,minSize:60,defaultSize:100},exportSpreadsheetName:"Powersheet.xlsx",touchScrollSpeed:1.2},injectStylesIntoStyleTag=(__webpack_require__(876),__webpack_require__(51)),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),spreadsheet_tippy=__webpack_require__(342),tippy_options={insert:"head",singleton:!1},lodash=(injectStylesIntoStyleTag_default()(spreadsheet_tippy.a,tippy_options),spreadsheet_tippy.a.locals,__webpack_require__(199),__webpack_require__(43),__webpack_require__(4),__webpack_require__(5),__webpack_require__(6),__webpack_require__(81),__webpack_require__(30),__webpack_require__(15),__webpack_require__(331),__webpack_require__(42),__webpack_require__(38)),Layer=(__webpack_require__(26),__webpack_require__(120),__webpack_require__(2),__webpack_require__(7),__webpack_require__(9),__webpack_require__(12),__webpack_require__(11),__webpack_require__(510)),Rect=__webpack_require__(86),Group=__webpack_require__(114),spreadsheet_events=(__webpack_require__(32),{scroll:{vertical:"sv-scroll",horizontal:"sh-scroll"},scrollWheel:{scroll:"sw-scroll"},toolbar:{change:"t-change"},cellEditor:{change:"ce-change"},history:{push:"hp-push"},resize:{row:{start:"rr-start",move:"rr-move",end:"rr-end"},col:{start:"rc-start",move:"rc-move",end:"rc-end"}},merge:{add:"m-add",unMerge:"m-unMerge"},persist:{save:"p-save"},selector:{startSelection:"s-startSelection",moveSelection:"s-moveSelection",endSelection:"s-endSelection"}});__webpack_require__(481),__webpack_require__(20),__webpack_require__(21),__webpack_require__(482),__webpack_require__(44),__webpack_require__(68),__webpack_require__(34);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_SimpleCellAddress=function(){function SimpleCellAddress(sheet,row,col){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleCellAddress),this.sheet=sheet,this.row=row,this.col=col}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(SimpleCellAddress,[{key:"addressToString",value:function addressToString(){return""+String.fromCharCode("A".charCodeAt(0)+this.col)+(this.row+1)}},{key:"toCellId",value:function toCellId(){return this.sheet+"_"+this.row+"_"+this.col}}],[{key:"cellIdToAddress",value:function cellIdToAddress(cellId){var sections=cellId.split("_");return new SimpleCellAddress(parseInt(sections[0],10),parseInt(sections[1],10),parseInt(sections[2],10))}}]),SimpleCellAddress}();function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function RangeSimpleCellAddress_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_RangeSimpleCellAddress=function(){function RangeSimpleCellAddress(topLeftSimpleCellAddress,bottomRightSimpleCellAddress){var _this=this;!function RangeSimpleCellAddress_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RangeSimpleCellAddress),this.getArrayOfAddresses=function(){for(var addresses=[],y=0;y<_this.height();++y){addresses[y]=[];for(var x=0;x<_this.width();++x){var _simpleCellAddress=new cell_SimpleCellAddress(_this.topLeftSimpleCellAddress.sheet,_this.topLeftSimpleCellAddress.row+y,_this.topLeftSimpleCellAddress.col+x);addresses[y].push(_simpleCellAddress)}}return addresses},this.topLeftSimpleCellAddress=topLeftSimpleCellAddress,this.bottomRightSimpleCellAddress=bottomRightSimpleCellAddress}return function RangeSimpleCellAddress_createClass(Constructor,protoProps,staticProps){return protoProps&&RangeSimpleCellAddress_defineProperties(Constructor.prototype,protoProps),staticProps&&RangeSimpleCellAddress_defineProperties(Constructor,staticProps),Constructor}(RangeSimpleCellAddress,[{key:"height",value:function height(){return this.bottomRightSimpleCellAddress.row-this.topLeftSimpleCellAddress.row+1}},{key:"width",value:function width(){return this.bottomRightSimpleCellAddress.col-this.topLeftSimpleCellAddress.col+1}},{key:"iterateFromTopToBottom",value:regeneratorRuntime.mark((function iterateFromTopToBottom(type){var index;return regeneratorRuntime.wrap((function iterateFromTopToBottom$(_context){for(;;)switch(_context.prev=_context.next){case 0:index=this.topLeftSimpleCellAddress[type];case 1:if(!(index<=this.bottomRightSimpleCellAddress[type])){_context.next=7;break}return _context.next=4,index;case 4:index++,_context.next=1;break;case 7:case"end":return _context.stop()}}),iterateFromTopToBottom,this)}))},{key:"limitTopLeftAddressToAnotherRange",value:function limitTopLeftAddressToAnotherRange(rowColType,rangeSimpleCellAddress){rangeSimpleCellAddress.topLeftSimpleCellAddress[rowColType]<this.topLeftSimpleCellAddress[rowColType]&&(this.topLeftSimpleCellAddress[rowColType]=rangeSimpleCellAddress.topLeftSimpleCellAddress[rowColType])}},{key:"limitBottomRightAddressToAnotherRange",value:function limitBottomRightAddressToAnotherRange(rowColType,rangeSimpleCellAddress){rangeSimpleCellAddress.bottomRightSimpleCellAddress[rowColType]>this.bottomRightSimpleCellAddress[rowColType]&&(this.bottomRightSimpleCellAddress[rowColType]=rangeSimpleCellAddress.bottomRightSimpleCellAddress[rowColType])}},{key:"getCellsBetweenRange",value:function getCellsBetweenRange(sheet,getCell){var _step,cells=[],_iterator=_createForOfIteratorHelper(this.iterateFromTopToBottom("row"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,ri=_step.value,_iterator2=_createForOfIteratorHelper(this.iterateFromTopToBottom("col"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var ci=_step2.value,cell=getCell(new cell_SimpleCellAddress(sheet.sheetId,ri,ci));cells.push(cell)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return cells.filter((function filterOutAssociatedMergedCells(cell){return!(sheet.merger.associatedMergedCellAddressMap.get(cell.simpleCellAddress.toCellId())&&!sheet.spreadsheet.data.getIsCellAMergedCell(cell.simpleCellAddress))}))}}]),RangeSimpleCellAddress}();function Cell_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Cell_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Cell_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cell_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Cell_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_Cell=function(){function Cell(sheet,simpleCellAddress){!function Cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Cell),this.group=void 0,this.rect=void 0,this.spreadsheet=void 0,this.rangeSimpleCellAddress=void 0,this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.simpleCellAddress=simpleCellAddress,this.rangeSimpleCellAddress=new cell_RangeSimpleCellAddress(simpleCellAddress,simpleCellAddress),this.group=new Group.a,this.rect=new Rect.a(this.spreadsheet.styles.cell.rect);var _this$rangeSimpleCell=this.rangeSimpleCellAddress.topLeftSimpleCellAddress,row=_this$rangeSimpleCell.row,col=_this$rangeSimpleCell.col;this.group.x(this.sheet.cols.getAxis(col)-this.sheet.getViewportVector().x),this.group.y(this.sheet.rows.getAxis(row)-this.sheet.getViewportVector().y),this.rect.width(this.sheet.cols.getSize(col)),this.rect.height(this.sheet.rows.getSize(row)),this.group.add(this.rect),this.sheet.merger.setAssociatedMergedCellIds(this.simpleCellAddress);var mergedCellAddress=sheet.merger.associatedMergedCellAddressMap.get(simpleCellAddress.toCellId());mergedCellAddress&&this.setMergedCellProperties(mergedCellAddress)}return function Cell_createClass(Constructor,protoProps,staticProps){return protoProps&&Cell_defineProperties(Constructor.prototype,protoProps),staticProps&&Cell_defineProperties(Constructor,staticProps),Constructor}(Cell,[{key:"setMergedCellProperties",value:function setMergedCellProperties(rangeSimpleCellAddress){this.rangeSimpleCellAddress=rangeSimpleCellAddress;var _step,width=0,height=0,_iterator=Cell_createForOfIteratorHelper(this.rangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var index=_step.value;width+=this.sheet.cols.getSize(index)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=Cell_createForOfIteratorHelper(this.rangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _index=_step2.value;height+=this.sheet.rows.getSize(_index)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.rect.width(width),this.rect.height(height)}},{key:"getIsCellPartOfMerge",value:function getIsCellPartOfMerge(){return this.sheet.merger.associatedMergedCellAddressMap.has(this.rangeSimpleCellAddress.topLeftSimpleCellAddress.toCellId())}},{key:"getStickyGroupCellBelongsTo",value:function getStickyGroupCellBelongsTo(){return this.sheet.getStickyGroupType(this.isOnFrozenRow(),this.isOnFrozenCol())}},{key:"isOnFrozenRow",value:function isOnFrozenRow(){return this.sheet.rows.getIsFrozen(this.rangeSimpleCellAddress.topLeftSimpleCellAddress.row)}},{key:"isOnFrozenCol",value:function isOnFrozenCol(){return this.sheet.cols.getIsFrozen(this.rangeSimpleCellAddress.topLeftSimpleCellAddress.col)}},{key:"destroy",value:function destroy(){this.group.destroy()}},{key:"getClientRectWithoutStroke",value:function getClientRectWithoutStroke(){return this.group.getClientRect({skipStroke:!0})}}]),Cell}();function SelectedCell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var SelectedCell_SelectedCell=function(_Cell){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(SelectedCell,_Cell);var _super=_createSuper(SelectedCell);function SelectedCell(sheet,simpleCellAddress){var _this;return function SelectedCell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectedCell),(_this=_super.call(this,sheet,simpleCellAddress)).innerRect=void 0,_this.innerRect=new Rect.a,_this.setInnerRectProperties(),_this}return function SelectedCell_createClass(Constructor,protoProps,staticProps){return protoProps&&SelectedCell_defineProperties(Constructor.prototype,protoProps),staticProps&&SelectedCell_defineProperties(Constructor,staticProps),Constructor}(SelectedCell,[{key:"setInnerRectProperties",value:function setInnerRectProperties(){var _this$spreadsheet$sty=this.spreadsheet.styles.selectionFirstCell,strokeWidth=_this$spreadsheet$sty.strokeWidth,stroke=_this$spreadsheet$sty.stroke,rect=this.getClientRectWithoutStroke(),rectConfig=Object.assign({},this.spreadsheet.styles.selectionFirstCell,{stroke:void 0}),innerRectConfig={x:strokeWidth/2,y:strokeWidth/2,width:rect.width-strokeWidth,height:rect.height-strokeWidth,stroke:stroke,strokeWidth:strokeWidth};this.rect.setAttrs(rectConfig),this.innerRect.setAttrs(innerRectConfig),this.group.add(this.innerRect)}}]),SelectedCell}(cell_Cell),cell_SelectedCell=SelectedCell_SelectedCell;function Selector_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Selector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Selector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Selector_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Selector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Selector_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var sheet_Selector=function(){function Selector(sheet){!function Selector_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Selector),this.isInSelectionMode=!1,this.selectedCell=void 0,this.selectedCells=[],this.selectedSimpleCellAddress=void 0,this.previousSelectedSimpleCellAddress=void 0,this.groupedCells=void 0,this.selectionArea=void 0,this.spreadsheet=void 0,this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.selectedSimpleCellAddress=new cell_SimpleCellAddress(sheet.sheetId,0,0)}return function Selector_createClass(Constructor,protoProps,staticProps){return protoProps&&Selector_defineProperties(Constructor.prototype,protoProps),staticProps&&Selector_defineProperties(Constructor,staticProps),Constructor}(Selector,[{key:"renderSelectedCell",value:function renderSelectedCell(){if(this.selectedSimpleCellAddress){var _this$selectedCell;null===(_this$selectedCell=this.selectedCell)||void 0===_this$selectedCell||_this$selectedCell.destroy(),this.selectedCell=new cell_SelectedCell(this.sheet,this.selectedSimpleCellAddress);var stickyGroup=this.selectedCell.getStickyGroupCellBelongsTo();this.sheet.scrollGroups[stickyGroup].sheetGroup.add(this.selectedCell.group)}}},{key:"renderSelectionArea",value:function renderSelectionArea(){var _this=this;if(this.selectionArea){var _this$groupedCells;Object.keys(null!==(_this$groupedCells=this.groupedCells)&&void 0!==_this$groupedCells?_this$groupedCells:{}).forEach((function(key){var _this$groupedCells2,_this$groupedCells2$t,type=key;null===(_this$groupedCells2=_this.groupedCells)||void 0===_this$groupedCells2||null===(_this$groupedCells2$t=_this$groupedCells2[type].rect)||void 0===_this$groupedCells2$t||_this$groupedCells2$t.destroy()}));var rangeSimpleCellAddress=this.sheet.convertVectorsToRangeSimpleCellAddress(this.selectionArea.start,this.selectionArea.end);this.selectedCells=rangeSimpleCellAddress.getCellsBetweenRange(this.sheet,(function(simpleCellAddress){return new cell_SelectedCell(_this.sheet,simpleCellAddress)})),this.groupedCells={main:{cells:[]},xSticky:{cells:[]},ySticky:{cells:[]},xySticky:{cells:[]}},this.selectedCells.forEach((function(cell){var stickyGroup=cell.getStickyGroupCellBelongsTo();_this.groupedCells[stickyGroup].cells.push(cell)})),Object.keys(this.groupedCells).forEach((function(key){var _this$groupedCells3,_this$groupedCells3$t,type=key,cells=_this.groupedCells[type].cells;if(null===(_this$groupedCells3=_this.groupedCells)||void 0===_this$groupedCells3||null===(_this$groupedCells3$t=_this$groupedCells3[type].rect)||void 0===_this$groupedCells3$t||_this$groupedCells3$t.destroy(),cells.length){var _step,topLeftCellClientRect=cells[0].getClientRectWithoutStroke(),width=0,height=0,minMaxRangeSimpleCellAddress=_this.sheet.getMinMaxRangeSimpleCellAddress(cells),_iterator=Selector_createForOfIteratorHelper(minMaxRangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var index=_step.value;height+=_this.sheet.rows.getSize(index)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=Selector_createForOfIteratorHelper(minMaxRangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _index=_step2.value;width+=_this.sheet.cols.getSize(_index)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var sheetGroup=_this.sheet.scrollGroups[type].sheetGroup;_this.groupedCells[type].rect=new Rect.a(Object.assign({},_this.spreadsheet.styles.selection,topLeftCellClientRect,{stroke:void 0,width:width,height:height})),sheetGroup.add(_this.groupedCells[type].rect)}}))}}},{key:"updateSelectedCells",value:function updateSelectedCells(){this.renderSelectionArea(),this.renderSelectedCell()}},{key:"startSelection",value:function startSelection(vector){var _this$selectedCell2,_this2=this;this.previousSelectedSimpleCellAddress=null===(_this$selectedCell2=this.selectedCell)||void 0===_this$selectedCell2?void 0:_this$selectedCell2.simpleCellAddress,this.selectionArea=null;var cell=this.sheet.convertVectorsToRangeSimpleCellAddress(vector,vector).getCellsBetweenRange(this.sheet,(function(simpleCellAddress){return new cell_SelectedCell(_this2.sheet,simpleCellAddress)}))[0],rect=cell.getClientRectWithoutStroke();cell.isOnFrozenCol()||(rect.x-=Math.abs(this.sheet.cols.scrollBar.scroll)),cell.isOnFrozenRow()||(rect.y-=Math.abs(this.sheet.rows.scrollBar.scroll)),this.selectionArea={start:{x:rect.x+.1,y:rect.y+.1},end:{x:rect.x+rect.width,y:rect.y+rect.height}},this.isInSelectionMode=!0,this.selectedSimpleCellAddress=cell.simpleCellAddress,this.spreadsheet.updateViewport(),this.spreadsheet.eventEmitter.emit(spreadsheet_events.selector.startSelection,this.sheet,this.selectionArea)}},{key:"moveSelection",value:function moveSelection(){if(this.isInSelectionMode){var _this$spreadsheet$too,_this$sheet$sheet$get=this.sheet.sheet.getRelativePointerPosition(),x=_this$sheet$sheet$get.x,y=_this$sheet$sheet$get.y,selectedCellRect=this.selectedCell.getClientRectWithoutStroke();this.selectionArea={start:{x:selectedCellRect.x,y:selectedCellRect.y},end:{x:x,y:y}},this.updateSelectedCells(),null===(_this$spreadsheet$too=this.spreadsheet.toolbar)||void 0===_this$spreadsheet$too||_this$spreadsheet$too.updateActiveStates(),this.spreadsheet.eventEmitter.emit(spreadsheet_events.selector.moveSelection,this.selectionArea)}}},{key:"endSelection",value:function endSelection(){var _this$groupedCells4,_this3=this;this.isInSelectionMode=!1,Object.keys(null!==(_this$groupedCells4=this.groupedCells)&&void 0!==_this$groupedCells4?_this$groupedCells4:{}).forEach((function(key){var _value$rect,type=key,value=_this3.groupedCells[type];value.cells.length>1&&(null===(_value$rect=value.rect)||void 0===_value$rect||_value$rect.stroke(_this3.spreadsheet.styles.selection.stroke))})),this.spreadsheet.eventEmitter.emit(spreadsheet_events.selector.endSelection)}},{key:"hasChangedCellSelection",value:function hasChangedCellSelection(){var _this$selectedCell3,_this$previousSelecte;return(null===(_this$selectedCell3=this.selectedCell)||void 0===_this$selectedCell3?void 0:_this$selectedCell3.simpleCellAddress.toCellId())!==(null===(_this$previousSelecte=this.previousSelectedSimpleCellAddress)||void 0===_this$previousSelecte?void 0:_this$previousSelecte.toCellId())}}]),Selector}();function Merger_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Merger_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Merger_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Merger_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Merger_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Merger_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var sheet_Merger=function(){function Merger(sheet){!function Merger_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Merger),this.associatedMergedCellAddressMap=void 0,this.spreadsheet=void 0,this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.associatedMergedCellAddressMap=new Map}return function Merger_createClass(Constructor,protoProps,staticProps){return protoProps&&Merger_defineProperties(Constructor.prototype,protoProps),staticProps&&Merger_defineProperties(Constructor,staticProps),Constructor}(Merger,[{key:"setAssociatedMergedCellIds",value:function setAssociatedMergedCellIds(simpleCellAddress){var _this$spreadsheet$dat,cellId=simpleCellAddress.toCellId(),mergedCell=null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.mergedCells)||void 0===_this$spreadsheet$dat?void 0:_this$spreadsheet$dat[cellId];if(mergedCell){var _step,sheetId=this.sheet.sheetId,row=mergedCell.row,col=mergedCell.col,rangeSimpleCellAddress=new cell_RangeSimpleCellAddress(new cell_SimpleCellAddress(sheetId,row.x,col.x),new cell_SimpleCellAddress(sheetId,row.y,col.y)),_iterator=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,ri=_step.value,_iterator2=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var ci=_step2.value,associatedSimpleCellAddress=new cell_SimpleCellAddress(sheetId,ri,ci);this.associatedMergedCellAddressMap.set(associatedSimpleCellAddress.toCellId(),rangeSimpleCellAddress)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}},{key:"addMergedCells",value:function addMergedCells(rangeSimpleCellAddress){var _this$spreadsheet$dat2,_this$spreadsheet$hyp,_this=this,mergedCellId=rangeSimpleCellAddress.topLeftSimpleCellAddress.toCellId(),existingTopLeftCell=null===(_this$spreadsheet$dat2=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat2?void 0:_this$spreadsheet$dat2[mergedCellId];this.spreadsheet.data.setMergedCell(rangeSimpleCellAddress.topLeftSimpleCellAddress,{row:{x:rangeSimpleCellAddress.topLeftSimpleCellAddress.row,y:rangeSimpleCellAddress.bottomRightSimpleCellAddress.row},col:{x:rangeSimpleCellAddress.topLeftSimpleCellAddress.col,y:rangeSimpleCellAddress.bottomRightSimpleCellAddress.col}}),null===(_this$spreadsheet$hyp=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp||_this$spreadsheet$hyp.batch((function(){var _step3,_iterator3=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step4,ri=_step3.value,_iterator4=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var ci=_step4.value,simpleCellAddress=new cell_SimpleCellAddress(_this.sheet.sheetId,ri,ci);simpleCellAddress.toCellId()!==mergedCellId&&_this.spreadsheet.data.deleteCell(simpleCellAddress)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}existingTopLeftCell&&_this.spreadsheet.data.setCell(rangeSimpleCellAddress.topLeftSimpleCellAddress,existingTopLeftCell)})),this.sheet.selector.selectedSimpleCellAddress=rangeSimpleCellAddress.topLeftSimpleCellAddress,this.spreadsheet.updateViewport()}},{key:"removeMergedCells",value:function removeMergedCells(rangeSimpleCellAddress){var _this2=this,mergedCells=this.spreadsheet.data.spreadsheetData.mergedCells;if(this.spreadsheet.data.getIsCellAMergedCell(rangeSimpleCellAddress.topLeftSimpleCellAddress)){var _this$spreadsheet$dat3,_this$spreadsheet$hyp2,cell=null===(_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat3?void 0:_this$spreadsheet$dat3[rangeSimpleCellAddress.topLeftSimpleCellAddress.toCellId()];if(cell)null===(_this$spreadsheet$hyp2=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp2||_this$spreadsheet$hyp2.batch((function(){var _step5,_iterator5=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step6,ri=_step5.value,_iterator6=Merger_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var ci=_step6.value,associatedSimpleCellAddress=new cell_SimpleCellAddress(rangeSimpleCellAddress.topLeftSimpleCellAddress.sheet,ri,ci);_this2.spreadsheet.data.setCell(associatedSimpleCellAddress,cell)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}))}this.sheet.cells.cellsMap.forEach((function(cell,simpleCellAddress){_this2.spreadsheet.data.getIsCellAMergedCell(simpleCellAddress)&&mergedCells&&(_this2.getAreMergedCellsOverlapping(rangeSimpleCellAddress,cell.rangeSimpleCellAddress)&&_this2.spreadsheet.data.deleteMergedCell(simpleCellAddress))})),this.spreadsheet.updateViewport()}},{key:"getAreMergedCellsOverlapping",value:function getAreMergedCellsOverlapping(firstRangeSimpleCellAddress,secondRangeSimpleCellAddress){var isFirstOverlappingSecond=secondRangeSimpleCellAddress.topLeftSimpleCellAddress.row>=firstRangeSimpleCellAddress.topLeftSimpleCellAddress.row&&secondRangeSimpleCellAddress.topLeftSimpleCellAddress.col>=firstRangeSimpleCellAddress.topLeftSimpleCellAddress.col&&secondRangeSimpleCellAddress.bottomRightSimpleCellAddress.row<=firstRangeSimpleCellAddress.bottomRightSimpleCellAddress.row&&secondRangeSimpleCellAddress.bottomRightSimpleCellAddress.col<=firstRangeSimpleCellAddress.bottomRightSimpleCellAddress.col,isSecondOverlappingFirst=firstRangeSimpleCellAddress.topLeftSimpleCellAddress.row>=secondRangeSimpleCellAddress.topLeftSimpleCellAddress.row&&firstRangeSimpleCellAddress.topLeftSimpleCellAddress.col>=secondRangeSimpleCellAddress.topLeftSimpleCellAddress.col&&firstRangeSimpleCellAddress.bottomRightSimpleCellAddress.row<=secondRangeSimpleCellAddress.bottomRightSimpleCellAddress.row&&firstRangeSimpleCellAddress.bottomRightSimpleCellAddress.col<=secondRangeSimpleCellAddress.bottomRightSimpleCellAddress.col;return isFirstOverlappingSecond||isSecondOverlappingFirst}},{key:"mergeSelectedCells",value:function mergeSelectedCells(){var selectedCells=this.sheet.selector.selectedCells;if(selectedCells.length){var rangeSimpleCellAddress=this.sheet.getMinMaxRangeSimpleCellAddress(selectedCells);this.spreadsheet.pushToHistory(),this.removeMergedCells(rangeSimpleCellAddress),this.addMergedCells(rangeSimpleCellAddress)}}},{key:"unMergeSelectedCells",value:function unMergeSelectedCells(){var selectedCells=this.sheet.selector.selectedCells;if(selectedCells.length){var rangeSimpleCellAddress=this.sheet.getMinMaxRangeSimpleCellAddress(selectedCells);this.spreadsheet.pushToHistory(),this.removeMergedCells(rangeSimpleCellAddress)}}}]),Merger}(),prefix=(__webpack_require__(64),__webpack_require__(137),"powersheet"),rotatePoint=function rotatePoint(_ref,rad){var x=_ref.x,y=_ref.y,rcos=Math.cos(rad),rsin=Math.sin(rad);return{x:x*rcos-y*rsin,y:y*rcos+x*rsin}},setCaretToEndOfElement=function setCaretToEndOfElement(element){var range=document.createRange(),sel=window.getSelection();range.selectNodeContents(element),range.collapse(!1),null==sel||sel.removeAllRanges(),null==sel||sel.addRange(range),range.detach()},ScrollBar_module=__webpack_require__(343),ScrollBar_module_options={insert:"head",singleton:!1},scrollBars_ScrollBar_module=(injectStylesIntoStyleTag_default()(ScrollBar_module.a,ScrollBar_module_options),ScrollBar_module.a.locals||{});function ViewportPosition_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var scrollBars_ViewportPosition=function(){function ViewportPosition(x,y){void 0===x&&(x=0),void 0===y&&(y=0),function ViewportPosition_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ViewportPosition),this.x=x,this.y=y}return function ViewportPosition_createClass(Constructor,protoProps,staticProps){return protoProps&&ViewportPosition_defineProperties(Constructor.prototype,protoProps),staticProps&&ViewportPosition_defineProperties(Constructor,staticProps),Constructor}(ViewportPosition,[{key:"iterateFromXToY",value:regeneratorRuntime.mark((function iterateFromXToY(){var index;return regeneratorRuntime.wrap((function iterateFromXToY$(_context){for(;;)switch(_context.prev=_context.next){case 0:index=this.x;case 1:if(!(index<=this.y)){_context.next=7;break}return _context.next=4,index;case 4:index++,_context.next=1;break;case 7:case"end":return _context.stop()}}),iterateFromXToY,this)}))}]),ViewportPosition}();function RowColAddress_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_RowColAddress=function(){function RowColAddress(sheet,rowCol){!function RowColAddress_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RowColAddress),this.sheet=sheet,this.rowCol=rowCol}return function RowColAddress_createClass(Constructor,protoProps,staticProps){return protoProps&&RowColAddress_defineProperties(Constructor.prototype,protoProps),staticProps&&RowColAddress_defineProperties(Constructor,staticProps),Constructor}(RowColAddress,[{key:"toSheetRowColId",value:function toSheetRowColId(){return this.sheet+"_"+this.rowCol}}],[{key:"sheetRowColIdToAddress",value:function sheetRowColIdToAddress(sheetRowColId){var sections=sheetRowColId.split("_");return new RowColAddress(parseInt(sections[0],10),parseInt(sections[1],10))}}]),RowColAddress}();function ScrollBar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var scrollBars_ScrollBar=function(){function ScrollBar(rowCols){var _this=this;!function ScrollBar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ScrollBar),this.scrollBarEl=void 0,this.scrollEl=void 0,this.scroll=0,this.totalPreviousCustomSizeDifferences=0,this.sheetViewportPosition=new scrollBars_ViewportPosition,this.previousSheetViewportPosition=new scrollBars_ViewportPosition,this.previousTouchMovePosition=0,this.scrollType=void 0,this.throttledScroll=void 0,this.spreadsheet=void 0,this.sheet=void 0,this.type=void 0,this.isCol=void 0,this.functions=void 0,this.layerListeningTimeout=void 0,this.pluralType=void 0,this.onScroll=function(e){var _this$sheet$cellEdito;e.preventDefault();var event=e.target,scrollPercent=(_this.isCol?event.scrollLeft:event.scrollTop)/(_this.isCol?event.scrollWidth:event.scrollHeight);_this.sheetViewportPosition.x=Math.trunc(_this.spreadsheet.options[_this.type].amount*scrollPercent);var newScroll=Math.abs(_this.scroll),scrollAmount=_this.getNewScrollAmount(_this.previousSheetViewportPosition.x,_this.sheetViewportPosition.x),scrollReverseAmount=_this.getNewScrollAmount(_this.sheetViewportPosition.x,_this.previousSheetViewportPosition.x);scrollReverseAmount.newScrollAmount*=-1,scrollReverseAmount.totalCustomSizeDifferencs*=-1;var totalPreviousCustomSizeDifferences=_this.totalPreviousCustomSizeDifferences+scrollAmount.totalCustomSizeDifferencs+scrollReverseAmount.totalCustomSizeDifferencs;newScroll+=scrollAmount.newScrollAmount+scrollReverseAmount.newScrollAmount,newScroll*=-1,_this.isCol?_this.sheet.scrollGroups.ySticky.group.x(newScroll):_this.sheet.scrollGroups.xSticky.group.y(newScroll),_this.sheet.scrollGroups.main.group[_this.functions.axis](newScroll),_this.previousSheetViewportPosition.x=_this.sheetViewportPosition.x,_this.previousSheetViewportPosition.y=_this.sheetViewportPosition.y,_this.scroll=newScroll,_this.totalPreviousCustomSizeDifferences=totalPreviousCustomSizeDifferences,_this.setYIndex(),_this.rowCols.destroyOutOfViewportItems(),_this.sheet.cells.destroyOutOfViewportItems(),_this.rowCols.drawViewport(),_this.sheet.cells.drawViewport(),(null===(_this$sheet$cellEdito=_this.sheet.cellEditor.currentScroll)||void 0===_this$sheet$cellEdito?void 0:_this$sheet$cellEdito[_this.type])!==_this.scroll?_this.sheet.cellEditor.showCellTooltip():_this.sheet.cellEditor.hideCellTooltip(),_this.layerListeningTimeout&&clearTimeout(_this.layerListeningTimeout),_this.layerListeningTimeout=setTimeout((function(){_this.sheet.layer.listening(!0)}),40),_this.sheet.layer.listening(!1),_this.spreadsheet.eventEmitter.emit(spreadsheet_events.scroll[_this.scrollType],e,newScroll)},this.rowCols=rowCols,this.sheet=this.rowCols.sheet,this.type=this.rowCols.type,this.pluralType=this.rowCols.pluralType,this.spreadsheet=this.sheet.spreadsheet,this.isCol=this.rowCols.isCol,this.scrollType=this.isCol?"horizontal":"vertical",this.functions=this.rowCols.functions,this.scrollBarEl=document.createElement("div"),this.scrollEl=document.createElement("div"),this.scrollBarEl.classList.add(prefix+"-scroll-bar",this.scrollType,scrollBars_ScrollBar_module[this.scrollType+"ScrollBar"]),this.scrollEl.classList.add(prefix+"-scroll",scrollBars_ScrollBar_module[this.scrollType+"Scroll"]),this.scrollBarEl.appendChild(this.scrollEl),this.throttledScroll=Object(lodash.throttle)(this.onScroll,16),this.scrollBarEl.addEventListener("scroll",this.throttledScroll),this.sheet.sheetEl.appendChild(this.scrollBarEl),this.setScrollSize()}return function ScrollBar_createClass(Constructor,protoProps,staticProps){return protoProps&&ScrollBar_defineProperties(Constructor.prototype,protoProps),staticProps&&ScrollBar_defineProperties(Constructor,staticProps),Constructor}(ScrollBar,[{key:"setScrollSize",value:function setScrollSize(){var scrollSize=this.sheet.sheetDimensions[this.functions.size];this.scrollEl.style[this.functions.size]=scrollSize+"px"}},{key:"getNewScrollAmount",value:function getNewScrollAmount(start,end){for(var data=this.spreadsheet.data.spreadsheetData,defaultSize=this.spreadsheet.options[this.type].defaultSize,newScrollAmount=0,totalCustomSizeDifferencs=0,i=start;i<end;i++){var _data$this$pluralType,_data$this$pluralType2,rowCollAddress=new cell_RowColAddress(this.sheet.sheetId,i),size=null===(_data$this$pluralType=data[this.pluralType])||void 0===_data$this$pluralType||null===(_data$this$pluralType2=_data$this$pluralType[rowCollAddress.toSheetRowColId()])||void 0===_data$this$pluralType2?void 0:_data$this$pluralType2.size;size?(totalCustomSizeDifferencs+=size-defaultSize,newScrollAmount+=size):newScrollAmount+=defaultSize}return{newScrollAmount:newScrollAmount,totalCustomSizeDifferencs:totalCustomSizeDifferencs}}},{key:"getYIndex",value:function getYIndex(){var xIndex=this.sheetViewportPosition.x,stageSize=this.sheet.stage[this.functions.size]();return this.rowCols.calculateSheetViewportEndPosition(stageSize,xIndex)}},{key:"setYIndex",value:function setYIndex(){this.sheetViewportPosition.y=this.getYIndex()}},{key:"destroy",value:function destroy(){this.scrollBarEl.removeEventListener("scroll",this.throttledScroll)}}]),ScrollBar}(),Line=(__webpack_require__(138),__webpack_require__(124)),Text=__webpack_require__(253),_excluded=["cells"],_excluded2=["cells"],_excluded3=["mergedCells","cells"];function RowCol_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function RowCol_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return RowCol_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RowCol_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function RowCol_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function RowCol_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var rowCol_RowCol=function(){function RowCol(rowCols,index){var _Group,_Object$assign,_Object$assign2,_Object$assign3,_this=this;!function RowCol_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RowCol),this.spreadsheet=void 0,this.headerGroup=void 0,this.headerRect=void 0,this.headerText=void 0,this.gridLine=void 0,this.resizeLine=void 0,this.xFrozenLine=void 0,this.yFrozenLine=void 0,this.xyFrozenLine=void 0,this.sheet=void 0,this.type=void 0,this.pluralType=void 0,this.isCol=void 0,this.oppositeType=void 0,this.functions=void 0,this.oppositeFunctions=void 0,this.rowColAddress=void 0,this.getLinePoints=function(size){return _this.isCol?[0,0,0,size]:[0,0,size,0]},this.resizeLineOnMouseOver=function(){_this.rowCols.resizer.setCursor(),_this.rowCols.resizer.showResizeMarker(_this.index)},this.resizeLineOnMouseOut=function(){_this.rowCols.resizer.resetCursor(),_this.rowCols.resizer.hideResizeMarker()},this.rowCols=rowCols,this.index=index,this.sheet=rowCols.sheet,this.spreadsheet=this.sheet.spreadsheet,this.type=rowCols.type,this.pluralType=rowCols.pluralType,this.isCol=rowCols.isCol,this.oppositeType=rowCols.oppositeType,this.functions=rowCols.functions,this.oppositeFunctions=rowCols.oppositeFunctions,this.rowColAddress=new cell_RowColAddress(this.sheet.sheetId,this.index),this.headerGroup=new Group.a(((_Group={})[this.functions.axis]=this.rowCols.getAxis(this.index),_Group)),this.headerRect=new Rect.a(Object.assign({},this.spreadsheet.styles[this.type].headerRect,((_Object$assign={})[this.functions.size]=this.rowCols.getSize(this.index),_Object$assign))),this.headerText=new Text.a(Object.assign({},this.spreadsheet.styles[this.type].headerText,{text:this.getHeaderTextContent()}));var headerTextMidPoints=function centerRectTwoInRectOne(rectOne,rectTwo){var rectOneMidPoint_x=rectOne.x+rectOne.width/2,rectOneMidPoint_y=rectOne.y+rectOne.height/2;return{x:rectOneMidPoint_x-rectTwo.width/2,y:rectOneMidPoint_y-rectTwo.height/2}}(this.headerRect.getClientRect(),this.headerText.getClientRect());this.headerText.x(headerTextMidPoints.x),this.headerText.y(headerTextMidPoints.y),this.gridLine=new Line.a(Object.assign({},this.spreadsheet.styles[this.type].gridLine,((_Object$assign2={})[this.functions.axis]=this.rowCols.getAxis(this.index)+this.rowCols.getSize(this.index)-this.sheet.getViewportVector()[this.functions.axis],_Object$assign2.points=this.getLinePoints(this.getSheetSize()),_Object$assign2))),this.resizeLine=new Line.a(Object.assign({},this.spreadsheet.styles[this.type].resizeLine,((_Object$assign3={})[this.functions.axis]=this.rowCols.getSize(this.index),_Object$assign3.points=this.isCol?[0,0,0,this.sheet.getViewportVector().y]:[0,0,this.sheet.getViewportVector().x,0],_Object$assign3))),this.headerGroup.add(this.headerRect,this.headerText,this.resizeLine),this.draw(),this.resizeLine.on("mouseover",this.resizeLineOnMouseOver),this.resizeLine.on("mouseout",this.resizeLineOnMouseOut)}return function RowCol_createClass(Constructor,protoProps,staticProps){return protoProps&&RowCol_defineProperties(Constructor.prototype,protoProps),staticProps&&RowCol_defineProperties(Constructor,staticProps),Constructor}(RowCol,[{key:"destroy",value:function destroy(){var _this$xFrozenLine,_this$yFrozenLine,_this$xyFrozenLine;this.resizeLine.off("mouseover",this.resizeLineOnMouseOver),this.resizeLine.off("mouseup",this.resizeLineOnMouseOut),this.headerGroup.destroy(),this.gridLine.destroy(),null===(_this$xFrozenLine=this.xFrozenLine)||void 0===_this$xFrozenLine||_this$xFrozenLine.destroy(),null===(_this$yFrozenLine=this.yFrozenLine)||void 0===_this$yFrozenLine||_this$yFrozenLine.destroy(),null===(_this$xyFrozenLine=this.xyFrozenLine)||void 0===_this$xyFrozenLine||_this$xyFrozenLine.destroy()}},{key:"draw",value:function draw(){this.drawHeader(),this.drawGridLine()}},{key:"insert",value:function insert(amount){var _this2=this,_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData,cells=_this$spreadsheet$dat.cells,data=_objectWithoutProperties(_this$spreadsheet$dat,_excluded),modifyCallback=function modifyCallback(value,amount){return value+amount};this.moveData(amount,"addColumns","addRows",modifyCallback,(function(rowColAddress){var _data$_this2$pluralTy,rowColIndex=rowColAddress.rowCol,rowColId=rowColAddress.toSheetRowColId(),rowCol=null===(_data$_this2$pluralTy=data[_this2.pluralType])||void 0===_data$_this2$pluralTy?void 0:_data$_this2$pluralTy[rowColId];if(rowColIndex>=_this2.index){var newRowColIndex=modifyCallback(rowColIndex,amount);rowCol&&_this2.spreadsheet.data.setRowCol(_this2.pluralType,new cell_RowColAddress(rowColAddress.sheet,newRowColIndex),rowCol),_this2.spreadsheet.data.deleteRowCol(_this2.pluralType,rowColAddress)}}),(function(simpleCellAddress,newSimpleCellAddress){if(simpleCellAddress[_this2.type]>=_this2.index){var cellId=simpleCellAddress.toCellId(),cell=null==cells?void 0:cells[cellId];cell&&_this2.spreadsheet.data.setCell(newSimpleCellAddress,cell),_this2.spreadsheet.data.deleteCell(simpleCellAddress)}}),(function(a,b){return b.localeCompare(a)}))}},{key:"delete",value:function _delete(amount){var _this3=this,_this$spreadsheet$dat2=this.spreadsheet.data.spreadsheetData,cells=_this$spreadsheet$dat2.cells,data=_objectWithoutProperties(_this$spreadsheet$dat2,_excluded2),modifyCallback=function modifyCallback(value,amount){return value-amount};this.moveData(amount,"removeColumns","removeRows",modifyCallback,(function(rowColAddress){var _data$_this3$pluralTy,rowColIndex=rowColAddress.rowCol,rowColId=rowColAddress.toSheetRowColId(),rowCol=null===(_data$_this3$pluralTy=data[_this3.pluralType])||void 0===_data$_this3$pluralTy?void 0:_data$_this3$pluralTy[rowColId];if(!(rowColIndex<_this3.index)){if(rowColIndex>_this3.index){var newRowColIndex=modifyCallback(rowColIndex,amount);rowCol&&_this3.spreadsheet.data.setRowCol(_this3.pluralType,new cell_RowColAddress(rowColAddress.sheet,newRowColIndex),rowCol)}_this3.spreadsheet.data.deleteRowCol(_this3.pluralType,rowColAddress)}}),(function(simpleCellAddress,newSimpleCellAddress){if(!(simpleCellAddress[_this3.type]<_this3.index)){if(simpleCellAddress[_this3.type]>_this3.index){var cellId=simpleCellAddress.toCellId(),cell=null==cells?void 0:cells[cellId];cell&&_this3.spreadsheet.data.setCell(newSimpleCellAddress,cell)}_this3.spreadsheet.data.deleteCell(simpleCellAddress)}}))}},{key:"moveData",value:function moveData(amount,hyperformulaColumnFunctionName,hyperformulaRowFunctionName,modifyCallback,rowColCallback,cellsDataCallback,comparer){var _data$this$pluralType,_this4=this;this.spreadsheet.pushToHistory();var _this$spreadsheet$hyp,_this$spreadsheet$hyp2,_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData,mergedCells=_this$spreadsheet$dat3.mergedCells,cells=_this$spreadsheet$dat3.cells,rowCol=null===(_data$this$pluralType=_objectWithoutProperties(_this$spreadsheet$dat3,_excluded3)[this.pluralType])||void 0===_data$this$pluralType?void 0:_data$this$pluralType[this.rowColAddress.toSheetRowColId()];if(this.rowCols.getIsFrozen(this.index)){var _this$spreadsheet$dat4,_this$spreadsheet$dat5,existingFrozenCells=null===(_this$spreadsheet$dat4=this.spreadsheet.data.spreadsheetData.frozenCells)||void 0===_this$spreadsheet$dat4?void 0:_this$spreadsheet$dat4[this.sheet.sheetId];this.spreadsheet.data.setFrozenCell(this.sheet.sheetId,((_this$spreadsheet$dat5={})[this.type]=modifyCallback(existingFrozenCells[this.type],amount),_this$spreadsheet$dat5))}(rowCol&&Object.keys(rowCol).sort(comparer).forEach((function(key){var sheetRowColId=key;rowColCallback(cell_RowColAddress.sheetRowColIdToAddress(sheetRowColId))})),mergedCells&&Object.keys(mergedCells).sort(comparer).forEach((function(topLeftCellId){var mergedCell=mergedCells[topLeftCellId];mergedCell[_this4.type].x>=_this4.index&&(mergedCell[_this4.type].x=modifyCallback(mergedCell[_this4.type].x,amount)),mergedCell[_this4.type].y>=_this4.index&&(mergedCell[_this4.type].y=modifyCallback(mergedCell[_this4.type].y,amount))})),cells&&Object.keys(cells).sort(comparer).forEach((function(key){var cellId=key,simpleCellAddress=cell_SimpleCellAddress.cellIdToAddress(cellId),newSimpleCellAddress=new cell_SimpleCellAddress(_this4.sheet.sheetId,_this4.isCol?simpleCellAddress.row:modifyCallback(simpleCellAddress.row,amount),_this4.isCol?modifyCallback(simpleCellAddress.col,amount):simpleCellAddress.col);cellsDataCallback(simpleCellAddress,newSimpleCellAddress)})),this.isCol)?null===(_this$spreadsheet$hyp=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp||_this$spreadsheet$hyp[hyperformulaColumnFunctionName](this.sheet.sheetId,[this.index,amount]):null===(_this$spreadsheet$hyp2=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp2||_this$spreadsheet$hyp2[hyperformulaRowFunctionName](this.sheet.sheetId,[this.index,amount]);this.spreadsheet.updateViewport()}},{key:"getHeaderTextContent",value:function getHeaderTextContent(){if(this.isCol){var startCharCode="A".charCodeAt(0);return String.fromCharCode(startCharCode+this.index)}return(this.index+1).toString()}},{key:"getSizeUpToFrozenRowCol",value:function getSizeUpToFrozenRowCol(){var _step,size=0,_iterator=RowCol_createForOfIteratorHelper(this.sheet[this.isCol?"rows":"cols"].getSizeForFrozenCell());try{for(_iterator.s();!(_step=_iterator.n()).done;){size=_step.value.size}}catch(err){_iterator.e(err)}finally{_iterator.f()}return size}},{key:"setXFrozenGridLine",value:function setXFrozenGridLine(frozenCell){var size=this.getSizeUpToFrozenRowCol();!this.isCol&&this.index>frozenCell&&(this.xFrozenLine=this.gridLine.clone({points:this.getLinePoints(size)})),this.isCol&&this.index<frozenCell&&(this.xFrozenLine=this.gridLine.clone({y:size,points:this.getLinePoints(this.sheet.sheetDimensions.height)}))}},{key:"setYFrozenGridLine",value:function setYFrozenGridLine(frozenCell){var size=this.getSizeUpToFrozenRowCol();!this.isCol&&this.index<frozenCell&&(this.yFrozenLine=this.gridLine.clone({x:size,points:this.getLinePoints(this.sheet.sheetDimensions.width)})),this.isCol&&this.index>frozenCell&&(this.yFrozenLine=this.gridLine.clone({points:this.getLinePoints(size)}))}},{key:"setXYFrozenGridLine",value:function setXYFrozenGridLine(frozenCell){var size=this.getSizeUpToFrozenRowCol();this.index<frozenCell&&(this.xyFrozenLine=this.gridLine.clone({points:this.getLinePoints(size)}))}},{key:"getSheetSize",value:function getSheetSize(){return this.sheet.sheetDimensions[this.oppositeFunctions.size]+this.sheet.getViewportVector()[this.oppositeFunctions.axis]}},{key:"drawGridLine",value:function drawGridLine(){var _this$spreadsheet$dat6,frozenCells=null===(_this$spreadsheet$dat6=this.spreadsheet.data.spreadsheetData.frozenCells)||void 0===_this$spreadsheet$dat6?void 0:_this$spreadsheet$dat6[this.sheet.sheetId],frozenRow=null==frozenCells?void 0:frozenCells.row,frozenCol=null==frozenCells?void 0:frozenCells.col,frozenCell=null==frozenCells?void 0:frozenCells[this.type];Object(lodash.isNil)(frozenCell)||(this.setXFrozenGridLine(frozenCell),this.setYFrozenGridLine(frozenCell)),Object(lodash.isNil)(frozenRow)||Object(lodash.isNil)(frozenCol)||this.setXYFrozenGridLine(frozenCell),this.xyFrozenLine&&this.sheet.scrollGroups.xySticky.rowColGroup.add(this.xyFrozenLine),this.yFrozenLine&&this.sheet.scrollGroups.ySticky.rowColGroup.add(this.yFrozenLine),this.xFrozenLine&&this.sheet.scrollGroups.xSticky.rowColGroup.add(this.xFrozenLine),this.sheet.scrollGroups.main.rowColGroup.add(this.gridLine)}},{key:"drawHeader",value:function drawHeader(){this.rowCols.getIsFrozen(this.index)?this.sheet.scrollGroups.xySticky.headerGroup.add(this.headerGroup):this.isCol?this.sheet.scrollGroups.ySticky.headerGroup.add(this.headerGroup):this.sheet.scrollGroups.xSticky.headerGroup.add(this.headerGroup)}}]),RowCol}();function Resizer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var rowCol_Resizer=function(){function Resizer(rowCols){var _Object$assign2,_Object$assign3,_this=this;!function Resizer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Resizer),this.resizeMarker=void 0,this.resizeGuideLine=void 0,this.spreadsheet=void 0,this.sheet=void 0,this.currentIndex=0,this.resizeMarkerOnMouseOver=function(){_this.setCursor(),_this.showResizeMarker(_this.currentIndex)},this.resizeMarkerOnMouseOut=function(){_this.resetCursor(),_this.hideResizeMarker()},this.resizeLineDragStart=function(){_this.spreadsheet.pushToHistory()},this.resizeLineDragMove=function(e){var target=e.target,position=target.getPosition(),minAxis=_this.getPosition()+_this.spreadsheet.options[_this.rowCols.type].minSize,newAxis=position[_this.rowCols.functions.axis];newAxis<=minAxis&&(newAxis=minAxis,target.setPosition(function getNewPosition(){var _Object$assign;return Object.assign({},position,((_Object$assign={})[_this.rowCols.functions.axis]=newAxis,_Object$assign))}())),_this.showGuideLine(),_this.spreadsheet.eventEmitter.emit(spreadsheet_events.resize[_this.rowCols.type].move,e,newAxis)},this.resizeLineDragEnd=function(e){var newSize=e.target.getPosition()[_this.rowCols.functions.axis]-_this.getPosition();_this.hideResizeMarker(),_this.hideGuideLine(),_this.spreadsheet.data.setRowCol(_this.rowCols.pluralType,new cell_RowColAddress(_this.sheet.sheetId,_this.currentIndex),{size:newSize}),_this.spreadsheet.updateViewport(),_this.spreadsheet.eventEmitter.emit(spreadsheet_events.resize[_this.rowCols.type].end,e,_this.currentIndex,newSize)},this.rowCols=rowCols,this.sheet=this.rowCols.sheet,this.spreadsheet=this.sheet.spreadsheet;var size=this.rowCols.sheet.getViewportVector()[this.rowCols.oppositeFunctions.axis];this.resizeMarker=new Rect.a(Object.assign({},this.spreadsheet.styles[this.rowCols.type].resizeMarker,((_Object$assign2={})[this.rowCols.oppositeFunctions.size]=size,_Object$assign2))),this.resizeGuideLine=new Line.a(Object.assign({},this.spreadsheet.styles[this.rowCols.type].resizeGuideLine,((_Object$assign3={})[this.rowCols.oppositeFunctions.size]=size,_Object$assign3))),this.resizeMarker.on("mouseover",this.resizeMarkerOnMouseOver),this.resizeMarker.on("mouseout",this.resizeMarkerOnMouseOut),this.resizeMarker.on("dragstart",this.resizeLineDragStart),this.resizeMarker.on("dragmove",this.resizeLineDragMove),this.resizeMarker.on("dragend",this.resizeLineDragEnd),this.sheet.layer.add(this.resizeMarker,this.resizeGuideLine)}return function Resizer_createClass(Constructor,protoProps,staticProps){return protoProps&&Resizer_defineProperties(Constructor.prototype,protoProps),staticProps&&Resizer_defineProperties(Constructor,staticProps),Constructor}(Resizer,[{key:"setCursor",value:function setCursor(){document.body.style.cursor=this.rowCols.isCol?"col-resize":"row-resize"}},{key:"resetCursor",value:function resetCursor(){document.body.style.cursor="default"}},{key:"destroy",value:function destroy(){this.resizeMarker.off("mouseover",this.resizeMarkerOnMouseOver),this.resizeMarker.off("mouseout",this.resizeMarkerOnMouseOut),this.resizeMarker.off("dragstart",this.resizeLineDragStart),this.resizeMarker.off("dragmove",this.resizeLineDragMove),this.resizeMarker.off("dragend",this.resizeLineDragEnd)}},{key:"getPosition",value:function getPosition(){return this.rowCols.getAxis(this.currentIndex)+this.rowCols.scrollBar.scroll}},{key:"showResizeMarker",value:function showResizeMarker(index){this.currentIndex=index,this.resizeMarker[this.rowCols.functions.axis](this.getPosition()+this.rowCols.getSize(this.currentIndex)),this.resizeMarker.show(),this.resizeMarker.moveToTop()}},{key:"hideResizeMarker",value:function hideResizeMarker(){this.resizeMarker.hide()}},{key:"showGuideLine",value:function showGuideLine(){this.resizeGuideLine[this.rowCols.functions.axis](this.resizeMarker[this.rowCols.functions.axis]()),this.resizeGuideLine.points(this.rowCols.isCol?[0,this.sheet.getViewportVector().y,0,this.sheet.stage.height()]:[this.sheet.getViewportVector().x,0,this.sheet.stage.width(),0]),this.resizeGuideLine.show(),this.resizeGuideLine.moveToTop()}},{key:"hideGuideLine",value:function hideGuideLine(){this.resizeGuideLine.hide()}}]),Resizer}();function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||RowCols_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function RowCols_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=RowCols_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function RowCols_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return RowCols_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?RowCols_arrayLikeToArray(o,minLen):void 0}}function RowCols_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function RowCols_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var RowCols_RowCols=function(){function RowCols(type,sheet){var _this=this;!function RowCols_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RowCols),this.scrollBar=void 0,this.rowColMap=void 0,this.totalSize=void 0,this.frozenLine=void 0,this.functions=void 0,this.oppositeType=void 0,this.oppositeFunctions=void 0,this.isCol=void 0,this.spreadsheet=void 0,this.resizer=void 0,this.pluralType=void 0,this.calculateSheetViewportEndPosition=function(sheetViewportDimensionSize,sheetViewportStartYIndex){for(var sumOfSizes=0,i=sheetViewportStartYIndex,getSize=function getSize(){return _this.getSize(i)};sumOfSizes+getSize()<sheetViewportDimensionSize;)sumOfSizes+=getSize(),i+=1;return i},this.getShouldDraw=function(index,forceDraw){var rowColAlreadyExists=!!_this.rowColMap.get(index);return forceDraw||!rowColAlreadyExists},this.type=type,this.pluralType=this.type+"s",this.isCol="col"===this.type,this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.rowColMap=new Map,this.totalSize=0,this.isCol?(this.oppositeType="row",this.functions={axis:"x",size:"width"},this.oppositeFunctions={axis:"y",size:"height"}):(this.oppositeType="col",this.functions={axis:"y",size:"height"},this.oppositeFunctions={axis:"x",size:"width"}),this.resizer=new rowCol_Resizer(this),this.scrollBar=new scrollBars_ScrollBar(this)}return function RowCols_createClass(Constructor,protoProps,staticProps){return protoProps&&RowCols_defineProperties(Constructor.prototype,protoProps),staticProps&&RowCols_defineProperties(Constructor,staticProps),Constructor}(RowCols,[{key:"destroy",value:function destroy(){this.scrollBar.destroy()}},{key:"getAxis",value:function getAxis(index){for(var data=this.spreadsheet.data.spreadsheetData,defaultSize=this.spreadsheet.options[this.type].defaultSize,totalPreviousCustomSizeDifferences=this.scrollBar.totalPreviousCustomSizeDifferences,i=this.scrollBar.sheetViewportPosition.x;i<index;i++){var _data$this$pluralType,_data$this$pluralType2,sheetRowColId=new cell_RowColAddress(this.sheet.sheetId,i).toSheetRowColId(),size=null===(_data$this$pluralType=data[this.pluralType])||void 0===_data$this$pluralType||null===(_data$this$pluralType2=_data$this$pluralType[sheetRowColId])||void 0===_data$this$pluralType2?void 0:_data$this$pluralType2.size;size&&(totalPreviousCustomSizeDifferences+=size-defaultSize)}return this.spreadsheet.options[this.type].defaultSize*index+totalPreviousCustomSizeDifferences+this.sheet.getViewportVector()[this.functions.axis]}},{key:"getSize",value:function getSize(index){var _this$spreadsheet$dat,_this$spreadsheet$dat2,sheetRowColId=new cell_RowColAddress(this.sheet.sheetId,index).toSheetRowColId(),size=null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData[this.pluralType])||void 0===_this$spreadsheet$dat||null===(_this$spreadsheet$dat2=_this$spreadsheet$dat[sheetRowColId])||void 0===_this$spreadsheet$dat2?void 0:_this$spreadsheet$dat2.size;return null!=size?size:this.spreadsheet.options[this.type].defaultSize}},{key:"getIsLastFrozen",value:function getIsLastFrozen(index){var _this$spreadsheet$dat3,_this$spreadsheet$dat4;return index===(null===(_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData.frozenCells)||void 0===_this$spreadsheet$dat3||null===(_this$spreadsheet$dat4=_this$spreadsheet$dat3[this.sheet.sheetId])||void 0===_this$spreadsheet$dat4?void 0:_this$spreadsheet$dat4[this.type])}},{key:"getIsFrozen",value:function getIsFrozen(index){var _data$frozenCells,_data$frozenCells$thi,frozenCell=null===(_data$frozenCells=this.spreadsheet.data.spreadsheetData.frozenCells)||void 0===_data$frozenCells||null===(_data$frozenCells$thi=_data$frozenCells[this.sheet.sheetId])||void 0===_data$frozenCells$thi?void 0:_data$frozenCells$thi[this.type];return!Object(lodash.isNil)(frozenCell)&&index<=frozenCell}},{key:"updateViewportSize",value:function updateViewportSize(){this.scrollBar.setYIndex();var _step,sumOfSizes=0,_iterator=RowCols_createForOfIteratorHelper(this.scrollBar.sheetViewportPosition.iterateFromXToY());try{for(_iterator.s();!(_step=_iterator.n()).done;){var index=_step.value;sumOfSizes+=this.getSize(index)}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.totalSize=sumOfSizes}},{key:"getTotalSize",value:function getTotalSize(){var _this$spreadsheet$dat5,_this2=this,totalSizeDifference=Object.keys(null!==(_this$spreadsheet$dat5=this.spreadsheet.data.spreadsheetData[this.pluralType])&&void 0!==_this$spreadsheet$dat5?_this$spreadsheet$dat5:{}).reduce((function(currentSize,key){var sheetRowColId=key,rowColAddress=cell_RowColAddress.sheetRowColIdToAddress(sheetRowColId);return _this2.getSize(rowColAddress.rowCol)-_this2.spreadsheet.options[_this2.type].defaultSize+currentSize}),0);return this.spreadsheet.options[this.type].amount*this.spreadsheet.options[this.type].defaultSize+totalSizeDifference}},{key:"destroyOutOfViewportItems",value:function destroyOutOfViewportItems(){var _step2,_iterator2=RowCols_createForOfIteratorHelper(this.rowColMap);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref2=_slicedToArray(_step2.value,2),key=_ref2[0],rowCol=_ref2[1];this.sheet.isShapeOutsideOfViewport(rowCol.headerGroup)&&(rowCol.destroy(),this.rowColMap.delete(key))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},{key:"drawViewport",value:function drawViewport(){var _data$frozenCells2,_data$frozenCells2$th,forceDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0],data=this.spreadsheet.data.spreadsheetData,frozenCell=null===(_data$frozenCells2=data.frozenCells)||void 0===_data$frozenCells2||null===(_data$frozenCells2$th=_data$frozenCells2[this.sheet.sheetId])||void 0===_data$frozenCells2$th?void 0:_data$frozenCells2$th[this.type];if(!Object(lodash.isNil)(frozenCell))for(var index=0;index<=frozenCell;index++)this.draw(index,forceDraw);var _step3,_iterator3=RowCols_createForOfIteratorHelper(this.scrollBar.sheetViewportPosition.iterateFromXToY());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _index=_step3.value;this.draw(_index,forceDraw)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},{key:"updateViewport",value:function updateViewport(){this.rowColMap.clear(),this.drawViewport(!0),this.scrollBar.setScrollSize()}},{key:"getSizeForFrozenCell",value:regeneratorRuntime.mark((function getSizeForFrozenCell(){var _frozenCells$this$she,frozenCells,frozenCell,size,index;return regeneratorRuntime.wrap((function getSizeForFrozenCell$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(frozenCells=this.spreadsheet.data.spreadsheetData.frozenCells,frozenCell=null==frozenCells||null===(_frozenCells$this$she=frozenCells[this.sheet.sheetId])||void 0===_frozenCells$this$she?void 0:_frozenCells$this$she[this.type],!Object(lodash.isNil)(frozenCell)){_context.next=4;break}return _context.abrupt("return",null);case 4:size=0,index=0;case 6:if(!(index<=frozenCell)){_context.next=13;break}return size+=this.getSize(index),_context.next=10,{size:size,index:index};case 10:index++,_context.next=6;break;case 13:return _context.abrupt("return",size);case 14:case"end":return _context.stop()}}),getSizeForFrozenCell,this)}))},{key:"getTopBottomIndexFromPosition",value:function getTopBottomIndexFromPosition(position){var _step4,sheetViewportStartYIndex=this.scrollBar.sheetViewportPosition.x,topIndex=null,bottomIndex=null,_iterator4=RowCols_createForOfIteratorHelper(this.getSizeForFrozenCell());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _ref3=_step4.value,size=_ref3.size,index=_ref3.index;null===topIndex&&position.x<=size&&(topIndex=index),null===bottomIndex&&position.y<=size&&(bottomIndex=index)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}return null===topIndex&&(topIndex=this.calculateSheetViewportEndPosition(position.x,sheetViewportStartYIndex)),null===bottomIndex&&(bottomIndex=this.calculateSheetViewportEndPosition(position.y,sheetViewportStartYIndex)),{topIndex:topIndex,bottomIndex:bottomIndex}}},{key:"draw",value:function draw(index,forceDraw){if(this.getShouldDraw(index,forceDraw)&&index<this.spreadsheet.options[this.type].amount){var existingRowCol=this.rowColMap.get(index);null==existingRowCol||existingRowCol.destroy();var rowCol=new rowCol_RowCol(this,index);this.getIsLastFrozen(index)&&(rowCol.gridLine.setAttrs(this.spreadsheet.styles[this.type].frozenLine),this.frozenLine=rowCol.gridLine,this.frozenLine[this.functions.axis](this.getAxis(index)+this.getSize(index)-this.sheet.getViewportVector()[this.functions.axis]),this.sheet.scrollGroups.xySticky.sheetGroup.add(this.frozenLine)),this.rowColMap.set(index,rowCol)}}}]),RowCols}(),rowCols_RowCols=RowCols_RowCols,CellEditor_module=(__webpack_require__(98),__webpack_require__(344)),CellEditor_module_options={insert:"head",singleton:!1},cellEditor_CellEditor_module=(injectStylesIntoStyleTag_default()(CellEditor_module.a,CellEditor_module_options),CellEditor_module.a.locals||{}),tippy_esm=__webpack_require__(77),FormulaHelper_module=__webpack_require__(345),FormulaHelper_module_options={insert:"head",singleton:!1},formulaHelper_FormulaHelper_module=(injectStylesIntoStyleTag_default()(FormulaHelper_module.a,FormulaHelper_module_options),FormulaHelper_module.a.locals||{}),isEmpty=__webpack_require__(511),isEmpty_default=__webpack_require__.n(isEmpty);function FormulaHelper_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var HyperFormulaModule,formulaHelper_FormulaHelper=function(){function FormulaHelper(formulas,onItemClick){var _this=this;!function FormulaHelper_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FormulaHelper),this.formulaHelperEl=void 0,this.formulaHelperListContainerEl=void 0,this.helper=void 0,this.list=void 0,this.handleListItemClick=function(e){var target=e.target;null!=target&&target.matches("li")&&_this.onItemClick(target.textContent)};var _createWrapperContent=function createWrapperContent(){var formulaHelperListContainerEl=document.createElement("div");formulaHelperListContainerEl.classList.add(formulaHelper_FormulaHelper_module.formulaHelperListContainer);var formulaHelperEl=document.createElement("div");return formulaHelperEl.classList.add(formulaHelper_FormulaHelper_module.formulaHelper,"powersheet-formula-helper"),formulaHelperEl.appendChild(formulaHelperListContainerEl),{formulaHelperListContainerEl:formulaHelperListContainerEl,formulaHelperEl:formulaHelperEl}}(),formulaHelperListContainerEl=_createWrapperContent.formulaHelperListContainerEl,formulaHelperEl=_createWrapperContent.formulaHelperEl;this.formulaHelperListContainerEl=formulaHelperListContainerEl,this.formulaHelperEl=formulaHelperEl,this.formulas=formulas,this.helper=Object(tippy_esm.b)(formulaHelperEl,{target:formulaHelper_FormulaHelper_module.formulaHelper,arrow:!1,placement:"bottom",theme:"formula-helper",interactive:!0}),this.onItemClick=onItemClick}return function FormulaHelper_createClass(Constructor,protoProps,staticProps){return protoProps&&FormulaHelper_defineProperties(Constructor.prototype,protoProps),staticProps&&FormulaHelper_defineProperties(Constructor,staticProps),Constructor}(FormulaHelper,[{key:"show",value:function show(filterText){var formulas=this.formulas.filter((function(formula){return!filterText||formula.startsWith(filterText)}));isEmpty_default()(formulas)?this.helper.hide():(this.updateList(formulas),this.helper.show())}},{key:"hide",value:function hide(){this.helper.hide()}},{key:"destroy",value:function destroy(){this.helper.destroy(),this.formulaHelperEl.remove()}},{key:"updateList",value:function updateList(formulas){var _this$formulaHelperLi,list=function createFormulaList(formulas){var list=document.createElement("ul");return list.classList.add(formulaHelper_FormulaHelper_module.list,"powersheet-formula-helper-list"),formulas.forEach((function(formula){var listItem=document.createElement("li");listItem.textContent=formula,list.appendChild(listItem)})),list}(formulas);this.list?null===(_this$formulaHelperLi=this.formulaHelperListContainerEl)||void 0===_this$formulaHelperLi||_this$formulaHelperLi.replaceChild(list,this.list):this.formulaHelperListContainerEl.appendChild(list);this.list=list,this.helper.setContent(this.formulaHelperListContainerEl),list.addEventListener("click",this.handleListItemClick,{once:!0})}}]),FormulaHelper}();try{HyperFormulaModule=__webpack_require__(340)}catch(error){console.info("hyperformula is not installed. This is fine if formula calculations are not needed. However if you need formulas to be calculated in cells then please install hyperformula.")}var HyperFormula=HyperFormulaModule;function CellEditor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CellEditor_CellEditor=function(){function CellEditor(sheet){var _this=this;!function CellEditor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CellEditor),this.cellEditorContainerEl=void 0,this.cellEditorEl=void 0,this.cellTooltip=void 0,this.formulaHelper=void 0,this.spreadsheet=void 0,this.currentCell=null,this.currentScroll=null,this.onItemClick=function(suggestion){var _this$formulaHelper,value="="+suggestion+"()";_this.setTextContent(value),_this.cellEditorEl.focus(),null===(_this$formulaHelper=_this.formulaHelper)||void 0===_this$formulaHelper||_this$formulaHelper.hide()},this.onKeyDown=function(e){switch(e.stopPropagation(),e.key){case"Escape":_this.hide();break;case"Enter":_this.hideAndSave()}},this.onInput=function(e){var _target$firstChild,_this$formulaHelper2,_this$formulaHelper3,textContent=null===(_target$firstChild=e.target.firstChild)||void 0===_target$firstChild?void 0:_target$firstChild.textContent;(_this.setTextContent(null!=textContent?textContent:null),null==textContent?void 0:textContent.startsWith("="))?null===(_this$formulaHelper2=_this.formulaHelper)||void 0===_this$formulaHelper2||_this$formulaHelper2.show(null==textContent?void 0:textContent.slice(1)):null===(_this$formulaHelper3=_this.formulaHelper)||void 0===_this$formulaHelper3||_this$formulaHelper3.hide()},this.setCellEditorElPosition=function(position){_this.cellEditorContainerEl.style.top=position.y+"px",_this.cellEditorContainerEl.style.left=position.x+"px",_this.cellEditorContainerEl.style.minWidth=position.width+"px",_this.cellEditorContainerEl.style.height=position.height+"px"},this.hideCellTooltip=function(){_this.cellTooltip.hide()},this.showCellTooltip=function(){if(_this.currentCell){var _this$currentCell$sim=_this.currentCell.simpleCellAddress,row=_this$currentCell$sim.row,col=_this$currentCell$sim.col,rowText=_this.sheet.rows.rowColMap.get(row).getHeaderTextContent(),colText=_this.sheet.cols.rowColMap.get(col).getHeaderTextContent();_this.cellTooltip.setContent(""+colText+rowText),_this.cellTooltip.show()}},this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.cellEditorEl=document.createElement("div"),this.cellEditorEl.setAttribute("contentEditable","true"),this.cellEditorEl.classList.add(cellEditor_CellEditor_module.cellEditor),this.cellEditorContainerEl=document.createElement("div"),this.cellEditorContainerEl.classList.add(cellEditor_CellEditor_module.cellEditorContainer),this.cellEditorContainerEl.appendChild(this.cellEditorEl),this.cellTooltip=Object(tippy_esm.b)(this.cellEditorEl,{target:cellEditor_CellEditor_module.cellEditor,arrow:!1,trigger:"manual",hideOnClick:!1,placement:"top-start",theme:"cell",offset:[0,5]}),this.sheet.sheetEl.appendChild(this.cellEditorContainerEl),this.cellEditorEl.addEventListener("input",this.onInput),this.cellEditorEl.addEventListener("keydown",this.onKeyDown),HyperFormula&&(this.formulaHelper=new formulaHelper_FormulaHelper(this.spreadsheet.getRegisteredFunctions(),this.onItemClick)),this.formulaHelper&&this.cellEditorContainerEl.appendChild(this.formulaHelper.formulaHelperEl),this.cellEditorContainerEl.style.display="none"}return function CellEditor_createClass(Constructor,protoProps,staticProps){return protoProps&&CellEditor_defineProperties(Constructor.prototype,protoProps),staticProps&&CellEditor_defineProperties(Constructor,staticProps),Constructor}(CellEditor,[{key:"saveContentToCell",value:function saveContentToCell(){var _this$spreadsheet$dat,simpleCellAddress=this.currentCell.simpleCellAddress,cellData=null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat?void 0:_this$spreadsheet$dat[simpleCellAddress.toCellId()];this.cellEditorEl.textContent?(this.spreadsheet.pushToHistory(),this.spreadsheet.data.setCell(simpleCellAddress,Object.assign({},cellData,{value:this.cellEditorEl.textContent}))):cellData&&(this.spreadsheet.pushToHistory(),this.spreadsheet.data.deleteCell(simpleCellAddress))}},{key:"destroy",value:function destroy(){var _this$formulaHelper4;this.cellTooltip.destroy(),this.cellEditorContainerEl.remove(),this.cellEditorEl.removeEventListener("input",this.onInput),this.cellEditorEl.removeEventListener("keydown",this.onKeyDown),null===(_this$formulaHelper4=this.formulaHelper)||void 0===_this$formulaHelper4||_this$formulaHelper4.destroy()}},{key:"getIsHidden",value:function getIsHidden(){return"none"===this.cellEditorContainerEl.style.display}},{key:"setTextContent",value:function setTextContent(value){var _this$spreadsheet$for,textContent=null!=value?value:null;this.cellEditorEl.textContent=textContent,null===(_this$spreadsheet$for=this.spreadsheet.formulaBar)||void 0===_this$spreadsheet$for||_this$spreadsheet$for.setTextContent(textContent),this.spreadsheet.eventEmitter.emit(spreadsheet_events.cellEditor.change,value)}},{key:"show",value:function show(cell){var setTextContent=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentCell=cell,this.currentScroll={row:this.sheet.rows.scrollBar.scroll,col:this.sheet.cols.scrollBar.scroll};var _this$spreadsheet$dat2,_this$spreadsheet$dat3,_this$spreadsheet$dat4,simpleCellAddress=cell.simpleCellAddress;(this.clear(),this.cellEditorContainerEl.style.display="block",this.setCellEditorElPosition(cell.group.getClientRect()),setTextContent)&&(this.setTextContent(null!==(_this$spreadsheet$dat2=null===(_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat3||null===(_this$spreadsheet$dat4=_this$spreadsheet$dat3[simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat4?void 0:_this$spreadsheet$dat4.value)&&void 0!==_this$spreadsheet$dat2?_this$spreadsheet$dat2:null),setCaretToEndOfElement(this.cellEditorEl),this.cellEditorEl.focus())}},{key:"clear",value:function clear(){this.cellEditorEl.textContent=null}},{key:"hideAndSave",value:function hideAndSave(){this.getIsHidden()||(this.saveContentToCell(),this.hide())}},{key:"hide",value:function hide(){this.currentCell=null,this.currentScroll=null,this.cellTooltip.hide(),this.cellEditorContainerEl.style.display="none",this.clear(),this.spreadsheet.updateViewport()}}]),CellEditor}(),cellEditor_CellEditor=CellEditor_CellEditor,RightClickMenu_module=__webpack_require__(347),RightClickMenu_module_options={insert:"head",singleton:!1},rightClickMenu_RightClickMenu_module=(injectStylesIntoStyleTag_default()(RightClickMenu_module.a,RightClickMenu_module_options),RightClickMenu_module.a.locals||{}),HtmlElementHelpers_module=__webpack_require__(348),HtmlElementHelpers_module_options={insert:"head",singleton:!1},spreadsheet_HtmlElementHelpers_module=(injectStylesIntoStyleTag_default()(HtmlElementHelpers_module.a,HtmlElementHelpers_module_options),HtmlElementHelpers_module.a.locals||{}),dist_es2015=__webpack_require__(172),createGroup=function createGroup(elements,classNames,classNamePrefix){var group=document.createElement("div");return group.classList.add(classNames,classNamePrefix+"-group"),elements.forEach((function(element){group.appendChild(element)})),group},htmlElementHelpers_createTooltip=function createTooltip(name,classNamePrefix){var tooltip=document.createElement("span");return tooltip.dataset.tippyContent=Object(dist_es2015.a)(name),tooltip.classList.add(spreadsheet_HtmlElementHelpers_module.tooltip,classNamePrefix+"-tooltip"),tooltip},htmlElementHelpers_createDropdownContent=function createDropdownContent(classNamePrefix,className){var dropdownContent=document.createElement("div");return dropdownContent.classList.add(spreadsheet_HtmlElementHelpers_module.dropdownContent,classNamePrefix+"-dropdown-content"),className&&dropdownContent.classList.add(className),dropdownContent},createDropdownActionElement=function createDropdownActionElement(name,element,classNamePrefix){var arrowIconValues,createArrow=arguments.length>3&&void 0!==arguments[3]&&arguments[3],tooltip=htmlElementHelpers_createTooltip(name,classNamePrefix);if(createArrow){var iconValues=htmlElementHelpers_createIcon("arrowDown",classNamePrefix);arrowIconValues={arrowIcon:iconValues.icon,arrowIconContainer:iconValues.iconContainer},element.appendChild(arrowIconValues.arrowIconContainer)}return element.appendChild(tooltip),{arrowIconValues:arrowIconValues,tooltip:tooltip}},htmlElementHelpers_createButtonContainer=function createButtonContainer(classNamePrefix){var buttonContainer=document.createElement("div");return buttonContainer.classList.add(classNamePrefix+"-button-container"),buttonContainer},htmlElementHelpers_createIconButton=function createIconButton(name,classNamePrefix){var buttonContainer=htmlElementHelpers_createButtonContainer(classNamePrefix),button=document.createElement("button");button.dataset.name=name,button.classList.add(spreadsheet_HtmlElementHelpers_module.iconButton,classNamePrefix+"-icon-button");var iconValues=htmlElementHelpers_createIcon(name,classNamePrefix);return button.appendChild(iconValues.iconContainer),buttonContainer.appendChild(button),Object.assign({buttonContainer:buttonContainer,button:button},iconValues)},htmlElementHelpers_createIcon=function createIcon(name,classNamePrefix){var iconContainer=document.createElement("span"),icon=document.createElement("span");return iconContainer.classList.add(spreadsheet_HtmlElementHelpers_module.iconContainer,spreadsheet_HtmlElementHelpers_module[name+"IconContainer"],classNamePrefix+"-icon-container",classNamePrefix+"-"+name+"-icon-container"),icon.classList.add(spreadsheet_HtmlElementHelpers_module.icon,spreadsheet_HtmlElementHelpers_module[name],classNamePrefix+"-icon",classNamePrefix+"-"+name),iconContainer.appendChild(icon),{icon:icon,iconContainer:iconContainer}},rightClickMenuHtmlHelpers_createButtonContent=function createButtonContent(name,className){var button=document.createElement("button");return button.textContent=name,button.classList.add(rightClickMenu_RightClickMenu_module.buttonContent,rightClickMenu_RightClickMenu_module[className],rightClickMenuPrefix+"-"+className,rightClickMenuPrefix+"-button-content"),button};function RightClickMenu_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var rightClickMenuPrefix=prefix+"-right-click-menu",rightClickMenu_RightClickMenu=function(){function RightClickMenu(sheet){var _this=this;!function RightClickMenu_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RightClickMenu),this.rightClickMenuEl=void 0,this.menuItem=void 0,this.dropdown=void 0,this.buttonMap=void 0,this.rightClickMenuActionGroups=void 0,this.spreadsheet=void 0,this.commentOnClick=function(){var _this$sheet$comment,simpleCellAddress=_this.sheet.selector.selectedCell.simpleCellAddress;null===(_this$sheet$comment=_this.sheet.comment)||void 0===_this$sheet$comment||_this$sheet$comment.show(simpleCellAddress)},this.insertRowOnClick=function(){var row=_this.sheet.selector.selectedCell.simpleCellAddress.row;_this.sheet.rows.rowColMap.get(row).insert(1)},this.insertColOnClick=function(){var col=_this.sheet.selector.selectedCell.simpleCellAddress.col;_this.sheet.cols.rowColMap.get(col).insert(1)},this.deleteRowOnClick=function(){var row=_this.sheet.selector.selectedCell.simpleCellAddress.row;_this.sheet.rows.rowColMap.get(row).delete(1)},this.deleteColOnClick=function(){var col=_this.sheet.selector.selectedCell.simpleCellAddress.col;_this.sheet.cols.rowColMap.get(col).delete(1)},this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.buttonMap={comment:rightClickMenuHtmlHelpers_createButtonContent("Comment","comment"),copy:rightClickMenuHtmlHelpers_createButtonContent("Copy","copy"),cut:rightClickMenuHtmlHelpers_createButtonContent("Cut","cut"),paste:rightClickMenuHtmlHelpers_createButtonContent("Paste","paste"),insertRow:rightClickMenuHtmlHelpers_createButtonContent("Insert row","insert-row"),insertColumn:rightClickMenuHtmlHelpers_createButtonContent("Insert column","insert-column"),deleteRow:rightClickMenuHtmlHelpers_createButtonContent("Delete row","delete-row"),deleteColumn:rightClickMenuHtmlHelpers_createButtonContent("Delete column","delete-column")},this.rightClickMenuEl=document.createElement("div"),this.menuItem=document.createElement("div"),this.rightClickMenuEl.classList.add(rightClickMenu_RightClickMenu_module.rightClickMenuEl,""+rightClickMenuPrefix),this.menuItem.classList.add(rightClickMenu_RightClickMenu_module.menuItem,rightClickMenuPrefix+"-menu-item");var content=document.createElement("div");content.classList.add(rightClickMenu_RightClickMenu_module.content,rightClickMenuPrefix+"-content");var buttons=this.buttonMap;this.rightClickMenuActionGroups=[{elements:[buttons.comment,buttons.copy,buttons.cut,buttons.paste]},{elements:[buttons.insertRow,buttons.insertColumn]},{elements:[buttons.deleteRow,buttons.deleteColumn]}],this.rightClickMenuActionGroups.forEach((function(_ref){var elements=_ref.elements,group=createGroup(elements,rightClickMenu_RightClickMenu_module.group,rightClickMenuPrefix);content.appendChild(group)})),Object.values(buttons).forEach((function(button){button.addEventListener("click",(function(){_this.dropdown.hide()}))})),buttons.comment.addEventListener("click",this.commentOnClick),buttons.deleteRow.addEventListener("click",this.deleteRowOnClick),buttons.deleteColumn.addEventListener("click",this.deleteColOnClick),buttons.insertRow.addEventListener("click",this.insertRowOnClick),buttons.insertColumn.addEventListener("click",this.insertColOnClick),buttons.cut.addEventListener("click",(function(){_this.spreadsheet.clipboard.cut()})),buttons.copy.addEventListener("click",(function(){_this.spreadsheet.clipboard.copy()})),buttons.paste.addEventListener("click",(function(){_this.spreadsheet.clipboard.paste()})),this.dropdown=Object(tippy_esm.a)(this.sheet.sheetEl,{placement:"auto",interactive:!0,arrow:!1,delay:0,trigger:"click",plugins:[tippy_esm.c],followCursor:"initial",theme:"dropdown",content:content,showOnCreate:!1,hideOnClick:!0}),this.hide(),this.rightClickMenuEl.appendChild(this.menuItem)}return function RightClickMenu_createClass(Constructor,protoProps,staticProps){return protoProps&&RightClickMenu_defineProperties(Constructor.prototype,protoProps),staticProps&&RightClickMenu_defineProperties(Constructor,staticProps),Constructor}(RightClickMenu,[{key:"hide",value:function hide(){this.dropdown.disable(),this.dropdown.hide()}},{key:"show",value:function show(){this.dropdown.enable(),this.dropdown.show()}}]),RightClickMenu}(),Stage=__webpack_require__(516),Sheet_module=__webpack_require__(349),Sheet_module_options={insert:"head",singleton:!1},sheet_Sheet_module=(injectStylesIntoStyleTag_default()(Sheet_module.a,Sheet_module_options),Sheet_module.a.locals||{}),Comment_module=__webpack_require__(350),Comment_module_options={insert:"head",singleton:!1},comment_Comment_module=(injectStylesIntoStyleTag_default()(Comment_module.a,Comment_module_options),Comment_module.a.locals||{});function Comment_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var comment_Comment=function(){function Comment(sheet){var _this=this;!function Comment_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Comment),this.textarea=void 0,this.content=void 0,this.buttonContainer=void 0,this.successButton=void 0,this.cancelButton=void 0,this.container=void 0,this.spreadsheet=void 0,this.cancelButtonOnClick=function(){_this.hide()},this.successButtonOnClick=function(){var simpleCellAddress=_this.sheet.selector.selectedCell.simpleCellAddress;_this.spreadsheet.data.setCell(simpleCellAddress,{comment:_this.textarea.value}),_this.spreadsheet.updateViewport(),_this.hide()},this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.content=function createContent(){var content=document.createElement("div");return content.classList.add(comment_Comment_module.content,"powersheet-comment-content"),content}(),this.textarea=function createTextarea(){var textarea=document.createElement("textarea");return textarea.classList.add(comment_Comment_module.textarea,"powersheet-comment-textarea"),textarea}(),this.buttonContainer=function createButtonContainer(){var buttonContainer=document.createElement("div");return buttonContainer.classList.add(comment_Comment_module.buttonContainer,"powersheet-comment-button-container"),buttonContainer}(),this.successButton=function createSuccessButton(){var successButton=document.createElement("button");return successButton.innerText="Comment",successButton.classList.add(comment_Comment_module.successButton,"powersheet-comment-success-button"),successButton}(),this.cancelButton=function createCancelButton(){var cancelButton=document.createElement("button");return cancelButton.innerText="Cancel",cancelButton.classList.add(comment_Comment_module.cancelButton,"powersheet-comment-cancel-button"),cancelButton}(),this.content.appendChild(this.textarea),this.content.appendChild(this.buttonContainer),this.buttonContainer.appendChild(this.successButton),this.buttonContainer.appendChild(this.cancelButton),this.container=Object(tippy_esm.a)(this.sheet.sheetEl,{placement:"auto",interactive:!0,arrow:!1,trigger:"manual",delay:100,plugins:[tippy_esm.c],followCursor:"initial",theme:"comment",showOnCreate:!1,content:this.content,hideOnClick:!0,onHide:function onHide(){_this.textarea.value=""}}),this.hide(),this.cancelButton.addEventListener("click",this.cancelButtonOnClick),this.successButton.addEventListener("click",this.successButtonOnClick)}return function Comment_createClass(Constructor,protoProps,staticProps){return protoProps&&Comment_defineProperties(Constructor.prototype,protoProps),staticProps&&Comment_defineProperties(Constructor,staticProps),Constructor}(Comment,[{key:"destroy",value:function destroy(){this.successButton.removeEventListener("click",this.successButtonOnClick),this.cancelButton.removeEventListener("click",this.cancelButtonOnClick)}},{key:"hide",value:function hide(){this.container.hide(),this.textarea.value=""}},{key:"show",value:function show(simpleCellAddress){var _this$spreadsheet$dat;this.container.unmount(),this.container.show();var comment=null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat?void 0:_this$spreadsheet$dat[simpleCellAddress.toCellId()].comment;comment&&(this.textarea.value=comment)}}]),Comment}(),sharedStyles=(__webpack_require__(200),__webpack_require__(335),__webpack_require__(115),__webpack_require__(63),{gridLine:{stroke:"#e3e3e3",strokeWidth:1},resizeMarker:{fill:"#0057ff",opacity:.3,visible:!1,hitStrokeWidth:15,draggable:!0},resizeGuideLine:{strokeWidth:1,visible:!1,stroke:"blue"},resizeLine:{stroke:"#8a8a8a",strokeWidth:1,hitStrokeWidth:15,opacity:.7},frozenLine:{strokeWidth:1,stroke:"blue"},headerRect:{fill:"#f4f5f8"},headerText:{fontFamily:"Arial"},selection:{strokeWidth:1}}),defaultStyles={topLeftRect:{fill:sharedStyles.headerRect.fill},selectionFirstCell:Object.assign({},sharedStyles.selection,{fill:"transparent",stroke:"#0057ff",strokeWidth:1.5}),selection:Object.assign({},sharedStyles.selection,{stroke:"#1a73e8",fill:"rgb(14, 101, 235, 0.1)"}),commentMarker:{type:"commentMarker",stroke:"orange",fill:"orange",strokeWidth:2,offsetX:-6,offsetY:1,points:[0,5,5,5,0,0],closed:!0},row:{frozenLine:sharedStyles.frozenLine,resizeGuideLine:sharedStyles.resizeGuideLine,resizeMarker:Object.assign({},sharedStyles.resizeMarker,{height:7,dragBoundFunc:function dragBoundFunc(pos){return Object.assign({},pos,{x:this.absolutePosition().x})}}),resizeLine:sharedStyles.resizeLine,gridLine:sharedStyles.gridLine,headerRect:Object.assign({},sharedStyles.headerRect,{width:25}),headerText:sharedStyles.headerText},col:{frozenLine:sharedStyles.frozenLine,resizeGuideLine:sharedStyles.resizeGuideLine,resizeMarker:Object.assign({},sharedStyles.resizeMarker,{width:7,dragBoundFunc:function dragBoundFunc(pos){return Object.assign({},pos,{y:this.absolutePosition().y})}}),resizeLine:sharedStyles.resizeLine,gridLine:sharedStyles.gridLine,headerRect:Object.assign({},sharedStyles.headerRect,{height:20}),headerText:sharedStyles.headerText},cell:{rect:{type:"cellRect",fill:"white",stroke:sharedStyles.gridLine.stroke,strokeWidth:sharedStyles.gridLine.strokeWidth},text:{type:"cellText",fontFamily:"Arial",fontSize:14,fill:"black",align:"left",verticalAlign:"middle",wrap:"none",padding:2}}};var cell_Border=function Border(styleableCell,borderStyle){!function Border_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Border),this.line=void 0,this.styleableCell=styleableCell,this.borderStyle=borderStyle,this.line=new Line.a({stroke:"black",strokeWidth:sharedStyles.gridLine.strokeWidth}),this.styleableCell.group.add(this.line),this.line.moveToTop()};function FontStyle_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_FontStyle=function(){function FontStyle(text,bold,italic){!function FontStyle_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FontStyle),this.text=text,this.bold=bold,this.italic=italic}return function FontStyle_createClass(Constructor,protoProps,staticProps){return protoProps&&FontStyle_defineProperties(Constructor.prototype,protoProps),staticProps&&FontStyle_defineProperties(Constructor,staticProps),Constructor}(FontStyle,[{key:"getStyle",value:function getStyle(){return this.bold&&this.italic?"italic bold":this.bold&&!this.italic?"bold":!this.bold&&this.italic?"italic":"normal"}},{key:"setStyle",value:function setStyle(){var _this$text;null===(_this$text=this.text)||void 0===_this$text||_this$text.fontStyle(this.getStyle())}}]),FontStyle}();function TextDecoration_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var cell_TextDecoration=function(){function TextDecoration(text,strikeThrough,underline){!function TextDecoration_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TextDecoration),this.text=text,this.strikeThrough=strikeThrough,this.underline=underline}return function TextDecoration_createClass(Constructor,protoProps,staticProps){return protoProps&&TextDecoration_defineProperties(Constructor.prototype,protoProps),staticProps&&TextDecoration_defineProperties(Constructor,staticProps),Constructor}(TextDecoration,[{key:"getStyle",value:function getStyle(){return this.strikeThrough&&this.underline?"line-through underline":this.strikeThrough&&!this.underline?"line-through":!this.strikeThrough&&this.underline?"underline":""}},{key:"setStyle",value:function setStyle(){var _this$text;null===(_this$text=this.text)||void 0===_this$text||_this$text.textDecoration(this.getStyle())}}]),TextDecoration}(),numfmt=__webpack_require__(176);function StyleableCell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function StyleableCell_setPrototypeOf(o,p){return StyleableCell_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},StyleableCell_setPrototypeOf(o,p)}function StyleableCell_createSuper(Derived){var hasNativeReflectConstruct=function StyleableCell_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=StyleableCell_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=StyleableCell_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return StyleableCell_possibleConstructorReturn(this,result)}}function StyleableCell_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function StyleableCell_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function StyleableCell_getPrototypeOf(o){return StyleableCell_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},StyleableCell_getPrototypeOf(o)}var cell_StyleableCell=function(_Cell){!function StyleableCell_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&StyleableCell_setPrototypeOf(subClass,superClass)}(StyleableCell,_Cell);var _super=StyleableCell_createSuper(StyleableCell);function StyleableCell(sheet,simpleCellAddress){var _this;return function StyleableCell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StyleableCell),(_this=_super.call(this,sheet,simpleCellAddress)).text=void 0,_this.borders=new Map,_this.draw(),_this}return function StyleableCell_createClass(Constructor,protoProps,staticProps){return protoProps&&StyleableCell_defineProperties(Constructor.prototype,protoProps),staticProps&&StyleableCell_defineProperties(Constructor,staticProps),Constructor}(StyleableCell,[{key:"getBorder",value:function getBorder(type){var border=new cell_Border(this,type);return this.borders.set(type,border),border}},{key:"setBottomBorder",value:function setBottomBorder(){var clientRect=this.getClientRectWithoutStroke(),border=this.getBorder("borderBottom");border.line.y(clientRect.height),border.line.points([0,0,clientRect.width,0])}},{key:"setRightBorder",value:function setRightBorder(){var clientRect=this.getClientRectWithoutStroke(),border=this.getBorder("borderRight");border.line.x(clientRect.width),border.line.points([0,0,0,clientRect.height])}},{key:"setTopBorder",value:function setTopBorder(){var clientRect=this.getClientRectWithoutStroke();this.getBorder("borderTop").line.points([0,0,clientRect.width,0])}},{key:"setLeftBorder",value:function setLeftBorder(){var clientRect=this.getClientRectWithoutStroke();this.getBorder("borderLeft").line.points([0,0,0,clientRect.height])}},{key:"setTextWrap",value:function setTextWrap(textWrap){var _this$text;null===(_this$text=this.text)||void 0===_this$text||_this$text.wrap(textWrap)}},{key:"setBackgroundColor",value:function setBackgroundColor(backgroundColor){this.rect.fill(backgroundColor)}},{key:"setFontColor",value:function setFontColor(fontColor){var _this$text2;null===(_this$text2=this.text)||void 0===_this$text2||_this$text2.fill(fontColor)}},{key:"setFontSize",value:function setFontSize(fontSize){var _this$text3;null===(_this$text3=this.text)||void 0===_this$text3||_this$text3.fontSize(fontSize)}},{key:"setBold",value:function setBold(bold){var _this$spreadsheet$dat,_this$spreadsheet$dat2,_this$spreadsheet$dat3,italic=null!==(_this$spreadsheet$dat=null===(_this$spreadsheet$dat2=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat2||null===(_this$spreadsheet$dat3=_this$spreadsheet$dat2[this.simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat3?void 0:_this$spreadsheet$dat3.italic)&&void 0!==_this$spreadsheet$dat&&_this$spreadsheet$dat;new cell_FontStyle(this.text,bold,italic).setStyle()}},{key:"setItalic",value:function setItalic(italic){var _this$spreadsheet$dat4,_this$spreadsheet$dat5,_this$spreadsheet$dat6,bold=null!==(_this$spreadsheet$dat4=null===(_this$spreadsheet$dat5=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat5||null===(_this$spreadsheet$dat6=_this$spreadsheet$dat5[this.simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat6?void 0:_this$spreadsheet$dat6.bold)&&void 0!==_this$spreadsheet$dat4&&_this$spreadsheet$dat4;new cell_FontStyle(this.text,bold,italic).setStyle()}},{key:"setStrikeThrough",value:function setStrikeThrough(strikeThrough){var _this$spreadsheet$dat7,_this$spreadsheet$dat8,_this$spreadsheet$dat9,underline=null!==(_this$spreadsheet$dat7=null===(_this$spreadsheet$dat8=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat8||null===(_this$spreadsheet$dat9=_this$spreadsheet$dat8[this.simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat9?void 0:_this$spreadsheet$dat9.underline)&&void 0!==_this$spreadsheet$dat7&&_this$spreadsheet$dat7;new cell_TextDecoration(this.text,strikeThrough,underline).setStyle()}},{key:"setUnderline",value:function setUnderline(underline){var _this$spreadsheet$dat10,_this$spreadsheet$dat11,_this$spreadsheet$dat12,strikeThrough=null!==(_this$spreadsheet$dat10=null===(_this$spreadsheet$dat11=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat11||null===(_this$spreadsheet$dat12=_this$spreadsheet$dat11[this.simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat12?void 0:_this$spreadsheet$dat12.strikeThrough)&&void 0!==_this$spreadsheet$dat10&&_this$spreadsheet$dat10;new cell_TextDecoration(this.text,strikeThrough,underline).setStyle()}},{key:"setHorizontalTextAlign",value:function setHorizontalTextAlign(horizontalTextAlign){var _this$text4;null===(_this$text4=this.text)||void 0===_this$text4||_this$text4.align(horizontalTextAlign)}},{key:"setVerticalTextAlign",value:function setVerticalTextAlign(verticalTextAlign){var _this$text5;null===(_this$text5=this.text)||void 0===_this$text5||_this$text5.verticalAlign(verticalTextAlign)}},{key:"setTextFormat",value:function setTextFormat(textFormatPattern){if(this.text&&!this.spreadsheet.data.spreadsheetData.showFormulas){var text=this.text.text();try{text=Object(numfmt.format)(textFormatPattern,Number(text))}catch(e){text=e}try{text=Object(numfmt.format)(textFormatPattern,text)}catch(e){text=e}this.text.text(text)}}},{key:"setCellCommentMarker",value:function setCellCommentMarker(){var clientRect=this.getClientRectWithoutStroke(),commentMarker=new Line.a(Object.assign({},this.spreadsheet.styles.commentMarker,{x:clientRect.width}));this.group.add(commentMarker),function rotateAroundCenter(shape,rotation){var getAngle=Konva.getAngle,topLeft={x:-shape.width()/2,y:-shape.height()/2},current=rotatePoint(topLeft,getAngle(shape.rotation())),rotated=rotatePoint(topLeft,getAngle(rotation)),dx=rotated.x-current.x,dy=rotated.y-current.y;shape.rotation(rotation),shape.x(shape.x()+dx),shape.y(shape.y()+dy)}(commentMarker,180)}},{key:"setCellTextHeight",value:function setCellTextHeight(){var _this$text6,_this$text7,height=this.getClientRectWithoutStroke().height;"wrap"!==(null===(_this$text6=this.text)||void 0===_this$text6?void 0:_this$text6.wrap())&&(null===(_this$text7=this.text)||void 0===_this$text7||_this$text7.height(height))}},{key:"setCellTextValue",value:function setCellTextValue(value){var width=this.getClientRectWithoutStroke().width;this.text=new Text.a(Object.assign({},this.spreadsheet.styles.cell.text,{text:value,width:width})),this.group.add(this.text)}},{key:"draw",value:function draw(){var _this$spreadsheet$dat13,_this$spreadsheet$hyp,_this$spreadsheet$hyp2,_value,_this2=this,cell=null===(_this$spreadsheet$dat13=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat13?void 0:_this$spreadsheet$dat13[this.simpleCellAddress.toCellId()],value=null!==(_this$spreadsheet$hyp=null===(_this$spreadsheet$hyp2=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp2?void 0:_this$spreadsheet$hyp2.getCellValue(this.simpleCellAddress))&&void 0!==_this$spreadsheet$hyp?_this$spreadsheet$hyp:null==cell?void 0:cell.value;(this.spreadsheet.data.spreadsheetData.showFormulas&&(value=null==cell?void 0:cell.value),value)&&this.setCellTextValue(null===(_value=value)||void 0===_value?void 0:_value.toString());null!=cell&&cell.comment&&this.setCellCommentMarker();var _ref=null!=cell?cell:{},textWrap=_ref.textWrap,fontSize=_ref.fontSize,borders=_ref.borders,backgroundColor=_ref.backgroundColor,fontColor=_ref.fontColor,bold=_ref.bold,italic=_ref.italic,strikeThrough=_ref.strikeThrough,underline=_ref.underline,horizontalTextAlign=_ref.horizontalTextAlign,verticalTextAlign=_ref.verticalTextAlign,textFormatPattern=_ref.textFormatPattern;textWrap&&this.setTextWrap(textWrap),fontSize&&this.setFontSize(fontSize),backgroundColor&&this.setBackgroundColor(backgroundColor),fontColor&&this.setFontColor(fontColor),bold&&this.setBold(bold),italic&&this.setItalic(italic),strikeThrough&&this.setStrikeThrough(strikeThrough),underline&&this.setUnderline(underline),horizontalTextAlign&&this.setHorizontalTextAlign(horizontalTextAlign),verticalTextAlign&&this.setVerticalTextAlign(verticalTextAlign),textFormatPattern&&this.setTextFormat(textFormatPattern),borders&&borders.forEach((function(borderType){switch(borderType){case"borderLeft":_this2.setLeftBorder();break;case"borderTop":_this2.setTopBorder();break;case"borderRight":_this2.setRightBorder();break;case"borderBottom":_this2.setBottomBorder()}}));var stickyGroup=this.getStickyGroupCellBelongsTo();if(this.sheet.scrollGroups[stickyGroup].cellGroup.add(this.group),this.group.moveToTop(),!this.getIsCellPartOfMerge()){var height=this.sheet.rows.getSize(this.simpleCellAddress.row),cellHeight=this.getClientRectWithoutStroke().height;cellHeight>height&&(this.spreadsheet.data.setRowCol("rows",new cell_RowColAddress(this.sheet.sheetId,this.simpleCellAddress.row),{size:cellHeight}),this.spreadsheet.updateViewport())}this.setCellTextHeight()}}]),StyleableCell}(cell_Cell);function Cells_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=Cells_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Cells_slicedToArray(arr,i){return function Cells_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Cells_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||Cells_unsupportedIterableToArray(arr,i)||function Cells_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cells_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return Cells_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cells_arrayLikeToArray(o,minLen):void 0}}function Cells_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Cells_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Cells_Cells=function(){function Cells(sheet){var _this=this;!function Cells_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Cells),this.cellsMap=void 0,this.spreadsheet=void 0,this.getShouldDraw=function(simpleCellAddress,forceDraw){var _this$spreadsheet$dat,cellId=simpleCellAddress.toCellId(),cellAlreadyExists=!!_this.cellsMap.get(simpleCellAddress),hasCellData=!(!(null===(_this$spreadsheet$dat=_this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat?void 0:_this$spreadsheet$dat[cellId])&&!_this.spreadsheet.data.getIsCellAMergedCell(simpleCellAddress));return(forceDraw||!cellAlreadyExists)&&hasCellData},this.sheet=sheet,this.spreadsheet=this.sheet.spreadsheet,this.cellsMap=new Map}return function Cells_createClass(Constructor,protoProps,staticProps){return protoProps&&Cells_defineProperties(Constructor.prototype,protoProps),staticProps&&Cells_defineProperties(Constructor,staticProps),Constructor}(Cells,[{key:"clearAll",value:function clearAll(){this.cellsMap.clear(),this.sheet.merger.associatedMergedCellAddressMap.clear()}},{key:"destroyOutOfViewportItems",value:function destroyOutOfViewportItems(){var _step,_iterator=Cells_createForOfIteratorHelper(this.cellsMap);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _ref2=Cells_slicedToArray(_step.value,2),key=_ref2[0],cell=_ref2[1];this.sheet.isShapeOutsideOfViewport(cell.group)&&(cell.destroy(),this.cellsMap.delete(key))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"drawViewport",value:function drawViewport(){var _data$frozenCells,_data$frozenCells$thi,_data$frozenCells2,_data$frozenCells2$th,forceDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0],data=this.spreadsheet.data.spreadsheetData,frozenRow=null===(_data$frozenCells=data.frozenCells)||void 0===_data$frozenCells||null===(_data$frozenCells$thi=_data$frozenCells[this.sheet.sheetId])||void 0===_data$frozenCells$thi?void 0:_data$frozenCells$thi.row,frozenCol=null===(_data$frozenCells2=data.frozenCells)||void 0===_data$frozenCells2||null===(_data$frozenCells2$th=_data$frozenCells2[this.sheet.sheetId])||void 0===_data$frozenCells2$th?void 0:_data$frozenCells2$th.col;if(!Object(lodash.isNil)(frozenRow))for(var ri=0;ri<=frozenRow;ri++){var _step2,_iterator2=Cells_createForOfIteratorHelper(this.sheet.cols.rowColMap.keys());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var ci=_step2.value,simpleCellAddress=new cell_SimpleCellAddress(this.sheet.sheetId,ri,ci);this.drawCell(simpleCellAddress,forceDraw)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}if(!Object(lodash.isNil)(frozenCol))for(var _ci=0;_ci<=frozenCol;_ci++){var _step3,_iterator3=Cells_createForOfIteratorHelper(this.sheet.rows.rowColMap.keys());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _ri=_step3.value,_simpleCellAddress=new cell_SimpleCellAddress(this.sheet.sheetId,_ri,_ci);this.drawCell(_simpleCellAddress,forceDraw)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}var _step4,_iterator4=Cells_createForOfIteratorHelper(this.sheet.rows.scrollBar.sheetViewportPosition.iterateFromXToY());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step5,_ri2=_step4.value,_iterator5=Cells_createForOfIteratorHelper(this.sheet.cols.scrollBar.sheetViewportPosition.iterateFromXToY());try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _ci2=_step5.value,_simpleCellAddress2=new cell_SimpleCellAddress(this.sheet.sheetId,_ri2,_ci2);this.drawCell(_simpleCellAddress2,forceDraw)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"drawCell",value:function drawCell(simpleCellAddress,forceDraw){if(this.getShouldDraw(simpleCellAddress,forceDraw)){var existingCell=this.sheet.cells.cellsMap.get(simpleCellAddress);null==existingCell||existingCell.destroy();var cell=new cell_StyleableCell(this.sheet,simpleCellAddress);this.sheet.cells.cellsMap.set(simpleCellAddress,cell)}}},{key:"updateViewport",value:function updateViewport(){this.clearAll(),this.drawViewport(!0)}}]),Cells}(),cells_Cells=Cells_Cells;function Sheet_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=Sheet_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){function e(_x){return _e.apply(this,arguments)}return e.toString=function(){return _e.toString()},e}((function(e){throw e})),f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){function e(_x2){return _e2.apply(this,arguments)}return e.toString=function(){return _e2.toString()},e}((function(e){didErr=!0,err=e})),f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return Sheet_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||Sheet_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sheet_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return Sheet_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sheet_arrayLikeToArray(o,minLen):void 0}}function Sheet_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Sheet_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var scrollGroups=["main","xSticky","ySticky","xySticky"],sheet_Sheet=function(){function Sheet(spreadsheet,sheetId){var _this=this;!function Sheet_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Sheet),this.scrollGroups=void 0,this.sheetEl=void 0,this.stage=void 0,this.layer=void 0,this.sheet=void 0,this.cols=void 0,this.rows=void 0,this.selector=void 0,this.merger=void 0,this.cells=void 0,this.sheetDimensions=void 0,this.previousSheetClickTime=0,this.sheetClickTime=0,this.cellEditor=void 0,this.rightClickMenu=void 0,this.comment=void 0,this.throttledResize=void 0,this.throttledSheetMove=void 0,this.onResize=function(){_this.updateSize()},this.onWheel=function(e){e.evt.preventDefault(),_this.cols.scrollBar.scrollBarEl.scrollBy(e.evt.deltaX,0),_this.rows.scrollBar.scrollBarEl.scrollBy(0,e.evt.deltaY),_this.spreadsheet.eventEmitter.emit(spreadsheet_events.scrollWheel.scroll,e)},this.sheetOnTouchStart=function(e){var touch1=e.evt.touches[0],touch2=e.evt.touches[1];if(!touch1||!touch2){var clientX=touch1.clientX,clientY=touch1.clientY;_this.cellEditor.hideAndSave(),_this.cols.scrollBar.previousTouchMovePosition=clientX,_this.rows.scrollBar.previousTouchMovePosition=clientY}},this.sheetOnTouchMove=function(e){var touch1=e.evt.touches[0],touch2=e.evt.touches[1];if(!touch1||!touch2){var clientX=touch1.clientX,clientY=touch1.clientY,deltaX=(_this.cols.scrollBar.previousTouchMovePosition-clientX)*_this.spreadsheet.options.touchScrollSpeed,deltaY=(_this.rows.scrollBar.previousTouchMovePosition-clientY)*_this.spreadsheet.options.touchScrollSpeed;_this.cols.scrollBar.scrollBarEl.scrollBy(deltaX,0),_this.rows.scrollBar.scrollBarEl.scrollBy(0,deltaY),_this.cols.scrollBar.previousTouchMovePosition=clientX,_this.rows.scrollBar.previousTouchMovePosition=clientY}},this.onContextMenu=function(e){e.evt.preventDefault()},this.onSheetMouseDown=function(){var vector=_this.sheet.getRelativePointerPosition();_this.selector.startSelection(vector)},this.onSheetMouseMove=function(){_this.selector.moveSelection()},this.onSheetMouseUp=function(){_this.selector.endSelection()},this.stageOnClick=function(e){0===e.evt.button&&_this.rightClickMenu.hide(),2===e.evt.button&&(_this.rightClickMenu.dropdown.state.isShown?_this.rightClickMenu.hide():_this.rightClickMenu.show())},this.stageOnMousedown=function(){_this.cellEditor.hideAndSave()},this.sheetOnTap=function(){var vector=_this.sheet.getRelativePointerPosition();_this.selector.startSelection(vector),_this.selector.endSelection(),_this.setCellOnAction()},this.sheetOnClick=function(e){0===e.evt.button&&_this.setCellOnAction()},this.keyHandler=function(e){switch(e.stopPropagation(),e.key){case"Escape":break;case"Delete":var _this$spreadsheet$hyp;_this.spreadsheet.pushToHistory(),null===(_this$spreadsheet$hyp=_this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp||_this$spreadsheet$hyp.batch((function(){_this.selector.selectedCells.forEach((function(cell){var simpleCellAddress=cell.simpleCellAddress;_this.spreadsheet.data.deleteCell(simpleCellAddress)}))}));break;case e.ctrlKey&&"z":_this.spreadsheet.undo();break;case e.ctrlKey&&"y":_this.spreadsheet.redo();break;case e.ctrlKey&&"x":_this.spreadsheet.clipboard.cut();break;case e.ctrlKey&&"c":_this.spreadsheet.clipboard.copy();break;case e.ctrlKey&&"v":_this.spreadsheet.clipboard.paste();break;default:_this.cellEditor.getIsHidden()&&!e.ctrlKey&&_this.cellEditor.show(_this.selector.selectedCell)}_this.spreadsheet.updateViewport()},this.spreadsheet=spreadsheet,this.sheetId=sheetId,this.sheetDimensions={width:0,height:0},this.sheetEl=document.createElement("div"),this.sheetEl.classList.add(prefix+"-sheet",sheet_Sheet_module.sheet),this.spreadsheet.sheetsEl.appendChild(this.sheetEl),this.throttledResize=Object(lodash.throttle)(this.onResize,50),this.throttledSheetMove=Object(lodash.throttle)(this.onSheetMouseMove,35),this.sheet=new Rect.a({type:"sheet",listening:!0,opacity:0}),this.stage=new Stage.a({container:this.sheetEl}),this.layer=new Layer.a,this.layer.add(this.sheet),this.stage.add(this.layer),this.cells=new cells_Cells(this),this.cols=new rowCols_RowCols("col",this),this.rows=new rowCols_RowCols("row",this),this.rows.updateViewportSize(),this.cols.updateViewportSize(),this.merger=new sheet_Merger(this),this.selector=new sheet_Selector(this),this.rightClickMenu=new rightClickMenu_RightClickMenu(this),this.comment=new comment_Comment(this),this.stage.on("contextmenu",this.onContextMenu),this.stage.on("mousedown",this.stageOnMousedown),this.stage.on("click",this.stageOnClick),this.stage.on("wheel",this.onWheel),this.sheet.on("click",this.sheetOnClick),this.sheet.on("mousedown",this.onSheetMouseDown),this.sheet.on("mousemove",this.throttledSheetMove),this.sheet.on("mouseup",this.onSheetMouseUp),this.sheet.on("touchstart",this.sheetOnTouchStart),this.sheet.on("touchmove",this.sheetOnTouchMove),this.sheet.on("tap",this.sheetOnTap),this.sheetEl.tabIndex=1,this.sheetEl.addEventListener("keydown",this.keyHandler),window.addEventListener("resize",this.throttledResize),this.updateSheetDimensions();var sheetConfig={width:this.cols.totalSize,height:this.rows.totalSize,x:this.getViewportVector().x,y:this.getViewportVector().y};this.sheet.setAttrs(sheetConfig),this.cols.scrollBar.setYIndex(),this.rows.scrollBar.setYIndex(),this.spreadsheet.updateViewport(),this.rows.scrollBar.scrollBarEl.style.bottom="18px",this.cellEditor=new cellEditor_CellEditor(this),this.updateSize()}return function Sheet_createClass(Constructor,protoProps,staticProps){return protoProps&&Sheet_defineProperties(Constructor.prototype,protoProps),staticProps&&Sheet_defineProperties(Constructor,staticProps),Constructor}(Sheet,[{key:"updateSize",value:function updateSize(){this.stage.width(this.spreadsheet.sheetsEl.offsetWidth),this.stage.height(this.spreadsheet.sheetsEl.offsetHeight),this.sheet.width(this.stage.width()-this.getViewportVector().x),this.sheet.height(this.stage.height()-this.getViewportVector().y),this.rows.updateViewportSize(),this.cols.updateViewportSize();var context=this.layer.canvas.getContext();context.reset(),context.translate(.5,.5),this.spreadsheet.updateViewport()}},{key:"setCellOnAction",value:function setCellOnAction(){var _this$spreadsheet$dat,_this$spreadsheet$dat2,selectedFirstcell=this.selector.selectedCell,simpleCellAddress=selectedFirstcell.simpleCellAddress,cellId=simpleCellAddress.toCellId();this.hasDoubleClickedOnCell()&&this.cellEditor.show(selectedFirstcell),null!==(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.cells)&&void 0!==_this$spreadsheet$dat&&null!==(_this$spreadsheet$dat2=_this$spreadsheet$dat[cellId])&&void 0!==_this$spreadsheet$dat2&&_this$spreadsheet$dat2.comment&&this.comment.show(simpleCellAddress)}},{key:"hasDoubleClickedOnCell",value:function hasDoubleClickedOnCell(){this.previousSheetClickTime=this.sheetClickTime,this.sheetClickTime=(new Date).getTime();return!this.selector.hasChangedCellSelection()&&this.sheetClickTime<=this.previousSheetClickTime+300}},{key:"getMinMaxRangeSimpleCellAddress",value:function getMinMaxRangeSimpleCellAddress(cells){var getMin=function getMin(type){return Math.min.apply(Math,_toConsumableArray(cells.map((function(cell){return cell.rangeSimpleCellAddress.topLeftSimpleCellAddress[type]}))))},getMax=function getMax(type){return Math.max.apply(Math,_toConsumableArray(cells.map((function(cell){return cell.rangeSimpleCellAddress.bottomRightSimpleCellAddress[type]}))))};return new cell_RangeSimpleCellAddress(new cell_SimpleCellAddress(this.sheetId,getMin("row"),getMin("col")),new cell_SimpleCellAddress(this.sheetId,getMax("row"),getMax("col")))}},{key:"isShapeOutsideOfViewport",value:function isShapeOutsideOfViewport(shape,margin){var _margin$x,_margin$y;return!shape.isClientRectOnScreen({x:-(this.getViewportVector().x+(null!==(_margin$x=null==margin?void 0:margin.x)&&void 0!==_margin$x?_margin$x:0)),y:-(this.getViewportVector().y+(null!==(_margin$y=null==margin?void 0:margin.y)&&void 0!==_margin$y?_margin$y:0))})}},{key:"updateSheetDimensions",value:function updateSheetDimensions(){this.sheetDimensions.width=this.cols.getTotalSize(),this.sheetDimensions.height=this.rows.getTotalSize()}},{key:"getViewportVector",value:function getViewportVector(){return{x:this.spreadsheet.styles.row.headerRect.width,y:this.spreadsheet.styles.col.headerRect.height}}},{key:"convertVectorsToRangeSimpleCellAddress",value:function convertVectorsToRangeSimpleCellAddress(start,end){var _step,_reverseVectorsIfStar=function reverseVectorsIfStartBiggerThanEnd(start,end){var newStart=Object.assign({},start),newEnd=Object.assign({},end),isReversedX=!1,isReversedY=!1;if(start.x>end.x){var temp=start.x;newStart.x=end.x,newEnd.x=temp,isReversedX=!0}if(start.y>end.y){var _temp=start.y;newStart.y=end.y,newEnd.y=_temp,isReversedY=!0}return{start:newStart,end:newEnd,isReversedX:isReversedX,isReversedY:isReversedY}}(start,end),newStart=_reverseVectorsIfStar.start,newEnd=_reverseVectorsIfStar.end,rowIndexes=this.rows.getTopBottomIndexFromPosition({x:newStart.y,y:newEnd.y}),colIndexes=this.cols.getTopBottomIndexFromPosition({x:newStart.x,y:newEnd.x}),rangeSimpleCellAddress=new cell_RangeSimpleCellAddress(new cell_SimpleCellAddress(this.sheetId,rowIndexes.topIndex,colIndexes.topIndex),new cell_SimpleCellAddress(this.sheetId,rowIndexes.bottomIndex,colIndexes.bottomIndex)),_iterator=Sheet_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("row"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,ri=_step.value,_iterator2=Sheet_createForOfIteratorHelper(rangeSimpleCellAddress.iterateFromTopToBottom("col"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var ci=_step2.value,simpleCellAddress=new cell_SimpleCellAddress(this.sheetId,ri,ci),existingRangeSimpleCellAddress=this.merger.associatedMergedCellAddressMap.get(simpleCellAddress.toCellId());existingRangeSimpleCellAddress&&(rangeSimpleCellAddress.limitTopLeftAddressToAnotherRange("col",existingRangeSimpleCellAddress),rangeSimpleCellAddress.limitTopLeftAddressToAnotherRange("row",existingRangeSimpleCellAddress),rangeSimpleCellAddress.limitBottomRightAddressToAnotherRange("col",existingRangeSimpleCellAddress),rangeSimpleCellAddress.limitBottomRightAddressToAnotherRange("row",existingRangeSimpleCellAddress))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return rangeSimpleCellAddress}},{key:"hide",value:function hide(){this.stage.hide(),this.sheetEl.style.display="none"}},{key:"show",value:function show(){this.stage.show(),this.sheetEl.style.display="block"}},{key:"getStickyGroupType",value:function getStickyGroupType(isOnFrozenRow,isOnFrozenCol){return isOnFrozenRow&&isOnFrozenCol?"xySticky":isOnFrozenRow?"ySticky":isOnFrozenCol?"xSticky":"main"}},{key:"destroy",value:function destroy(){var _this$cellEditor;this.stage.off("contextmenu",this.onContextMenu),this.stage.off("mousedown",this.stageOnMousedown),this.stage.off("click",this.stageOnClick),this.stage.off("wheel",this.onWheel),this.sheet.off("click",this.sheetOnClick),this.sheet.off("mousedown",this.onSheetMouseDown),this.sheet.off("mousemove",this.throttledSheetMove),this.sheet.off("mouseup",this.onSheetMouseUp),this.sheet.off("touchstart",this.sheetOnTouchStart),this.sheet.off("touchmove",this.sheetOnTouchMove),this.sheet.off("tap",this.sheetOnTap),this.sheetEl.removeEventListener("keydown",this.keyHandler),window.removeEventListener("resize",this.throttledResize),this.sheetEl.remove(),this.stage.destroy(),this.cols.destroy(),this.rows.destroy(),null===(_this$cellEditor=this.cellEditor)||void 0===_this$cellEditor||_this$cellEditor.destroy()}},{key:"drawTopLeftOffsetRect",value:function drawTopLeftOffsetRect(){var topLeftRect=new Rect.a(Object.assign({},this.spreadsheet.styles.topLeftRect,{width:this.getViewportVector().x,height:this.getViewportVector().y}));this.scrollGroups.xySticky.group.add(topLeftRect),topLeftRect.moveToTop()}},{key:"updateFrozenBackgrounds",value:function updateFrozenBackgrounds(){var xStickyFrozenBackground=this.scrollGroups.xSticky.frozenBackground,yStickyFrozenBackground=this.scrollGroups.ySticky.frozenBackground,xyStickyFrozenBackground=this.scrollGroups.xySticky.frozenBackground;if(this.rows.frozenLine&&this.cols.frozenLine){var colClientRect=this.cols.frozenLine.getClientRect({skipStroke:!0}),rowClientRect=this.rows.frozenLine.getClientRect({skipStroke:!0});colClientRect.x-=this.getViewportVector().x,rowClientRect.y-=this.getViewportVector().y,xStickyFrozenBackground.width(colClientRect.x),xStickyFrozenBackground.height(this.sheetDimensions.height),xStickyFrozenBackground.y(rowClientRect.y),yStickyFrozenBackground.width(this.sheetDimensions.width),yStickyFrozenBackground.height(rowClientRect.y),yStickyFrozenBackground.x(colClientRect.x),xyStickyFrozenBackground.width(colClientRect.x),xyStickyFrozenBackground.height(rowClientRect.y),xStickyFrozenBackground.show(),yStickyFrozenBackground.show(),xyStickyFrozenBackground.show()}else xStickyFrozenBackground.hide(),yStickyFrozenBackground.hide(),xyStickyFrozenBackground.hide()}},{key:"updateScrollGroups",value:function updateScrollGroups(){var _this2=this;scrollGroups.forEach((function(key){var _this2$scrollGroups,_this2$scrollGroups$t,_this2$scrollGroups2,_Object$assign,type=key,existingGroup=null===(_this2$scrollGroups=_this2.scrollGroups)||void 0===_this2$scrollGroups||null===(_this2$scrollGroups$t=_this2$scrollGroups[type])||void 0===_this2$scrollGroups$t?void 0:_this2$scrollGroups$t.group;null==existingGroup||existingGroup.destroy();var group=new Group.a({x:null==existingGroup?void 0:existingGroup.x(),y:null==existingGroup?void 0:existingGroup.y()}),sheetGroup=new Group.a(Object.assign({},_this2.getViewportVector(),{listening:!0,type:"sheet"})),cellGroup=new Group.a({type:"cell"}),rowColGroup=new Group.a({type:"rowCol"}),headerGroup=new Group.a({listening:!0,type:"header"}),frozenBackground=new Rect.a({type:"frozenBackground",fill:"white",visible:!1});"main"!==key&&sheetGroup.add(frozenBackground),sheetGroup.add(rowColGroup,cellGroup),group.add(sheetGroup,headerGroup),_this2.layer.add(group),_this2.sheet.moveToTop(),_this2.scrollGroups=Object.assign({},_this2.scrollGroups,((_Object$assign={})[type]=Object.assign({},null===(_this2$scrollGroups2=_this2.scrollGroups)||void 0===_this2$scrollGroups2?void 0:_this2$scrollGroups2[type],{group:group,sheetGroup:sheetGroup,cellGroup:cellGroup,rowColGroup:rowColGroup,headerGroup:headerGroup,frozenBackground:frozenBackground}),_Object$assign))}))}},{key:"updateViewport",value:function updateViewport(){var _this$spreadsheet$too,_this$spreadsheet$for,_this$selector$select;this.updateScrollGroups(),this.drawTopLeftOffsetRect(),this.updateSheetDimensions(),this.rows.updateViewport(),this.cols.updateViewport(),this.cells.updateViewport(),this.selector.updateSelectedCells(),null===(_this$spreadsheet$too=this.spreadsheet.toolbar)||void 0===_this$spreadsheet$too||_this$spreadsheet$too.updateActiveStates(),null===(_this$spreadsheet$for=this.spreadsheet.formulaBar)||void 0===_this$spreadsheet$for||_this$spreadsheet$for.updateValue(null===(_this$selector$select=this.selector.selectedCell)||void 0===_this$selector$select?void 0:_this$selector$select.simpleCellAddress),this.updateFrozenBackgrounds()}}]),Sheet}(),Spreadsheet_module=__webpack_require__(351),Spreadsheet_module_options={insert:"head",singleton:!1},spreadsheet_Spreadsheet_module=(injectStylesIntoStyleTag_default()(Spreadsheet_module.a,Spreadsheet_module_options),Spreadsheet_module.a.locals||{});function Clipboard_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Clipboard_Clipboard=function(){function Clipboard(spreadsheet){!function Clipboard_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Clipboard),this.sourceRange=null,this.isCut=!1,this.getRange=function(sourceRange,targetRange){return targetRange.getArrayOfAddresses().map((function(arr){return arr.map((function(targetSimpleCellAddress){var height=sourceRange.height(),width=sourceRange.width(),row=((targetSimpleCellAddress.row-targetRange.topLeftSimpleCellAddress.row)%height+height)%height+sourceRange.topLeftSimpleCellAddress.row,col=((targetSimpleCellAddress.col-targetRange.topLeftSimpleCellAddress.col)%width+width)%width+sourceRange.topLeftSimpleCellAddress.col;return new cell_SimpleCellAddress(sourceRange.topLeftSimpleCellAddress.sheet,row,col)}))}))},this.spreadsheet=spreadsheet}return function Clipboard_createClass(Constructor,protoProps,staticProps){return protoProps&&Clipboard_defineProperties(Constructor.prototype,protoProps),staticProps&&Clipboard_defineProperties(Constructor,staticProps),Constructor}(Clipboard,[{key:"cut",value:function cut(){var _this$spreadsheet$hyp,cellRange=this.getCellRangeForSelection();cellRange&&(this.sourceRange=cellRange,null===(_this$spreadsheet$hyp=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp||_this$spreadsheet$hyp.cut({start:cellRange.topLeftSimpleCellAddress,end:cellRange.bottomRightSimpleCellAddress}),this.isCut=!0)}},{key:"copy",value:function copy(){var _this$spreadsheet$hyp2,cellRange=this.getCellRangeForSelection();cellRange&&(this.sourceRange=cellRange,null===(_this$spreadsheet$hyp2=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp2||_this$spreadsheet$hyp2.copy({start:cellRange.topLeftSimpleCellAddress,end:cellRange.bottomRightSimpleCellAddress}))}},{key:"paste",value:function paste(){var _this=this,targetRange=this.getCellRangeForSelection(!0);if(targetRange&&this.sourceRange){var rangeData=this.getRange(this.sourceRange,targetRange);this.spreadsheet.pushToHistory(),rangeData.forEach((function(rowData,rowIndex){rowData.forEach((function(sourceSimpleCellAddress,colIndex){var _data$cells,_this$spreadsheet$hyp3,cellId=sourceSimpleCellAddress.toCellId(),row=_this.sourceRange.topLeftSimpleCellAddress.row,col=_this.sourceRange.topLeftSimpleCellAddress.col;row+=rowIndex%_this.sourceRange.height(),col+=colIndex%_this.sourceRange.width();var targetSimpleCellAddress=new cell_SimpleCellAddress(targetRange.topLeftSimpleCellAddress.sheet,targetRange.topLeftSimpleCellAddress.row+rowIndex,targetRange.topLeftSimpleCellAddress.col+colIndex);if(_this.isCut){var simpleCellAddress=new cell_SimpleCellAddress(_this.sourceRange.topLeftSimpleCellAddress.sheet,row,col);_this.spreadsheet.data.deleteCell(simpleCellAddress)}var cell=null===(_data$cells=_this.spreadsheet.data.spreadsheetData.cells)||void 0===_data$cells?void 0:_data$cells[cellId];cell?_this.spreadsheet.data.setCell(targetSimpleCellAddress,cell):_this.spreadsheet.data.deleteCell(targetSimpleCellAddress),null===(_this$spreadsheet$hyp3=_this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp3||_this$spreadsheet$hyp3.setCellContents(targetSimpleCellAddress,null==cell?void 0:cell.value)}))})),this.spreadsheet.updateViewport(),this.isCut&&(this.sourceRange=null,this.isCut=!1)}}},{key:"getCellRangeForSelection",value:function getCellRangeForSelection(){var _this$spreadsheet$get,expandSelectionForPaste=arguments.length>0&&void 0!==arguments[0]&&arguments[0],selectedCells=null===(_this$spreadsheet$get=this.spreadsheet.getActiveSheet())||void 0===_this$spreadsheet$get?void 0:_this$spreadsheet$get.selector.selectedCells;if(Object(lodash.isEmpty)(selectedCells)||expandSelectionForPaste&&!this.sourceRange)return null;var sheet=this.spreadsheet.getActiveSheet(),firstSelectedCell=selectedCells[0],lastSelectedCell=selectedCells[selectedCells.length-1],topLeftSimpleCellAddress=new cell_SimpleCellAddress(sheet.sheetId,firstSelectedCell.simpleCellAddress.row,firstSelectedCell.simpleCellAddress.col),bottomRightSimpleCellAddress=new cell_SimpleCellAddress(sheet.sheetId,lastSelectedCell.simpleCellAddress.row,lastSelectedCell.simpleCellAddress.col);if(expandSelectionForPaste){var sourceRangeColSize=this.sourceRange.bottomRightSimpleCellAddress.col-this.sourceRange.topLeftSimpleCellAddress.col,sourceRangeRowSize=this.sourceRange.bottomRightSimpleCellAddress.row-this.sourceRange.topLeftSimpleCellAddress.row,targetRangeColSize=bottomRightSimpleCellAddress.col-topLeftSimpleCellAddress.col,targetRangeRowSize=bottomRightSimpleCellAddress.row-topLeftSimpleCellAddress.row;(this.isCut||targetRangeColSize<sourceRangeColSize)&&(bottomRightSimpleCellAddress.col=topLeftSimpleCellAddress.col+sourceRangeColSize),(this.isCut||targetRangeRowSize<sourceRangeRowSize)&&(bottomRightSimpleCellAddress.row=topLeftSimpleCellAddress.row+sourceRangeRowSize)}return new cell_RangeSimpleCellAddress(topLeftSimpleCellAddress,bottomRightSimpleCellAddress)}}]),Clipboard}(),spreadsheet_Clipboard=Clipboard_Clipboard,dist=__webpack_require__(517),dist_default=__webpack_require__.n(dist);function Data_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var sheet_Data=function(){function Data(spreadsheet,spreadsheetData){!function Data_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Data),this.spreadsheetData=void 0,this.spreadsheet=spreadsheet,this.spreadsheetData=null!=spreadsheetData?spreadsheetData:{}}return function Data_createClass(Constructor,protoProps,staticProps){return protoProps&&Data_defineProperties(Constructor.prototype,protoProps),staticProps&&Data_defineProperties(Constructor,staticProps),Constructor}(Data,[{key:"getIsCellAMergedCell",value:function getIsCellAMergedCell(simpleCellAddress){var mergedCells=this.spreadsheetData.mergedCells;return!(null==mergedCells||!mergedCells[simpleCellAddress.toCellId()])}},{key:"setSheet",value:function setSheet(sheetId,sheetData){var _this$spreadsheetData,_Object$assign;this.spreadsheetData.sheets=Object.assign({},this.spreadsheetData.sheets,((_Object$assign={})[sheetId]=Object.assign({sheetName:this.spreadsheet.getSheetName()},null===(_this$spreadsheetData=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData?void 0:_this$spreadsheetData[sheetId],sheetData,{id:sheetId}),_Object$assign))}},{key:"deleteSheet",value:function deleteSheet(sheetId){var _this$spreadsheetData2,_this$spreadsheet$hyp,_this$spreadsheetData3,sheet=null===(_this$spreadsheetData2=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData2?void 0:_this$spreadsheetData2[sheetId];for(var key in null===(_this$spreadsheet$hyp=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp||_this$spreadsheet$hyp.removeSheet(sheetId),this.deleteFrozenCell(sheetId),null==sheet?void 0:sheet.cells){var cellId=key;this.deleteCell(cell_SimpleCellAddress.cellIdToAddress(cellId))}for(var _key in null==sheet?void 0:sheet.mergedCells){var _cellId=_key;this.deleteMergedCell(cell_SimpleCellAddress.cellIdToAddress(_cellId))}for(var _key2 in null==sheet?void 0:sheet.cols){var sheetRowColId=_key2,sheetRowColAddress=cell_RowColAddress.sheetRowColIdToAddress(sheetRowColId);this.deleteRowCol("cols",sheetRowColAddress)}for(var _key3 in null==sheet?void 0:sheet.rows){var _sheetRowColId=_key3,_sheetRowColAddress=cell_RowColAddress.sheetRowColIdToAddress(_sheetRowColId);this.deleteRowCol("rows",_sheetRowColAddress)}null===(_this$spreadsheetData3=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData3||delete _this$spreadsheetData3[sheetId]}},{key:"setCell",value:function setCell(simpleCellAddress,cell){var _this$spreadsheetData4,_Object$assign2,_this$spreadsheetData5,_Object$assign3,sheetId=simpleCellAddress.sheet,cellId=simpleCellAddress.toCellId();this.setSheet(sheetId,{cells:Object.assign({},null===(_this$spreadsheetData4=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData4?void 0:_this$spreadsheetData4[sheetId].cells,(_Object$assign2={},_Object$assign2[cellId]=cellId,_Object$assign2))}),this.spreadsheetData.cells=Object.assign({},this.spreadsheetData.cells,((_Object$assign3={})[cellId]=Object.assign({},null===(_this$spreadsheetData5=this.spreadsheetData.cells)||void 0===_this$spreadsheetData5?void 0:_this$spreadsheetData5[cellId],cell,{id:cellId}),_Object$assign3));try{var _this$spreadsheet$hyp2,_this$spreadsheet$hyp3,_this$spreadsheetData6;if(null!==(_this$spreadsheet$hyp2=this.spreadsheet.hyperformula)&&void 0!==_this$spreadsheet$hyp2&&_this$spreadsheet$hyp2.isItPossibleToSetCellContents(simpleCellAddress))null===(_this$spreadsheet$hyp3=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp3||_this$spreadsheet$hyp3.setCellContents(simpleCellAddress,null===(_this$spreadsheetData6=this.spreadsheetData.cells[cellId])||void 0===_this$spreadsheetData6?void 0:_this$spreadsheetData6.value)}catch(e){console.error(e)}}},{key:"deleteCell",value:function deleteCell(simpleCellAddress){var _this$spreadsheet$hyp4,_this$spreadsheetData7,_this$spreadsheetData8,_this$spreadsheetData9,_this$spreadsheetData10,_this$spreadsheet$hyp5,sheetId=simpleCellAddress.sheet,cellId=simpleCellAddress.toCellId();null!==(_this$spreadsheet$hyp4=this.spreadsheet.hyperformula)&&void 0!==_this$spreadsheet$hyp4&&_this$spreadsheet$hyp4.isItPossibleToSetCellContents(simpleCellAddress)&&(null===(_this$spreadsheet$hyp5=this.spreadsheet.hyperformula)||void 0===_this$spreadsheet$hyp5||_this$spreadsheet$hyp5.setCellContents(simpleCellAddress,void 0));null===(_this$spreadsheetData7=this.spreadsheetData.cells)||void 0===_this$spreadsheetData7||delete _this$spreadsheetData7[cellId],null===(_this$spreadsheetData8=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData8||(null===(_this$spreadsheetData9=_this$spreadsheetData8[sheetId])||void 0===_this$spreadsheetData9||(null===(_this$spreadsheetData10=_this$spreadsheetData9.cells)||void 0===_this$spreadsheetData10||delete _this$spreadsheetData10[cellId]))}},{key:"setMergedCell",value:function setMergedCell(simpleCellAddress,mergedCell){var _this$spreadsheetData11,_Object$assign4,_merge,sheetId=simpleCellAddress.sheet,mergedCellId=simpleCellAddress.toCellId();this.setSheet(sheetId,{mergedCells:Object.assign({},null===(_this$spreadsheetData11=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData11?void 0:_this$spreadsheetData11[sheetId].mergedCells,(_Object$assign4={},_Object$assign4[mergedCellId]=mergedCellId,_Object$assign4))}),this.spreadsheetData.mergedCells=Object(lodash.merge)({},this.spreadsheetData.mergedCells,((_merge={})[mergedCellId]=Object.assign({},mergedCell,{id:mergedCellId}),_merge))}},{key:"deleteMergedCell",value:function deleteMergedCell(simpleCellAddress){var _this$spreadsheetData12,_this$spreadsheetData13,_this$spreadsheetData14,sheetId=simpleCellAddress.sheet,mergedCellId=simpleCellAddress.toCellId();null===(_this$spreadsheetData12=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData12||(null===(_this$spreadsheetData13=_this$spreadsheetData12[sheetId].mergedCells)||void 0===_this$spreadsheetData13||delete _this$spreadsheetData13[mergedCellId]),null===(_this$spreadsheetData14=this.spreadsheetData.mergedCells)||void 0===_this$spreadsheetData14||delete _this$spreadsheetData14[mergedCellId]}},{key:"setFrozenCell",value:function setFrozenCell(sheetId,frozenCell){var _this$spreadsheetData15,_Object$assign5,_this$spreadsheetData16;this.setSheet(sheetId,{frozenCell:sheetId}),this.spreadsheetData.frozenCells=Object.assign({},this.spreadsheetData.frozenCells,((_Object$assign5={})[sheetId]=Object.assign({},null===(_this$spreadsheetData15=this.spreadsheetData.frozenCells)||void 0===_this$spreadsheetData15?void 0:_this$spreadsheetData15[sheetId],frozenCell,{id:sheetId}),_Object$assign5));var frozenCells=null===(_this$spreadsheetData16=this.spreadsheetData.frozenCells)||void 0===_this$spreadsheetData16?void 0:_this$spreadsheetData16[sheetId];!Object(lodash.isNil)(null==frozenCells?void 0:frozenCells.col)&&(null==frozenCells?void 0:frozenCells.col)<0&&(null==frozenCells||delete frozenCells.col),!Object(lodash.isNil)(null==frozenCells?void 0:frozenCells.row)&&(null==frozenCells?void 0:frozenCells.row)<0&&(null==frozenCells||delete frozenCells.row),Object(lodash.isNil)(null==frozenCells?void 0:frozenCells.col)&&Object(lodash.isNil)(null==frozenCells?void 0:frozenCells.row)&&this.deleteFrozenCell(sheetId)}},{key:"deleteFrozenCell",value:function deleteFrozenCell(sheetId){var _this$spreadsheetData17,_this$spreadsheetData18;null===(_this$spreadsheetData17=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData17||delete _this$spreadsheetData17[sheetId].frozenCell,null===(_this$spreadsheetData18=this.spreadsheetData.frozenCells)||void 0===_this$spreadsheetData18||delete _this$spreadsheetData18[sheetId]}},{key:"setRowCol",value:function setRowCol(pluralType,rowColAddress,rowColData){var _this$spreadsheetData19,_this$spreadsheetData20,_Object$assign6,_this$setSheet,_this$spreadsheetData21,_Object$assign7,sheetId=rowColAddress.sheet,sheetRowColId=rowColAddress.toSheetRowColId();this.setSheet(sheetId,((_this$setSheet={})[pluralType]=Object.assign({},null===(_this$spreadsheetData19=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData19||null===(_this$spreadsheetData20=_this$spreadsheetData19[sheetId])||void 0===_this$spreadsheetData20?void 0:_this$spreadsheetData20[pluralType],((_Object$assign6={})[sheetRowColId]=sheetRowColId,_Object$assign6)),_this$setSheet)),this.spreadsheetData[pluralType]=Object.assign({},this.spreadsheetData[pluralType],((_Object$assign7={})[sheetRowColId]=Object.assign({},null===(_this$spreadsheetData21=this.spreadsheetData[pluralType])||void 0===_this$spreadsheetData21?void 0:_this$spreadsheetData21[sheetRowColId],rowColData,{id:sheetRowColId}),_Object$assign7))}},{key:"deleteRowCol",value:function deleteRowCol(pluralType,rowColAddress){var _this$spreadsheetData22,_this$spreadsheetData23,_this$spreadsheetData24,_this$spreadsheetData25,_this$spreadsheetData26,sheetId=rowColAddress.sheet,sheetRowColId=rowColAddress.toSheetRowColId();null===(_this$spreadsheetData22=this.spreadsheetData.sheets)||void 0===_this$spreadsheetData22||(null===(_this$spreadsheetData23=_this$spreadsheetData22[sheetId])||void 0===_this$spreadsheetData23||(null===(_this$spreadsheetData24=_this$spreadsheetData23[pluralType])||void 0===_this$spreadsheetData24||delete _this$spreadsheetData24[sheetRowColId])),null===(_this$spreadsheetData25=this.spreadsheetData)||void 0===_this$spreadsheetData25||(null===(_this$spreadsheetData26=_this$spreadsheetData25[pluralType])||void 0===_this$spreadsheetData26||delete _this$spreadsheetData26[sheetRowColId])}}]),Data}();function Spreadsheet_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var spreadsheet_Spreadsheet=function(){function Spreadsheet(params){var _this$toolbar,_this$formulaBar,_this$exporter,_this$bottomBar,_this=this;!function Spreadsheet_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Spreadsheet),this.spreadsheetEl=void 0,this.sheetsEl=void 0,this.sheets=void 0,this.styles=void 0,this.eventEmitter=void 0,this.options=void 0,this.data=void 0,this.toolbar=void 0,this.formulaBar=void 0,this.exporter=void 0,this.hyperformula=void 0,this.clipboard=void 0,this.history=void 0,this.bottomBar=void 0,this.activeSheetId=0,this.totalSheetCount=0,this.isSaving=!1,this.onDOMContentLoaded=function(){for(var key in _this.data.spreadsheetData.sheets){var sheetId=parseInt(key,10),sheet=_this.data.spreadsheetData.sheets[sheetId];_this.createNewSheet(sheet)}_this.setCells(),_this.switchSheet(0),_this.updateViewport()},this.data=new sheet_Data(this,params.data),this.hyperformula=params.hyperformula,this.eventEmitter=params.eventEmitter,this.options=Object(lodash.merge)({},defaultOptions,params.options),this.styles=Object(lodash.merge)({},defaultStyles,params.styles),this.toolbar=params.toolbar,this.formulaBar=params.formulaBar,this.bottomBar=params.bottomBar,this.exporter=params.exporter,this.sheets=new Map,this.spreadsheetEl=document.createElement("div"),this.spreadsheetEl.classList.add(prefix+"-spreadsheet",spreadsheet_Spreadsheet_module.spreadsheet),Object(lodash.isNil)(this.options.width)||(this.spreadsheetEl.style.width=this.options.width+"px"),Object(lodash.isNil)(this.options.height)||(this.spreadsheetEl.style.height=this.options.height+"px"),this.sheetsEl=document.createElement("div"),this.sheetsEl.classList.add(spreadsheet_Spreadsheet_module.sheets,prefix+"-sheets"),this.spreadsheetEl.appendChild(this.sheetsEl),null===(_this$toolbar=this.toolbar)||void 0===_this$toolbar||_this$toolbar.initialize(this),null===(_this$formulaBar=this.formulaBar)||void 0===_this$formulaBar||_this$formulaBar.initialize(this),null===(_this$exporter=this.exporter)||void 0===_this$exporter||_this$exporter.initialize(this),null===(_this$bottomBar=this.bottomBar)||void 0===_this$bottomBar||_this$bottomBar.initialize(this),this.clipboard=new spreadsheet_Clipboard(this),this.history=new dist_default.a((function(data){var currentData=_this.data.spreadsheetData;return _this.data.spreadsheetData=JSON.parse(data),_this.setCells(),JSON.stringify(currentData)}),this.options.undoRedoLimit),this.data.setSheet(0),window.addEventListener("DOMContentLoaded",this.onDOMContentLoaded,{once:!0})}return function Spreadsheet_createClass(Constructor,protoProps,staticProps){return protoProps&&Spreadsheet_defineProperties(Constructor.prototype,protoProps),staticProps&&Spreadsheet_defineProperties(Constructor,staticProps),Constructor}(Spreadsheet,[{key:"destroy",value:function destroy(){window.removeEventListener("DOMContentLoaded",this.onDOMContentLoaded)}},{key:"setCells",value:function setCells(){var _this$hyperformula,_this2=this;null===(_this$hyperformula=this.hyperformula)||void 0===_this$hyperformula||_this$hyperformula.batch((function(){for(var key in _this2.data.spreadsheetData.cells){var _this2$data$spreadshe,_this2$hyperformula,cellId=key,cell=null===(_this2$data$spreadshe=_this2.data.spreadsheetData.cells)||void 0===_this2$data$spreadshe?void 0:_this2$data$spreadshe[cellId];null===(_this2$hyperformula=_this2.hyperformula)||void 0===_this2$hyperformula||_this2$hyperformula.setCellContents(cell_SimpleCellAddress.cellIdToAddress(cellId),null==cell?void 0:cell.value)}}))}},{key:"getRegisteredFunctions",value:function getRegisteredFunctions(){return null==HyperFormula?void 0:HyperFormula.default.getRegisteredFunctionNames("enGB")}},{key:"setOptions",value:function setOptions(options){this.options=options,this.updateViewport()}},{key:"pushToHistory",value:function pushToHistory(){var data=JSON.stringify(this.data.spreadsheetData);this.history.push(data),this.persistData(),this.eventEmitter.emit(spreadsheet_events.history.push,this.data.spreadsheetData)}},{key:"persistData",value:function persistData(){var _this3=this;this.isSaving=!0,this.eventEmitter.emit(spreadsheet_events.persist.save,this.data.spreadsheetData,(function done(){_this3.isSaving=!1,_this3.updateViewport()}))}},{key:"undo",value:function undo(){this.history.canUndo&&(this.history.undo(),this.persistData(),this.updateViewport())}},{key:"redo",value:function redo(){this.history.canRedo&&(this.history.redo(),this.persistData(),this.updateViewport())}},{key:"getSheetName",value:function getSheetName(){return"Sheet"+(this.totalSheetCount+1)}},{key:"getActiveSheet",value:function getActiveSheet(){return this.sheets.get(this.activeSheetId)}},{key:"updateViewport",value:function updateViewport(){var _this$bottomBar2,_this4=this;null===(_this$bottomBar2=this.bottomBar)||void 0===_this$bottomBar2||_this$bottomBar2.updateSheetTabs(),this.sheets.forEach((function(sheet){sheet.sheetId===_this4.activeSheetId?(sheet.show(),sheet.updateViewport()):sheet.hide()}))}},{key:"deleteSheet",value:function deleteSheet(sheetId){var sheet=this.sheets.get(sheetId);if(this.activeSheetId===sheetId){var sheetIds=Array.from(this.sheets.keys()),currentIndex=sheetIds.indexOf(sheetId);0===currentIndex?this.switchSheet(sheetIds[1]):this.switchSheet(sheetIds[currentIndex-1])}sheet.destroy(),this.data.deleteSheet(sheetId),this.sheets.delete(sheetId),this.updateViewport()}},{key:"switchSheet",value:function switchSheet(sheetId){this.activeSheetId=sheetId,this.updateViewport()}},{key:"renameSheet",value:function renameSheet(sheetId,sheetName){var _this$hyperformula2;this.data.setSheet(sheetId,{sheetName:sheetName}),null===(_this$hyperformula2=this.hyperformula)||void 0===_this$hyperformula2||_this$hyperformula2.renameSheet(sheetId,sheetName),this.updateViewport()}},{key:"createNewSheet",value:function createNewSheet(data){var _this$hyperformula3;this.data.setSheet(data.id,data),null===(_this$hyperformula3=this.hyperformula)||void 0===_this$hyperformula3||_this$hyperformula3.addSheet(data.sheetName);var sheet=new sheet_Sheet(this,data.id);this.sheets.set(data.id,sheet),this.totalSheetCount++,this.updateViewport()}}]),Spreadsheet}(),es=__webpack_require__(340),currency_symbol_map=__webpack_require__(518),Toolbar_module=__webpack_require__(352),Toolbar_module_options={insert:"head",singleton:!1},toolbar_Toolbar_module=(injectStylesIntoStyleTag_default()(Toolbar_module.a,Toolbar_module_options),Toolbar_module.a.locals||{}),acolorpicker=__webpack_require__(519),toolbarPrefix=prefix+"-toolbar",toggleIconNames=["undo","redo","bold","italic","fontColor","underline","strikeThrough","backgroundColor","merge","horizontalTextAlign","verticalTextAlign","textWrap","functions","freeze","ellipsis","borders","export","formula"],fontSizeArray=[6,7,8,9,10,11,12,14,18,24,36],toolbarHtmlElementHelpers_createToolbarIconButton=function createToolbarIconButton(name){return htmlElementHelpers_createIconButton(name,toolbarPrefix)},toolbarHtmlElementHelpers_createTextFormatContent=function createTextFormatContent(textFormatMap){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix,toolbar_Toolbar_module.textFormats),textFormats={};return Object.keys(textFormatMap).forEach((function(key){var textFormatButton=function createTextFormatButton(textFormat){var textFormatButton=document.createElement("button");return textFormatButton.textContent=Object(dist_es2015.a)(textFormat),textFormatButton.classList.add(toolbarPrefix+"-format",toolbar_Toolbar_module.textFormatButton,textFormat),textFormatButton}(key);textFormats[key]=textFormatButton,dropdownContent.appendChild(textFormatButton)})),{dropdownContent:dropdownContent,textFormats:textFormats}},toolbarHtmlElementHelpers_createFontSizeContent=function createFontSizeContent(){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix,toolbar_Toolbar_module.fontSizes),fontSizes={};return fontSizeArray.forEach((function(fontSize){var fontSizeButton=function createFontSizeButton(fontSize){var fontSizeButton=document.createElement("button");return fontSizeButton.textContent=fontSize.toString(),fontSizeButton.classList.add(toolbarPrefix+"-font-size",toolbar_Toolbar_module.fontSizeButton,fontSize.toString()),fontSizeButton}(fontSize);fontSizes[fontSize]=fontSizeButton,dropdownContent.appendChild(fontSizeButton)})),{dropdownContent:dropdownContent,fontSizes:fontSizes}};function Toolbar_toConsumableArray(arr){return function Toolbar_arrayWithoutHoles(arr){if(Array.isArray(arr))return Toolbar_arrayLikeToArray(arr)}(arr)||function Toolbar_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function Toolbar_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Toolbar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Toolbar_arrayLikeToArray(o,minLen)}(arr)||function Toolbar_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Toolbar_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Toolbar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Toolbar_Toolbar=function(){function Toolbar(){var _this=this;!function Toolbar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Toolbar),this.toolbarEl=void 0,this.iconElementsMap=void 0,this.buttonElementsMap=void 0,this.dropdownMap=void 0,this.colorPickerElementsMap=void 0,this.borderElements=void 0,this.fontSizeElements=void 0,this.textFormatElements=void 0,this.textFormatMap=void 0,this.functionElements=void 0,this.autosaveElement=void 0,this.toolbarActionGroups=void 0,this.tooltip=void 0,this.dropdown=void 0,this.spreadsheet=void 0,this.setValue=function(name,value){var sheet=_this.spreadsheet.getActiveSheet();function setStyle(key,value){sheet.spreadsheet.pushToHistory(),sheet.selector.selectedCells.forEach((function(cell){var _sheet$spreadsheet$da;sheet.spreadsheet.data.setCell(cell.simpleCellAddress,((_sheet$spreadsheet$da={})[key]=value,_sheet$spreadsheet$da))}))}function deleteStyle(key){sheet.spreadsheet.pushToHistory(),sheet.selector.selectedCells.forEach((function(cell){var _sheet$spreadsheet$da2,cellId=cell.simpleCellAddress.toCellId();null===(_sheet$spreadsheet$da2=sheet.spreadsheet.data.spreadsheetData.cells)||void 0===_sheet$spreadsheet$da2||delete _sheet$spreadsheet$da2[cellId][key]}))}switch(name){case"functions":_this.setFunction(value);break;case"formula":sheet.spreadsheet.pushToHistory(),_this.spreadsheet.data.spreadsheetData.showFormulas=!_this.spreadsheet.data.spreadsheetData.showFormulas;break;case"alignLeft":setStyle("horizontalTextAlign","left");break;case"alignCenter":setStyle("horizontalTextAlign","center");break;case"alignRight":setStyle("horizontalTextAlign","right");break;case"alignTop":setStyle("verticalTextAlign","top");break;case"alignMiddle":setStyle("verticalTextAlign","middle");break;case"alignBottom":setStyle("verticalTextAlign","bottom");break;case"fontSize":setStyle("fontSize",value);break;case"textWrap":_this.iconElementsMap.textWrap.active?deleteStyle("textWrap"):setStyle("textWrap","wrap");break;case"textFormatPattern":var format=value;setStyle("textFormatPattern",_this.textFormatMap[format]);break;case"backgroundColor":if(!value)break;setStyle("backgroundColor",value);break;case"fontColor":if(!value)break;setStyle("fontColor",value);break;case"bold":_this.iconElementsMap.bold.active?deleteStyle("bold"):setStyle("bold",!0);break;case"italic":_this.iconElementsMap.italic.active?deleteStyle("italic"):setStyle("italic",!0);break;case"strikeThrough":_this.iconElementsMap.strikeThrough.active?deleteStyle("strikeThrough"):setStyle("strikeThrough",!0);break;case"underline":_this.iconElementsMap.underline.active?deleteStyle("underline"):setStyle("underline",!0);break;case"merge":_this.iconElementsMap.merge.active?sheet.merger.unMergeSelectedCells():_this.iconElementsMap.merge.button.disabled||sheet.merger.mergeSelectedCells();break;case"freeze":if(sheet.spreadsheet.pushToHistory(),_this.iconElementsMap.freeze.active)_this.spreadsheet.data.deleteFrozenCell(sheet.sheetId);else{var simpleCellAddress=sheet.selector.selectedCell.simpleCellAddress;_this.spreadsheet.data.setFrozenCell(simpleCellAddress.sheet,{row:simpleCellAddress.row,col:simpleCellAddress.col})}break;case"export":var _this$spreadsheet$exp;null===(_this$spreadsheet$exp=_this.spreadsheet.exporter)||void 0===_this$spreadsheet$exp||_this$spreadsheet$exp.exportWorkbook();break;case"borderBottom":_this.spreadsheet.pushToHistory(),_this.setBottomBorders(sheet.selector.selectedCells);break;case"borderRight":_this.spreadsheet.pushToHistory(),_this.setRightBorders(sheet.selector.selectedCells);break;case"borderTop":_this.spreadsheet.pushToHistory(),_this.setTopBorders(sheet.selector.selectedCells);break;case"borderLeft":_this.spreadsheet.pushToHistory(),_this.setLeftBorders(sheet.selector.selectedCells);break;case"borderVertical":_this.spreadsheet.pushToHistory(),_this.setVerticalBorders(sheet.selector.selectedCells);break;case"borderHorizontal":_this.spreadsheet.pushToHistory(),_this.setHorizontalBorders(sheet.selector.selectedCells);break;case"borderInside":_this.spreadsheet.pushToHistory(),_this.setInsideBorders(sheet.selector.selectedCells);break;case"borderOutside":_this.spreadsheet.pushToHistory(),_this.setOutsideBorders(sheet.selector.selectedCells);break;case"borderAll":_this.spreadsheet.pushToHistory(),_this.setAllBorders(sheet.selector.selectedCells);break;case"borderNone":_this.spreadsheet.pushToHistory(),_this.clearBorders(sheet.selector.selectedCells.map((function(cell){return cell.simpleCellAddress})));break;case"undo":_this.spreadsheet.undo();break;case"redo":_this.spreadsheet.redo()}_this.spreadsheet.updateViewport()},this.updateActiveStates=function(){var _this$spreadsheet$dat,sheet=_this.spreadsheet.getActiveSheet();if(sheet){var selectedCells=sheet.selector.selectedCells,selectedCell=sheet.selector.selectedCell;_this.setActiveColor(selectedCell,"backgroundColor"),_this.setActiveColor(selectedCell,"fontColor"),_this.setActive(_this.iconElementsMap.freeze,_this.isFreezeActive(sheet.sheetId)),_this.setActive(_this.iconElementsMap.textWrap,_this.isActive(selectedCell,"textWrap")),_this.setActive(_this.iconElementsMap.bold,_this.isActive(selectedCell,"bold")),_this.setActive(_this.iconElementsMap.italic,_this.isActive(selectedCell,"italic")),_this.setActive(_this.iconElementsMap.strikeThrough,_this.isActive(selectedCell,"strikeThrough")),_this.setActive(_this.iconElementsMap.underline,_this.isActive(selectedCell,"underline")),_this.setActive(_this.iconElementsMap.formula,null!==(_this$spreadsheet$dat=_this.spreadsheet.data.spreadsheetData.showFormulas)&&void 0!==_this$spreadsheet$dat&&_this$spreadsheet$dat),_this.setActiveHorizontalIcon(selectedCell),_this.setActiveVerticalIcon(selectedCell),_this.setActiveFontSize(selectedCell),_this.setActiveTextFormat(selectedCell),_this.setActiveMergedCells(selectedCells,selectedCell),_this.setActiveHistoryIcons(_this.spreadsheet.history),_this.setActiveSaveState()}}}return function Toolbar_createClass(Constructor,protoProps,staticProps){return protoProps&&Toolbar_defineProperties(Constructor.prototype,protoProps),staticProps&&Toolbar_defineProperties(Constructor,staticProps),Constructor}(Toolbar,[{key:"initialize",value:function initialize(spreadsheet){var _this$dropdownMap$fun,_this2=this;this.spreadsheet=spreadsheet,this.toolbarEl=document.createElement("div"),this.toolbarEl.classList.add(toolbar_Toolbar_module.toolbar,toolbarPrefix),this.iconElementsMap={},this.dropdownMap={},this.colorPickerElementsMap={},this.borderElements={},this.textFormatElements={},this.textFormatMap={plainText:"",number:"#,##0.00",percent:"0.00%"},this.functionElements={},this.buttonElementsMap={};var _createFontSizeConten=toolbarHtmlElementHelpers_createFontSizeContent(),fontSizeDropdownContent=_createFontSizeConten.dropdownContent,fontSizes=_createFontSizeConten.fontSizes,_createTextFormatCont=toolbarHtmlElementHelpers_createTextFormatContent(this.textFormatMap),textFormatDropdownContent=_createTextFormatCont.dropdownContent,textFormats=_createTextFormatCont.textFormats;this.setDropdownButtonContent("fontSize",fontSizeDropdownContent,!0),this.setDropdownButtonContent("textFormatPattern",textFormatDropdownContent,!0);var _createAutosave=function createAutosave(){var iconButton=htmlElementHelpers_createIconButton("autosave",toolbarPrefix),autosave=Object.assign({},iconButton,{tooltip:htmlElementHelpers_createTooltip("autosave",toolbarPrefix)}),text=document.createElement("div");return text.classList.add(toolbar_Toolbar_module.autosaveText,toolbarPrefix+"-autosave-text"),autosave.button.appendChild(text),autosave.button.appendChild(autosave.tooltip),{autosave:autosave,text:text}}(),text=_createAutosave.text,autosave=_createAutosave.autosave;this.iconElementsMap.autosave=autosave,this.autosaveElement={text:text},this.fontSizeElements={fontSizes:fontSizes},this.textFormatElements={textFormats:textFormats},toggleIconNames.forEach((function(name){switch(name){case"backgroundColor":_this2.setDropdownColorPicker(name),_this2.colorPickerElementsMap.backgroundColor.picker.on("change",(function(_,color){_this2.setValue(name,color)}));break;case"fontColor":_this2.setDropdownColorPicker(name),_this2.colorPickerElementsMap.fontColor.picker.on("change",(function(_,fontColor){_this2.setValue(name,fontColor)}));break;case"borders":var _createBordersContent=function createBordersContent(){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix,toolbar_Toolbar_module.borders),firstBordersRow={borderAll:toolbarHtmlElementHelpers_createToolbarIconButton("borderAll"),borderInside:toolbarHtmlElementHelpers_createToolbarIconButton("borderInside"),borderHorizontal:toolbarHtmlElementHelpers_createToolbarIconButton("borderHorizontal"),borderVertical:toolbarHtmlElementHelpers_createToolbarIconButton("borderVertical"),borderOutside:toolbarHtmlElementHelpers_createToolbarIconButton("borderOutside")},secondBordersRow={borderLeft:toolbarHtmlElementHelpers_createToolbarIconButton("borderLeft"),borderTop:toolbarHtmlElementHelpers_createToolbarIconButton("borderTop"),borderRight:toolbarHtmlElementHelpers_createToolbarIconButton("borderRight"),borderBottom:toolbarHtmlElementHelpers_createToolbarIconButton("borderBottom"),borderNone:toolbarHtmlElementHelpers_createToolbarIconButton("borderNone")},borderGroups=[document.createElement("div"),document.createElement("div")];return Object.values(firstBordersRow).forEach((function(border){borderGroups[0].appendChild(border.buttonContainer)})),Object.values(secondBordersRow).forEach((function(border){borderGroups[1].appendChild(border.buttonContainer)})),borderGroups.forEach((function(borderGroup){borderGroup.classList.add(toolbar_Toolbar_module.bordersGroup,toolbarPrefix+"-borders-group"),dropdownContent.appendChild(borderGroup)})),{dropdownContent:dropdownContent,borderGroups:borderGroups,firstBordersRow:firstBordersRow,secondBordersRow:secondBordersRow}}(),dropdownContent=_createBordersContent.dropdownContent,borderGroups=_createBordersContent.borderGroups,firstBordersRow=_createBordersContent.firstBordersRow,secondBordersRow=_createBordersContent.secondBordersRow;_this2.setDropdownIconContent(name,dropdownContent,!0),_this2.borderElements={borderGroups:borderGroups};var setBorders=function setBorders(bordersRow){Object.keys(bordersRow).forEach((function(key){var name=key,value=bordersRow[key];_this2.iconElementsMap[name]=value}))};setBorders(firstBordersRow),setBorders(secondBordersRow);break;case"horizontalTextAlign":var _createHorizontalText=function createHorizontalTextAlignContent(){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix),aligns={alignLeft:toolbarHtmlElementHelpers_createToolbarIconButton("alignLeft"),alignCenter:toolbarHtmlElementHelpers_createToolbarIconButton("alignCenter"),alignRight:toolbarHtmlElementHelpers_createToolbarIconButton("alignRight")};return Object.values(aligns).forEach((function(align){dropdownContent.appendChild(align.buttonContainer)})),{dropdownContent:dropdownContent,aligns:aligns}}(),_dropdownContent=_createHorizontalText.dropdownContent,aligns=_createHorizontalText.aligns;_this2.setDropdownIconContent(name,_dropdownContent,!0),Object.keys(aligns).forEach((function(key){var name=key,value=aligns[name];_this2.iconElementsMap[name]=value}));break;case"verticalTextAlign":var _createVerticalTextAl=function createVerticalTextAlignContent(){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix),aligns={alignTop:toolbarHtmlElementHelpers_createToolbarIconButton("alignTop"),alignMiddle:toolbarHtmlElementHelpers_createToolbarIconButton("alignMiddle"),alignBottom:toolbarHtmlElementHelpers_createToolbarIconButton("alignBottom")};return Object.values(aligns).forEach((function(align){dropdownContent.appendChild(align.buttonContainer)})),{dropdownContent:dropdownContent,aligns:aligns}}(),_dropdownContent2=_createVerticalTextAl.dropdownContent,_aligns=_createVerticalTextAl.aligns;_this2.setDropdownIconContent(name,_dropdownContent2,!0),Object.keys(_aligns).forEach((function(key){var name=key,value=_aligns[name];_this2.iconElementsMap[name]=value}));break;case"functions":if(HyperFormula){var _createFunctionDropdo=function createFunctionDropdownContent(registeredFunctionNames){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix,toolbar_Toolbar_module.functions),registeredFunctionButtons=registeredFunctionNames.map((function(functionName){var button=document.createElement("button");return button.classList.add(toolbar_Toolbar_module.functionNameButton),button.textContent=functionName,button.dataset.function=functionName,dropdownContent.appendChild(button),button}));return{dropdownContent:dropdownContent,registeredFunctionButtons:registeredFunctionButtons}}(_this2.spreadsheet.getRegisteredFunctions().sort((function(a,b){return a.localeCompare(b)}))),_dropdownContent3=_createFunctionDropdo.dropdownContent,registeredFunctionButtons=_createFunctionDropdo.registeredFunctionButtons;_this2.setDropdownIconContent(name,_dropdownContent3,!0),_this2.functionElements={registeredFunctionButtons:registeredFunctionButtons}}break;default:var iconElements=htmlElementHelpers_createIconButton(name,toolbarPrefix),tooltip=htmlElementHelpers_createTooltip(name,toolbarPrefix);iconElements.button.appendChild(tooltip),_this2.iconElementsMap[name]=Object.assign({},iconElements,{tooltip:tooltip})}})),this.tooltip=Object(tippy_esm.b)(this.toolbarEl,{target:"."+toolbarPrefix+"-tooltip",touch:!1,delay:300});var setDropdownActive=function setDropdownActive(element,active){var _this2$buttonElements,name=element.dataset.name,actionElements=null!==(_this2$buttonElements=_this2.buttonElementsMap[name])&&void 0!==_this2$buttonElements?_this2$buttonElements:_this2.iconElementsMap[name];_this2.setActive(actionElements,active)};this.dropdown=Object(tippy_esm.b)(this.toolbarEl,{target:"."+toolbarPrefix+"-dropdown-button",trigger:"click",theme:"dropdown",placement:"auto",interactive:!0,arrow:!1,onHide:function onHide(_ref){var reference=_ref.reference;setDropdownActive(reference,!1),_this2.spreadsheet.updateViewport()},onShow:function onShow(_ref2){var reference=_ref2.reference;setDropdownActive(reference,!0)},content:function content(e){var name=e.dataset.name;return name?(setDropdownActive(e,!0),_this2.dropdownMap[name].dropdownContent):""}});var icons=this.iconElementsMap;this.toolbarActionGroups=[{elements:[icons.undo.buttonContainer,icons.redo.buttonContainer]},{elements:[this.buttonElementsMap.textFormatPattern.buttonContainer]},{elements:[this.buttonElementsMap.fontSize.buttonContainer]},{elements:[icons.bold.buttonContainer,icons.italic.buttonContainer,icons.underline.buttonContainer,icons.strikeThrough.buttonContainer,icons.fontColor.buttonContainer]},{elements:[icons.backgroundColor.buttonContainer,icons.borders.buttonContainer,icons.merge.buttonContainer]},{elements:[icons.horizontalTextAlign.buttonContainer,icons.verticalTextAlign.buttonContainer,icons.textWrap.buttonContainer]},{elements:[icons.freeze.buttonContainer].concat(Toolbar_toConsumableArray(this.spreadsheet.hyperformula?[icons.functions.buttonContainer]:[]),[icons.formula.buttonContainer])},{elements:[icons.export.buttonContainer]},{elements:[icons.autosave.buttonContainer]}],this.toolbarActionGroups.forEach((function(_ref3){var elements=_ref3.elements,group=createGroup(elements,toolbar_Toolbar_module.group,toolbarPrefix);_this2.toolbarEl.appendChild(group)})),Object.keys(this.iconElementsMap).forEach((function(key){var name=key;_this2.dropdownMap[key]||_this2.iconElementsMap[name].button.addEventListener("click",(function(){_this2.setValue(name)}))})),Object.keys(this.fontSizeElements.fontSizes).forEach((function(key){var fontSize=parseInt(key,10);_this2.fontSizeElements.fontSizes[fontSize].addEventListener("click",(function(){_this2.setValue("fontSize",fontSize)}))})),Object.keys(this.textFormatElements.textFormats).forEach((function(key){_this2.textFormatElements.textFormats[key].addEventListener("click",(function(){_this2.setValue("textFormatPattern",key)}))})),null===(_this$dropdownMap$fun=this.dropdownMap.functions)||void 0===_this$dropdownMap$fun||_this$dropdownMap$fun.dropdownContent.addEventListener("click",(function(e){var target=e.target;if(null!=target&&target.matches("button")){var functionName=target.dataset.function;_this2.setValue("functions",functionName)}}))}},{key:"setFunction",value:function setFunction(functionName){var sheet=this.spreadsheet.getActiveSheet();if(sheet.selector.selectedCells.length>1){var _rangeSimpleCellAddress=sheet.getMinMaxRangeSimpleCellAddress(sheet.selector.selectedCells);_rangeSimpleCellAddress.bottomRightSimpleCellAddress.row+=1;var _cell=new cell_Cell(sheet,new cell_SimpleCellAddress(sheet.sheetId,_rangeSimpleCellAddress.bottomRightSimpleCellAddress.row,_rangeSimpleCellAddress.topLeftSimpleCellAddress.col)),topLeftString=_rangeSimpleCellAddress.topLeftSimpleCellAddress.addressToString(),bottomRightString=_rangeSimpleCellAddress.bottomRightSimpleCellAddress.addressToString(),viewportVector=sheet.getViewportVector();_cell.group.x(_cell.group.x()+viewportVector.x),_cell.group.y(_cell.group.y()+viewportVector.y),sheet.cellEditor.show(_cell),sheet.cellEditor.setTextContent("="+functionName+"("+topLeftString+":"+bottomRightString+")")}else{var selectedCell=sheet.selector.selectedCell;sheet.cellEditor.show(selectedCell),sheet.cellEditor.setTextContent("="+functionName+"()")}}},{key:"setBorderStyles",value:function setBorderStyles(cells,cellsFilter,borderType){var _this3=this,sheet=this.spreadsheet.getActiveSheet();cells.filter((function(cell){return cellsFilter(cell,sheet.getMinMaxRangeSimpleCellAddress(cells))})).forEach((function(cell){var _this3$spreadsheet$da,_this3$spreadsheet$da2,_this3$spreadsheet$da3,cellId=cell.simpleCellAddress.toCellId(),borders=null!==(_this3$spreadsheet$da=null===(_this3$spreadsheet$da2=_this3.spreadsheet.data.spreadsheetData.cells)||void 0===_this3$spreadsheet$da2||null===(_this3$spreadsheet$da3=_this3$spreadsheet$da2[cellId])||void 0===_this3$spreadsheet$da3?void 0:_this3$spreadsheet$da3.borders)&&void 0!==_this3$spreadsheet$da?_this3$spreadsheet$da:[];-1===borders.indexOf(borderType)&&_this3.spreadsheet.data.setCell(cell.simpleCellAddress,{borders:[].concat(Toolbar_toConsumableArray(borders),[borderType])})}))}},{key:"setBottomBorders",value:function setBottomBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.bottomRightSimpleCellAddress.row===rangeSimpleCellAddress.bottomRightSimpleCellAddress.row}),"borderBottom")}},{key:"setRightBorders",value:function setRightBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.bottomRightSimpleCellAddress.col===rangeSimpleCellAddress.bottomRightSimpleCellAddress.col}),"borderRight")}},{key:"setTopBorders",value:function setTopBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.topLeftSimpleCellAddress.row===rangeSimpleCellAddress.topLeftSimpleCellAddress.row}),"borderTop")}},{key:"setLeftBorders",value:function setLeftBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.topLeftSimpleCellAddress.col===rangeSimpleCellAddress.topLeftSimpleCellAddress.col}),"borderLeft")}},{key:"setVerticalBorders",value:function setVerticalBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.topLeftSimpleCellAddress.col>rangeSimpleCellAddress.topLeftSimpleCellAddress.col&&cell.rangeSimpleCellAddress.bottomRightSimpleCellAddress.col<=rangeSimpleCellAddress.bottomRightSimpleCellAddress.col}),"borderLeft")}},{key:"setHorizontalBorders",value:function setHorizontalBorders(cells){this.setBorderStyles(cells,(function(cell,rangeSimpleCellAddress){return cell.rangeSimpleCellAddress.topLeftSimpleCellAddress.row>rangeSimpleCellAddress.topLeftSimpleCellAddress.row&&cell.rangeSimpleCellAddress.bottomRightSimpleCellAddress.row<=rangeSimpleCellAddress.bottomRightSimpleCellAddress.row}),"borderTop")}},{key:"setInsideBorders",value:function setInsideBorders(cells){this.setHorizontalBorders(cells),this.setVerticalBorders(cells)}},{key:"setOutsideBorders",value:function setOutsideBorders(cells){this.setBottomBorders(cells),this.setLeftBorders(cells),this.setRightBorders(cells),this.setTopBorders(cells)}},{key:"setAllBorders",value:function setAllBorders(cells){this.setOutsideBorders(cells),this.setInsideBorders(cells)}},{key:"clearBorders",value:function clearBorders(simpleCellAddresses){var _this4=this;simpleCellAddresses.forEach((function(simpleCellAddress){var _this4$spreadsheet$da,cellId=simpleCellAddress.toCellId();null===(_this4$spreadsheet$da=_this4.spreadsheet.data.spreadsheetData.cells)||void 0===_this4$spreadsheet$da||delete _this4$spreadsheet$da[cellId].borders}))}},{key:"destroy",value:function destroy(){this.toolbarEl.remove(),this.tooltip.destroy()}},{key:"setDropdownIconContent",value:function setDropdownIconContent(name,dropdownContent,createArrow){var _createDropdownIconBu=function createDropdownIconButton(name,classNamePrefix){var createArrow=arguments.length>2&&void 0!==arguments[2]&&arguments[2],iconButtonValues=htmlElementHelpers_createIconButton(name,classNamePrefix);iconButtonValues.button.classList.add(spreadsheet_HtmlElementHelpers_module.dropdownIconButton,classNamePrefix+"-dropdown-button",classNamePrefix+"-dropdown-icon-button");var _createDropdownAction2=createDropdownActionElement(name,iconButtonValues.button,classNamePrefix,createArrow),arrowIconValues=_createDropdownAction2.arrowIconValues,tooltip=_createDropdownAction2.tooltip;return{iconButtonValues:iconButtonValues,arrowIconValues:arrowIconValues,tooltip:tooltip}}(name,toolbarPrefix,createArrow),iconButtonValues=_createDropdownIconBu.iconButtonValues,arrowIconValues=_createDropdownIconBu.arrowIconValues,tooltip=_createDropdownIconBu.tooltip;this.iconElementsMap[name]=Object.assign({},iconButtonValues,{tooltip:tooltip}),this.dropdownMap[name]=Object.assign({dropdownContent:dropdownContent},arrowIconValues)}},{key:"setDropdownButtonContent",value:function setDropdownButtonContent(name,dropdownContent,createArrow){var _createDropdownButton=function createDropdownButton(name,classNamePrefix){var createArrow=arguments.length>2&&void 0!==arguments[2]&&arguments[2],buttonContainer=htmlElementHelpers_createButtonContainer(classNamePrefix),button=document.createElement("button"),text=document.createElement("span");button.dataset.name=name,button.classList.add(spreadsheet_HtmlElementHelpers_module.dropdownButton,classNamePrefix+"-dropdown-button"),text.classList.add(spreadsheet_HtmlElementHelpers_module.text,classNamePrefix+"-text"),button.appendChild(text);var _createDropdownAction=createDropdownActionElement(name,button,classNamePrefix,createArrow),arrowIconValues=_createDropdownAction.arrowIconValues,tooltip=_createDropdownAction.tooltip;return buttonContainer.append(button),{buttonContainer:buttonContainer,button:button,text:text,arrowIconValues:arrowIconValues,tooltip:tooltip}}(name,toolbarPrefix,createArrow),buttonContainer=_createDropdownButton.buttonContainer,button=_createDropdownButton.button,text=_createDropdownButton.text,arrowIconValues=_createDropdownButton.arrowIconValues,tooltip=_createDropdownButton.tooltip;this.buttonElementsMap[name]={buttonContainer:buttonContainer,button:button,text:text,tooltip:tooltip},this.dropdownMap[name]=Object.assign({dropdownContent:dropdownContent},arrowIconValues)}},{key:"setDropdownColorPicker",value:function setDropdownColorPicker(name){var _createColorPickerCon=function createColorPickerContent(){var dropdownContent=htmlElementHelpers_createDropdownContent(toolbarPrefix),colorPicker=document.createElement("div");colorPicker.classList.add(toolbar_Toolbar_module.colorPicker,toolbarPrefix+"-color-picker");var picker=Object(acolorpicker.createPicker)(colorPicker,{palette:"PALETTE_MATERIAL_CHROME",paletteEditable:!0,showAlpha:!0});return dropdownContent.appendChild(colorPicker),{dropdownContent:dropdownContent,colorPicker:colorPicker,picker:picker}}(),dropdownContent=_createColorPickerCon.dropdownContent,colorPicker=_createColorPickerCon.colorPicker,picker=_createColorPickerCon.picker;this.setDropdownIconContent(name,dropdownContent);var colorBar=function createColorBar(picker){var colorBar=document.createElement("span");return colorBar.classList.add(toolbar_Toolbar_module.colorBar,toolbarPrefix+"-color-bar"),picker.on("change",(function(_,color){color&&(colorBar.style.backgroundColor=color)})),colorBar}(picker);this.iconElementsMap[name].button.appendChild(colorBar),this.colorPickerElementsMap[name]={colorBar:colorBar,picker:picker,colorPicker:colorPicker}}},{key:"setActiveColor",value:function setActiveColor(selectedCell,colorPickerIconName){var _this$spreadsheet$dat2,fill,_cell$backgroundColor,_cell$fontColor,cellId=selectedCell.simpleCellAddress.toCellId(),cell=null===(_this$spreadsheet$dat2=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat2?void 0:_this$spreadsheet$dat2[cellId];"backgroundColor"===colorPickerIconName?fill=null!==(_cell$backgroundColor=null==cell?void 0:cell.backgroundColor)&&void 0!==_cell$backgroundColor?_cell$backgroundColor:"":fill=null!==(_cell$fontColor=null==cell?void 0:cell.fontColor)&&void 0!==_cell$fontColor?_cell$fontColor:this.spreadsheet.styles.cell.text.fill;this.colorPickerElementsMap[colorPickerIconName].colorBar.style.backgroundColor=fill}},{key:"setActiveMergedCells",value:function setActiveMergedCells(selectedCells,selectedCell){var isMerged=selectedCell.getIsCellPartOfMerge()&&1===selectedCells.length;this.iconElementsMap.merge.button.disabled=!isMerged&&selectedCells.length<=1,this.setActive(this.iconElementsMap.merge,isMerged)}},{key:"setActiveSaveState",value:function setActiveSaveState(){this.spreadsheet.isSaving?this.autosaveElement.text.textContent="Saving...":this.autosaveElement.text.textContent="Saved"}},{key:"setActiveHorizontalIcon",value:function setActiveHorizontalIcon(selectedCell){var _this$spreadsheet$dat3,_this$spreadsheet$dat4,cellId=selectedCell.simpleCellAddress.toCellId(),horizontalTextAlign=null===(_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat3||null===(_this$spreadsheet$dat4=_this$spreadsheet$dat3[cellId])||void 0===_this$spreadsheet$dat4?void 0:_this$spreadsheet$dat4.horizontalTextAlign,icon=this.iconElementsMap.horizontalTextAlign.icon;switch(horizontalTextAlign){case"center":icon.dataset.activeIcon="center";break;case"right":icon.dataset.activeIcon="right";break;default:icon.dataset.activeIcon="left"}}},{key:"setActiveVerticalIcon",value:function setActiveVerticalIcon(selectedCell){var _this$spreadsheet$dat5,_this$spreadsheet$dat6,cellId=selectedCell.simpleCellAddress.toCellId(),verticalTextAlign=null===(_this$spreadsheet$dat5=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat5||null===(_this$spreadsheet$dat6=_this$spreadsheet$dat5[cellId])||void 0===_this$spreadsheet$dat6?void 0:_this$spreadsheet$dat6.verticalTextAlign,icon=this.iconElementsMap.verticalTextAlign.icon;switch(verticalTextAlign){case"top":icon.dataset.activeIcon="top";break;case"bottom":icon.dataset.activeIcon="bottom";break;default:icon.dataset.activeIcon="middle"}}},{key:"setActiveFontSize",value:function setActiveFontSize(selectedCell){var _this$spreadsheet$dat7,_this$spreadsheet$dat8,cellId=selectedCell.simpleCellAddress.toCellId(),fontSize=null===(_this$spreadsheet$dat7=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat7||null===(_this$spreadsheet$dat8=_this$spreadsheet$dat7[cellId])||void 0===_this$spreadsheet$dat8?void 0:_this$spreadsheet$dat8.fontSize;this.buttonElementsMap.fontSize.text.textContent=(null!=fontSize?fontSize:this.spreadsheet.styles.cell.text.fontSize).toString()}},{key:"setActiveTextFormat",value:function setActiveTextFormat(selectedCell){var _this$spreadsheet$dat9,_this$spreadsheet$dat10,_this5=this,cellId=selectedCell.simpleCellAddress.toCellId(),textFormatPattern=null===(_this$spreadsheet$dat9=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat9||null===(_this$spreadsheet$dat10=_this$spreadsheet$dat9[cellId])||void 0===_this$spreadsheet$dat10?void 0:_this$spreadsheet$dat10.textFormatPattern,textFormat="plainText";Object.keys(this.textFormatMap).forEach((function(key){var value=_this5.textFormatMap[key];textFormatPattern===value&&(textFormat=key)})),this.buttonElementsMap.textFormatPattern.text.textContent=Object(dist_es2015.a)(textFormat)}},{key:"setActiveHistoryIcons",value:function setActiveHistoryIcons(history){this.setDisabled(this.iconElementsMap.undo,!history.canUndo),this.setDisabled(this.iconElementsMap.redo,!history.canRedo)}},{key:"isFreezeActive",value:function isFreezeActive(sheetId){var _this$spreadsheet$dat11;return!(null===(_this$spreadsheet$dat11=this.spreadsheet.data.spreadsheetData.frozenCells)||void 0===_this$spreadsheet$dat11||!_this$spreadsheet$dat11[sheetId])}},{key:"isActive",value:function isActive(selectedCell,key){var _this$spreadsheet$dat12,_this$spreadsheet$dat13,cellId=selectedCell.simpleCellAddress.toCellId();return!!(null===(_this$spreadsheet$dat12=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat12||null===(_this$spreadsheet$dat13=_this$spreadsheet$dat12[cellId])||void 0===_this$spreadsheet$dat13?void 0:_this$spreadsheet$dat13[key])}},{key:"setActive",value:function setActive(actionElements,active){actionElements.active=active,active?actionElements.button.classList.add("active"):actionElements.button.classList.remove("active")}},{key:"setDisabled",value:function setDisabled(iconElements,disabled){iconElements.button.disabled=disabled}}]),Toolbar}(),toolbar_Toolbar=Toolbar_Toolbar,FormulaBar_module=__webpack_require__(353),FormulaBar_module_options={insert:"head",singleton:!1},formulaBar_FormulaBar_module=(injectStylesIntoStyleTag_default()(FormulaBar_module.a,FormulaBar_module_options),FormulaBar_module.a.locals||{});function FormulaBar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var formulaBar_FormulaBar=function(){function FormulaBar(){var _this=this;!function FormulaBar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FormulaBar),this.formulaBarEl=void 0,this.editorArea=void 0,this.editableContentContainer=void 0,this.editableContent=void 0,this.spreadsheet=void 0,this.onInput=function(e){var _target$firstChild,sheet=_this.spreadsheet.getActiveSheet(),textContent=null===(_target$firstChild=e.target.firstChild)||void 0===_target$firstChild?void 0:_target$firstChild.textContent;null!=sheet&&sheet.cellEditor.getIsHidden()&&sheet.cellEditor.show(sheet.selector.selectedCell,!1),null==sheet||sheet.cellEditor.setTextContent(null!=textContent?textContent:null)},this.onKeyDown=function(e){e.stopPropagation();var sheet=_this.spreadsheet.getActiveSheet();switch(e.key){case"Escape":null==sheet||sheet.cellEditor.hide(),_this.editableContent.blur();break;case"Enter":null==sheet||sheet.cellEditor.hideAndSave(),_this.editableContent.blur()}}}return function FormulaBar_createClass(Constructor,protoProps,staticProps){return protoProps&&FormulaBar_defineProperties(Constructor.prototype,protoProps),staticProps&&FormulaBar_defineProperties(Constructor,staticProps),Constructor}(FormulaBar,[{key:"initialize",value:function initialize(spreadsheet){this.spreadsheet=spreadsheet,this.formulaBarEl=document.createElement("div"),this.formulaBarEl.classList.add(formulaBar_FormulaBar_module.formulaBar,"powersheet-formula-bar");var _createFormulaEditorA=function createFormulaEditorArea(){var editorArea=document.createElement("div"),editableContentContainer=document.createElement("div"),_createIcon=htmlElementHelpers_createIcon("formula","powersheet-formula-bar"),iconContainer=_createIcon.iconContainer,icon=_createIcon.icon,editableContent=document.createElement("div");return iconContainer.classList.add(formulaBar_FormulaBar_module.iconContainer),editorArea.classList.add(formulaBar_FormulaBar_module.editorArea,"powersheet-formula-bar-editor-area"),editableContentContainer.classList.add(formulaBar_FormulaBar_module.editableContentContainer,"powersheet-formula-bar-editable-content-container"),editableContent.classList.add(formulaBar_FormulaBar_module.editableContent,"powersheet-formula-bar-editable-content"),editorArea.appendChild(editableContentContainer),editableContentContainer.appendChild(iconContainer),editableContentContainer.appendChild(editableContent),iconContainer.appendChild(icon),{editorArea:editorArea,editableContentContainer:editableContentContainer,editableContent:editableContent}}(),editorArea=_createFormulaEditorA.editorArea,editableContentContainer=_createFormulaEditorA.editableContentContainer,editableContent=_createFormulaEditorA.editableContent;this.formulaBarEl.appendChild(editorArea),editableContentContainer.addEventListener("click",(function(){editableContent.contentEditable="true",editableContent.focus()})),this.editorArea=editorArea,this.editableContentContainer=editableContentContainer,this.editableContent=editableContent,this.editableContent.addEventListener("input",this.onInput),this.editableContent.addEventListener("keydown",this.onKeyDown)}},{key:"updateValue",value:function updateValue(simpleCellAddress){var _this$spreadsheet$dat,_this$spreadsheet$dat2,_sheet$cellEditor$cel,_sheet$cellEditor,sheet=this.spreadsheet.getActiveSheet(),value=simpleCellAddress?null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.cells)||void 0===_this$spreadsheet$dat||null===(_this$spreadsheet$dat2=_this$spreadsheet$dat[simpleCellAddress.toCellId()])||void 0===_this$spreadsheet$dat2?void 0:_this$spreadsheet$dat2.value:null,cellEditorTextContent=null!==(_sheet$cellEditor$cel=null==sheet||null===(_sheet$cellEditor=sheet.cellEditor)||void 0===_sheet$cellEditor?void 0:_sheet$cellEditor.cellEditorEl.textContent)&&void 0!==_sheet$cellEditor$cel?_sheet$cellEditor$cel:null;this.setTextContent(null!=value?value:cellEditorTextContent)}},{key:"setTextContent",value:function setTextContent(textContent){this.editableContent.textContent=textContent}},{key:"destroy",value:function destroy(){this.editableContent.removeEventListener("input",this.onInput),this.editableContent.removeEventListener("keydown",this.onKeyDown)}}]),FormulaBar}();__webpack_require__(83);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Exporter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Exporter_Export=function(){function Export(){!function Exporter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Export),this.spreadsheet=void 0}var _exportWorkbook;return function Exporter_createClass(Constructor,protoProps,staticProps){return protoProps&&Exporter_defineProperties(Constructor.prototype,protoProps),staticProps&&Exporter_defineProperties(Constructor,staticProps),Constructor}(Export,[{key:"initialize",value:function initialize(spreadsheet){this.spreadsheet=spreadsheet}},{key:"getWorksheet",value:function getWorksheet(sheetId){var _this$spreadsheet$dat2,_this$spreadsheet$dat3,worksheet={},rangeSimpleCellAddress=new cell_RangeSimpleCellAddress(new cell_SimpleCellAddress(sheetId,0,0),new cell_SimpleCellAddress(sheetId,0,0));for(var key in this.spreadsheet.data.spreadsheetData.cells){var _this$spreadsheet$dat,_cell$value,cellId=key,simpleCellAddress=cell_SimpleCellAddress.cellIdToAddress(cellId),cell=this.spreadsheet.data.spreadsheetData.cells[cellId],cellString=simpleCellAddress.addressToString(),mergedCell=null===(_this$spreadsheet$dat=this.spreadsheet.data.spreadsheetData.mergedCells)||void 0===_this$spreadsheet$dat?void 0:_this$spreadsheet$dat[cellId];rangeSimpleCellAddress.topLeftSimpleCellAddress.row=Math.min(simpleCellAddress.row,rangeSimpleCellAddress.topLeftSimpleCellAddress.row),rangeSimpleCellAddress.topLeftSimpleCellAddress.col=Math.min(simpleCellAddress.col,rangeSimpleCellAddress.topLeftSimpleCellAddress.col),rangeSimpleCellAddress.bottomRightSimpleCellAddress.row=Math.max(simpleCellAddress.row,rangeSimpleCellAddress.bottomRightSimpleCellAddress.row),rangeSimpleCellAddress.bottomRightSimpleCellAddress.col=Math.max(simpleCellAddress.col,rangeSimpleCellAddress.bottomRightSimpleCellAddress.col);var type=void 0,textFormatPattern=null==cell?void 0:cell.textFormatPattern;type=Object(lodash.isNil)(cell.value)&&Object(lodash.isNil)(textFormatPattern)?"z":Object(numfmt.isText)(textFormatPattern)||Object(lodash.isNil)(textFormatPattern)?"s":Object(numfmt.isDate)(textFormatPattern)?"d":"n",worksheet[cellString]={z:textFormatPattern,v:cell.value,t:type},"="===(null===(_cell$value=cell.value)||void 0===_cell$value?void 0:_cell$value.charAt(0))&&(worksheet[cellString].f=cell.value.slice(1)),mergedCell&&(worksheet["!merges"]||(worksheet["!merges"]=[]),worksheet["!merges"].push({s:{r:rangeSimpleCellAddress.topLeftSimpleCellAddress.row,c:rangeSimpleCellAddress.topLeftSimpleCellAddress.col},e:{r:rangeSimpleCellAddress.bottomRightSimpleCellAddress.row,c:rangeSimpleCellAddress.bottomRightSimpleCellAddress.col}}))}worksheet["!ref"]=rangeSimpleCellAddress.topLeftSimpleCellAddress.addressToString()+":"+rangeSimpleCellAddress.bottomRightSimpleCellAddress.addressToString();var colInfos=[],rowInfos=[],cols=null!==(_this$spreadsheet$dat2=this.spreadsheet.data.spreadsheetData.cols)&&void 0!==_this$spreadsheet$dat2?_this$spreadsheet$dat2:{},rows=null!==(_this$spreadsheet$dat3=this.spreadsheet.data.spreadsheetData.rows)&&void 0!==_this$spreadsheet$dat3?_this$spreadsheet$dat3:{};return Object.keys(cols).forEach((function(key){var sheetRowColId=key,index=parseInt(key,10),value=cols[sheetRowColId];colInfos[index]={wpx:value.size}})),Object.keys(rows).forEach((function(key){var sheetRowColId=key,index=parseInt(key,10),value=rows[sheetRowColId];rowInfos[index]={hpx:value.size}})),worksheet["!cols"]=colInfos,worksheet["!rows"]=rowInfos,worksheet}},{key:"getWorkbook",value:function getWorkbook(utils){var _this$spreadsheet$dat4,_this=this,workbook=utils.book_new();return Object.keys(null!==(_this$spreadsheet$dat4=this.spreadsheet.data.spreadsheetData.sheets)&&void 0!==_this$spreadsheet$dat4?_this$spreadsheet$dat4:{}).forEach((function(key){var sheetIndex=parseInt(key,10),sheetData=_this.spreadsheet.data.spreadsheetData.sheets[sheetIndex],worksheet=_this.getWorksheet(sheetData.id);utils.book_append_sheet(workbook,worksheet,sheetData.sheetName)})),workbook}},{key:"exportWorkbook",value:(_exportWorkbook=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var _this$spreadsheet$dat5,_yield$import,writeFile,utils,workbook;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Promise.all([__webpack_require__.e(6),__webpack_require__.e(7)]).then(__webpack_require__.t.bind(null,994,7));case 2:_yield$import=_context.sent,writeFile=_yield$import.writeFile,utils=_yield$import.utils,workbook=this.getWorkbook(utils),writeFile(workbook,null!==(_this$spreadsheet$dat5=this.spreadsheet.data.spreadsheetData.exportSpreadsheetName)&&void 0!==_this$spreadsheet$dat5?_this$spreadsheet$dat5:this.spreadsheet.options.exportSpreadsheetName);case 7:case"end":return _context.stop()}}),_callee,this)}))),function exportWorkbook(){return _exportWorkbook.apply(this,arguments)})}]),Export}(),Exporter=Exporter_Export,spreadsheet_getHyperformulaConfig=function getHyperformulaConfig(){return{chooseAddressMappingPolicy:new HyperFormula.AlwaysSparse,undoLimit:0}},BottomBar_module=__webpack_require__(354),BottomBar_module_options={insert:"head",singleton:!1},bottomBar_BottomBar_module=(injectStylesIntoStyleTag_default()(BottomBar_module.a,BottomBar_module_options),BottomBar_module.a.locals||{});function BottomBar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var bottomBarPrefix=prefix+"-bottom-bar",bottomBar_BottomBar=function(){function BottomBar(){var _this=this;!function BottomBar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BottomBar),this.bottomBarEl=void 0,this.content=void 0,this.sheetSelectionButtonContainer=void 0,this.sheetSelectionButton=void 0,this.sheetSelectionDropdown=void 0,this.sheetSelectionDropdownContent=void 0,this.createNewSheetButtonElements=void 0,this.tabContainer=void 0,this.scrollSliderContainer=void 0,this.sheetTabElementsMap=void 0,this.spreadsheet=void 0,this.sheetSelectionOnClick=function(){_this.sheetSelectionDropdown.show()},this.createNewSheetButtonOnClick=function(){var sheetName=_this.spreadsheet.getSheetName(),id=_this.spreadsheet.sheets.size;_this.spreadsheet.createNewSheet({id:id,sheetName:sheetName}),_this.spreadsheet.switchSheet(id)}}return function BottomBar_createClass(Constructor,protoProps,staticProps){return protoProps&&BottomBar_defineProperties(Constructor.prototype,protoProps),staticProps&&BottomBar_defineProperties(Constructor,staticProps),Constructor}(BottomBar,[{key:"initialize",value:function initialize(spreadsheet){this.spreadsheet=spreadsheet,this.sheetTabElementsMap=new Map,this.createNewSheetButtonElements=htmlElementHelpers_createIconButton("add",bottomBarPrefix),this.createNewSheetButtonElements.buttonContainer.classList.add(bottomBar_BottomBar_module.createNewSheetButtonContainer),this.createNewSheetButtonElements.button.addEventListener("click",this.createNewSheetButtonOnClick),this.sheetSelectionButton=htmlElementHelpers_createIconButton("hamburger",bottomBarPrefix),this.sheetSelectionButton.button.addEventListener("click",this.sheetSelectionOnClick),this.bottomBarEl=document.createElement("div"),this.bottomBarEl.classList.add(bottomBar_BottomBar_module.bottomBar,""+bottomBarPrefix),this.content=document.createElement("div"),this.content.classList.add(bottomBar_BottomBar_module.content,bottomBarPrefix+"-content"),this.tabContainer=document.createElement("div"),this.tabContainer.classList.add(bottomBarPrefix+"-tab-container"),this.sheetSelectionButtonContainer=document.createElement("div"),this.sheetSelectionButtonContainer.classList.add(bottomBar_BottomBar_module.sheetSelectionButtonContainer,bottomBarPrefix+"-sheet-selection-button-container"),this.sheetSelectionDropdownContent=function createSheetSelectionDropdownContent(){var sheetSelectionDropdownContent=document.createElement("div");return sheetSelectionDropdownContent.classList.add(bottomBar_BottomBar_module.sheetSelectionDropdownContent,bottomBarPrefix+"-sheet-selection-dropdown-content"),sheetSelectionDropdownContent}(),this.sheetSelectionDropdown=Object(tippy_esm.a)(this.sheetSelectionButton.button,{placement:"top",interactive:!0,arrow:!1,trigger:"manual",theme:"dropdown",showOnCreate:!1,hideOnClick:!0,content:this.sheetSelectionDropdownContent}),this.scrollSliderContainer=document.createElement("div"),this.scrollSliderContainer.classList.add(bottomBar_BottomBar_module.scrollSliderContainer,bottomBarPrefix+"-scroll-slider-container"),this.sheetSelectionButtonContainer.appendChild(this.sheetSelectionButton.button),this.tabContainer.appendChild(this.scrollSliderContainer),this.content.appendChild(this.createNewSheetButtonElements.buttonContainer),this.content.appendChild(this.sheetSelectionButtonContainer),this.bottomBarEl.appendChild(this.content),this.bottomBarEl.appendChild(this.tabContainer)}},{key:"setSheetTabElements",value:function setSheetTabElements(sheetId){var _this2=this,_createSheetTab=function createSheetTab(){var sheetTabContainer=document.createElement("div"),sheetTab=document.createElement("div"),nameContainer=document.createElement("span");return sheetTabContainer.classList.add(bottomBar_BottomBar_module.sheetTabContainer,bottomBarPrefix+"-sheet-tab-container"),sheetTab.classList.add(bottomBar_BottomBar_module.sheetTab,bottomBarPrefix+"-sheet-tab"),nameContainer.classList.add(bottomBar_BottomBar_module.nameContainer,bottomBarPrefix+"-name-container"),sheetTab.appendChild(nameContainer),sheetTabContainer.appendChild(sheetTab),{sheetTabContainer:sheetTabContainer,sheetTab:sheetTab,nameContainer:nameContainer}}(),sheetTabContainer=_createSheetTab.sheetTabContainer,sheetTab=_createSheetTab.sheetTab,nameContainer=_createSheetTab.nameContainer,sheetSelectionDropdownButton=function createSheetSelectionDropdownButton(){var sheetSelectionDropdownButton=document.createElement("button");return sheetSelectionDropdownButton.classList.add(bottomBar_BottomBar_module.sheetSelectionDropdownButton,bottomBarPrefix+"-sheet-selection-dropdown-button"),sheetSelectionDropdownButton}(),isActive=sheetId===this.spreadsheet.activeSheetId;isActive?sheetTab.classList.add("active"):sheetTab.classList.remove("active"),sheetSelectionDropdownButton.textContent=this.spreadsheet.data.spreadsheetData.sheets[sheetId].sheetName;var switchSheet=function switchSheet(){_this2.spreadsheet.switchSheet(sheetId)},setTabToContentEditable=function setTabToContentEditable(){nameContainer.contentEditable="true",nameContainer.focus()},_createSheetTabDropdo=function createSheetTabDropdownContent(){var sheetTabDropdownContent=document.createElement("div");sheetTabDropdownContent.classList.add(bottomBar_BottomBar_module.sheetTabDropdownContent,bottomBarPrefix+"-sheet-tab-dropdown-content");var deleteSheetButton=document.createElement("button");deleteSheetButton.classList.add(bottomBar_BottomBar_module.deleteSheetButton,bottomBarPrefix+"-delete-sheet-button"),deleteSheetButton.textContent="Delete";var renameSheetButton=document.createElement("button");return renameSheetButton.classList.add(bottomBar_BottomBar_module.renameSheetButton,bottomBarPrefix+"-rename-sheet-button"),renameSheetButton.textContent="Rename",sheetTabDropdownContent.appendChild(deleteSheetButton),sheetTabDropdownContent.appendChild(renameSheetButton),{sheetTabDropdownContent:sheetTabDropdownContent,deleteSheetButton:deleteSheetButton,renameSheetButton:renameSheetButton}}(),sheetTabDropdownContent=_createSheetTabDropdo.sheetTabDropdownContent,deleteSheetButton=_createSheetTabDropdo.deleteSheetButton,renameSheetButton=_createSheetTabDropdo.renameSheetButton;deleteSheetButton.disabled=1===this.spreadsheet.sheets.size;var sheetTabDropdown=Object(tippy_esm.a)(sheetTab,{placement:"top",interactive:!0,arrow:!1,trigger:"manual",theme:"dropdown",showOnCreate:!1,hideOnClick:!0,content:sheetTabDropdownContent});sheetSelectionDropdownButton.addEventListener("click",(function(){switchSheet(),_this2.sheetSelectionDropdown.hide()}),{once:!0}),sheetTab.addEventListener("click",(function(){isActive||switchSheet()}),{once:!0}),sheetTab.addEventListener("dblclick",(function(){setTabToContentEditable()}),{once:!0}),sheetTab.addEventListener("contextmenu",(function(e){e.preventDefault(),sheetTabDropdown.show()}),{once:!0}),deleteSheetButton.addEventListener("click",(function(){sheetTabDropdown.hide(),_this2.spreadsheet.deleteSheet(sheetId)}),{once:!0}),renameSheetButton.addEventListener("click",(function(){sheetTabDropdown.hide(),setTabToContentEditable()}),{once:!0}),nameContainer.addEventListener("blur",(function(){nameContainer.contentEditable="false",nameContainer.blur(),_this2.spreadsheet.renameSheet(sheetId,nameContainer.textContent)}),{once:!0}),nameContainer.textContent=this.spreadsheet.data.spreadsheetData.sheets[sheetId].sheetName,this.scrollSliderContainer.appendChild(sheetTabContainer),this.sheetSelectionDropdownContent.appendChild(sheetSelectionDropdownButton),this.sheetTabElementsMap.set(sheetId,{sheetTabContainer:sheetTabContainer,sheetTab:sheetTab,nameContainer:nameContainer,sheetSelectionDropdownButton:sheetSelectionDropdownButton,isActive:isActive})}},{key:"updateSheetTabs",value:function updateSheetTabs(){var _this3=this;this.scrollSliderContainer.innerHTML="",this.sheetSelectionDropdownContent.innerHTML="",this.spreadsheet.sheets.forEach((function(sheet){_this3.setSheetTabElements(sheet.sheetId)}))}},{key:"destroy",value:function destroy(){this.createNewSheetButtonElements.button.removeEventListener("click",this.createNewSheetButtonOnClick),this.sheetSelectionButton.button.removeEventListener("click",this.sheetSelectionOnClick)}}]),BottomBar}(),touch_emulator=__webpack_require__(355),touch_emulator_default=__webpack_require__.n(touch_emulator),esm=__webpack_require__(152),eventemitter3=__webpack_require__(520),eventemitter3_default=__webpack_require__.n(eventemitter3),Spredsheet_stories_eventLog=(__webpack_exports__.default={title:"Spreadsheet"},function eventLog(event){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];Object(esm.action)(event).apply(void 0,args)}),Spredsheet_stories_getSpreadsheet=function getSpreadsheet(params){touch_emulator_default.a.stop();var eventEmitter=new eventemitter3_default.a,oldEmit=eventEmitter.emit,throttledEventLog=Object(lodash.throttle)(Spredsheet_stories_eventLog,250);return eventEmitter.emit=function(event){for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];return throttledEventLog.apply(void 0,[event.toString()].concat(args)),oldEmit.call.apply(oldEmit,[eventEmitter,event].concat(args)),!0},eventEmitter.on(spreadsheet_events.persist.save,(function(_,done){setTimeout((function(){done()}),500)})),new spreadsheet_Spreadsheet(Object.assign({eventEmitter:eventEmitter},params))},Spredsheet_stories_buildSpreadsheetWithEverything=function buildSpreadsheetWithEverything(args,hyperformula){var options=args.options,styles=args.styles,data=args.data,toolbar=new toolbar_Toolbar,formulaBar=new formulaBar_FormulaBar,exporter=new Exporter,bottomBar=new bottomBar_BottomBar,spreadsheet=Spredsheet_stories_getSpreadsheet({hyperformula:hyperformula,options:options,styles:styles,data:data,toolbar:toolbar,formulaBar:formulaBar,bottomBar:bottomBar,exporter:exporter});return spreadsheet.spreadsheetEl.prepend(formulaBar.formulaBarEl),spreadsheet.spreadsheetEl.prepend(toolbar.toolbarEl),spreadsheet.spreadsheetEl.appendChild(bottomBar.bottomBarEl),spreadsheet.spreadsheetEl},buildSpreadsheetWithHyperformula=function buildSpreadsheetWithHyperformula(args,config){var hyperformula=function getHyperformulaInstance(config){return es.HyperFormula.buildEmpty(Object.assign({},spreadsheet_getHyperformulaConfig(),config,{licenseKey:"gpl-v3"}))}(Object.assign({},config));return Spredsheet_stories_buildSpreadsheetWithEverything(args,hyperformula)},Template=function Template(args){return buildSpreadsheetWithHyperformula(args)},defaultStoryArgs={options:defaultOptions,styles:defaultStyles},Default=Template.bind({});Default.args=defaultStoryArgs;var FrozenCells=Template.bind({});FrozenCells.args=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"Frozen Cells",frozenCell:0}},frozenCells:{0:{id:0,row:2,col:2}}}});var MergedCells=Template.bind({});MergedCells.args=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"Merged Cells",mergedCells:{"0_3_1":"0_3_1"}}},mergedCells:{"0_3_1":{id:"0_3_1",row:{x:3,y:5},col:{x:1,y:1}}}}});var DifferentSizeCells=Template.bind({});DifferentSizeCells.args=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"Different Size Cells",rows:{"0_0":"0_0","0_2":"0_2"},cols:{"0_0":"0_0"}}},rows:{"0_0":{id:"0_0",size:50},"0_2":{id:"0_2",size:100}},cols:{"0_0":{id:"0_0",size:200}}}});var Mobile=function MobileTemplate(args){var spreadsheet=buildSpreadsheetWithHyperformula(args);return touch_emulator_default.a.start(),spreadsheet}.bind({}),MillionRows=function MillionRowsTemplate(args){var newArgs=Object(lodash.merge)({},args,{options:{row:{amount:1e6}}});return buildSpreadsheetWithHyperformula(newArgs,{maxRows:newArgs.options.row.amount})}.bind({});MillionRows.args=Object.assign({},defaultStoryArgs,{styles:Object.assign({},defaultStyles,{row:Object.assign({},defaultStyles.row,{headerRect:Object.assign({},defaultStyles.row.headerRect,{width:50})})}),data:{sheets:{0:{id:0,sheetName:"One Million Rows"}}}});var CustomStyles=Template.bind({});CustomStyles.args=Object.assign({},defaultStoryArgs,{styles:Object.assign({},defaultStyles,{row:Object.assign({},defaultStyles.row,{gridLine:Object.assign({},defaultStyles.row.gridLine,{stroke:"#add8e6"})}),selection:Object.assign({},defaultStyles.cell,{fill:"orange",opacity:.3})})});var BareMinimumSpreadsheet=function OnlySpreadsheet(args){return function buildOnlySpreadsheet(args){var options=args.options,styles=args.styles,data=args.data;return Spredsheet_stories_getSpreadsheet({options:options,styles:styles,data:data}).spreadsheetEl}(args)}.bind({}),NoHyperformula=function NoHyperformulaTemplate(args){return Spredsheet_stories_buildSpreadsheetWithEverything(args)}.bind({}),CustomSizeSpreadsheet=Template.bind({});CustomSizeSpreadsheet.args=Object.assign({},defaultStoryArgs,{options:Object.assign({},defaultOptions,{width:500,height:700})});var MultipleSpreadsheets=function MultipleSpreadsheetsTemplate(){var firstSpreadsheetArgs=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"First Spreadsheet"}}}}),secondSpreadsheetArgs=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"Second Spreadsheet"}}}}),firstSpreadsheetEl=buildSpreadsheetWithHyperformula(firstSpreadsheetArgs),secondSpreadsheetEl=buildSpreadsheetWithHyperformula(secondSpreadsheetArgs),containerEl=document.createElement("div");return containerEl.appendChild(firstSpreadsheetEl),containerEl.appendChild(secondSpreadsheetEl),containerEl.style.height="50%",containerEl}.bind({}),AllCurrencySymbols=function AllCurrencySymbolsTemplate(args){return buildSpreadsheetWithHyperformula(args,{currencySymbol:Object.values(currency_symbol_map.currencySymbolMap)})}.bind({});AllCurrencySymbols.args=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"All Currency Symbols",cells:{"0_1_0":"0_1_0","0_1_1":"0_1_1","0_3_3":"0_3_3","0_4_1":"0_4_1"}}},cells:{"0_1_0":{id:"0_1_0",value:"$33334.33"},"0_1_1":{id:"0_1_1",value:"22.2"},"0_3_3":{id:"0_3_3",value:"33.3"},"0_4_1":{id:"0_4_1",value:"=A2+B2+D4"}}}});var CellsData=Template.bind({});CellsData.args=Object.assign({},defaultStoryArgs,{data:{exportSpreadsheetName:"Cells Datas.xlsx",sheets:{0:{id:0,sheetName:"Cells Data",cells:{"0_1_0":"0_1_0","0_1_1":"0_1_1","0_3_3":"0_3_3","0_4_1":"0_4_1","0_4_4":"0_4_4","0_40_4":"0_40_4"}}},cells:{"0_1_0":{id:"0_1_0",value:"HI!",horizontalTextAlign:"right",verticalTextAlign:"bottom",backgroundColor:"red",fontColor:"#ffeb3b"},"0_1_1":{id:"0_1_1",comment:"Powersheet is the best",value:"A very long piece of text that should wrap to the next line on the word.",horizontalTextAlign:"center",verticalTextAlign:"middle",bold:!0,italic:!0,textWrap:"wrap"},"0_3_3":{id:"0_3_3",borders:["borderBottom","borderRight","borderTop","borderLeft"],backgroundColor:"yellow"},"0_4_1":{id:"0_4_1",value:"Some value",underline:!0,strikeThrough:!0,fontSize:14,borders:["borderBottom"]},"0_4_4":{id:"0_4_4",value:"0.05",textFormatPattern:"0.00%"},"0_40_4":{id:"0_40_4",value:"Cell Value"}}}});var Formulas=Template.bind({});Formulas.args=Object.assign({},defaultStoryArgs,{data:{sheets:{0:{id:0,sheetName:"Formulas",cells:{"0_0_1":"0_0_1","0_1_1":"0_1_1","0_2_1":"0_2_1","0_2_0":"0_2_0","0_4_0":"0_4_0","0_4_1":"0_4_1"}},1:{id:1,sheetName:"Other",cells:{"1_0_0":"1_0_0"}}},cells:{"0_0_1":{id:"0_0_1",value:"5",textFormatPattern:"#,##0.00"},"0_1_1":{id:"0_1_1",value:"2",textFormatPattern:"#,##0.00"},"0_2_0":{id:"0_2_0",value:"SUM"},"0_2_1":{id:"0_2_1",value:"=SUM(B1, B2)",textFormatPattern:"#,##0.00"},"0_4_0":{id:"0_4_0",value:"Cross Sheet Reference"},"0_4_1":{id:"0_4_1",value:"='Other'!A1 * 30",textFormatPattern:"#,##0.00"},"1_0_0":{id:"1_0_0",value:"100",textFormatPattern:"#,##0.00"}}}}),Default.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},Default.parameters),FrozenCells.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},FrozenCells.parameters),MergedCells.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},MergedCells.parameters),DifferentSizeCells.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},DifferentSizeCells.parameters),Mobile.parameters=Object.assign({storySource:{source:"(args) => {\n  const spreadsheet = buildSpreadsheetWithHyperformula(args);\n\n  TouchEmulator.start();\n\n  return spreadsheet;\n}"}},Mobile.parameters),MillionRows.parameters=Object.assign({storySource:{source:"(args) => {\n  const newArgs = merge({}, args, {\n    options: {\n      row: {\n        amount: 1_000_000,\n      },\n    },\n  });\n\n  return buildSpreadsheetWithHyperformula(newArgs, {\n    maxRows: newArgs.options.row.amount,\n  });\n}"}},MillionRows.parameters),CustomStyles.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},CustomStyles.parameters),BareMinimumSpreadsheet.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildOnlySpreadsheet(args);\n}"}},BareMinimumSpreadsheet.parameters),NoHyperformula.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithEverything(args);\n}"}},NoHyperformula.parameters),CustomSizeSpreadsheet.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},CustomSizeSpreadsheet.parameters),MultipleSpreadsheets.parameters=Object.assign({storySource:{source:"() => {\n  const firstSpreadsheetArgs: IArgs = {\n    ...defaultStoryArgs,\n    data: {\n      sheets: {\n        0: {\n          id: 0,\n          sheetName: 'First Spreadsheet',\n        },\n      },\n    },\n  };\n\n  const secondSpreadsheetArgs: IArgs = {\n    ...defaultStoryArgs,\n    data: {\n      sheets: {\n        0: {\n          id: 0,\n          sheetName: 'Second Spreadsheet',\n        },\n      },\n    },\n  };\n\n  const firstSpreadsheetEl =\n    buildSpreadsheetWithHyperformula(firstSpreadsheetArgs);\n  const secondSpreadsheetEl = buildSpreadsheetWithHyperformula(\n    secondSpreadsheetArgs\n  );\n\n  const containerEl = document.createElement('div');\n\n  containerEl.appendChild(firstSpreadsheetEl);\n  containerEl.appendChild(secondSpreadsheetEl);\n\n  containerEl.style.height = '50%';\n\n  return containerEl;\n}"}},MultipleSpreadsheets.parameters),AllCurrencySymbols.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args, {\n    currencySymbol: Object.values(currencySymbolMap),\n  });\n}"}},AllCurrencySymbols.parameters),CellsData.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},CellsData.parameters),Formulas.parameters=Object.assign({storySource:{source:"(args) => {\n  return buildSpreadsheetWithHyperformula(args);\n}"}},Formulas.parameters)},910:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters}));__webpack_require__(32),__webpack_require__(2),__webpack_require__(44),__webpack_require__(330),__webpack_require__(81),__webpack_require__(30),__webpack_require__(870),__webpack_require__(871),__webpack_require__(42);var client_api=__webpack_require__(921),esm=__webpack_require__(17),parameters={actions:{argTypesRegex:"^on[A-Z].*"},layout:"fullscreen",controls:{matchers:{color:/(background|color)$/i,date:/Date$/}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}document.querySelector("#root").style.height="100vh",Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.c)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.d)(loader,!1)}));case"parameters":return Object(client_api.e)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return Object(client_api.b)(enhancer)}));case"render":return Object(client_api.g)(value);case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.e)(v,!1);default:return console.log(key+" was not supported :( !")}}))}},[[541,2,3]]]);